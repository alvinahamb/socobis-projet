CREATE TABLE SITUATION_MATRIMONIALE
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(250) NOT NULL ENABLE,
     DESCE VARCHAR2(500),
     CONSTRAINT SITUATION_MATRIMONIALE_PK PRIMARY KEY (ID)
);

CREATE TABLE SIG_PERSONNES
(	ID VARCHAR2(100) NOT NULL ENABLE,
     PERS_NOM VARCHAR2(100),
     PERS_PRENOM VARCHAR2(50),
     PERS_SEXE CHAR(1),
     PERS_NUMERO_CIN VARCHAR2(17),
     PERS_DATE_CIN DATE,
     PERS_DATE_DUPL_CIN DATE,
     PERS_LIEU_CIN VARCHAR2(50),
     PERS_ACTE_NAIS VARCHAR2(100),
     PERS_DATE_NAIS DATE,
     PERS_NATIONALITE VARCHAR2(50),
     PERS_NOM_MERE VARCHAR2(150),
     PERS_NOM_PERE VARCHAR2(100),
     PERS_DATE_DECES DATE,
     PERS_DATE_RETRAITE DATE,
     CODE_FKT_NAIS VARCHAR2(50),
     PERS_CODE_FKT VARCHAR2(50),
     PERS_ADRESSE_LOT VARCHAR2(200),
     ID_LOG_PERSONNEL VARCHAR2(50),
     BOITE_POSTAL VARCHAR2(50),
     PERS_TELEPHONE VARCHAR2(50),
     CONSTRAINT "SIG_PERSONNES_PKEY" PRIMARY KEY ("ID")
) ;

/*-------------------------------------- */
-- SIG_DR definition

CREATE TABLE SIG_DR
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(150),
     DESCE VARCHAR2(200),
     DR_ABREVIATION VARCHAR2(50),
     NUMERO_FIXE VARCHAR2(50),
     NUMERO_MOBILE VARCHAR2(50),
     DR_SIGLE VARCHAR2(100),
     CONSTRAINT "SIG_DR_PKEY" PRIMARY KEY ("ID")
) ;

CREATE TABLE TYPE_CONTRAT
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(500),
     DESCE VARCHAR2(500),
     CONSTRAINT TYPE_CONTRAT_PK PRIMARY KEY (ID)
);


CREATE TABLE ABSENCE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     IDPERSONNEL VARCHAR2(100),
     TYPE VARCHAR2(100),
     MOTIF VARCHAR2(1000),
     VALEUR NUMBER(30,2),
     DATY DATE,
     ANNEE_CIBLE NUMBER(*,0),
     ETAT NUMBER(*,0),
     DATYFIN DATE,
     DATESAISIE DATE,
     CONSTRAINT "ABSENCE_PK" PRIMARY KEY ("ID")
) ;

CREATE TABLE TYPE_ABSENCE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(100),
     DESCE VARCHAR2(100),
     CONSTRAINT "TYPE_ABSENCE_PK" PRIMARY KEY ("ID")
) ;

INSERT INTO TYPE_ABSENCE
(ID, VAL, DESCE)
VALUES('TYP000006', 'Permission', 'Permission');
INSERT INTO TYPE_ABSENCE
(ID, VAL, DESCE)
VALUES('TYP000004', 'Congé', 'Congé');
INSERT INTO TYPE_ABSENCE
(ID, VAL, DESCE)
VALUES('TYP000003', 'autorisation d''absence', 'autorisation d''absence');
INSERT INTO TYPE_ABSENCE
(ID, VAL, DESCE)
VALUES('TYP000002', 'récupération', 'récupération');


CREATE TABLE TYPE_DEBAUCHE
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(255) NOT NULL ENABLE,
     DESCE VARCHAR2(255),
     CONSTRAINT "TYPE_DEBAUCHE_PK" PRIMARY KEY ("ID")
) ;

INSERT INTO TYPE_DEBAUCHE
(ID, VAL, DESCE)
VALUES('TYP001', 'Debauche', 'Debauche');

CREATE TABLE TYPE_DEPART
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    VAL VARCHAR2(255),
    DESCE VARCHAR2(50),
    CONSTRAINT TYPE_DEPART_PKEY PRIMARY KEY (ID)
);

INSERT INTO TYPE_DEPART
(ID, VAL, DESCE)
VALUES('TYP0010', 'Licenciement ', 'Licenciement ');
INSERT INTO TYPE_DEPART
(ID, VAL, DESCE)
VALUES('TD002', 'Demission', 'Demission');
INSERT INTO TYPE_DEPART
(ID, VAL, DESCE)
VALUES('TYP001', 'Fin de contrat', 'Fin de contrat');


-- CREATE TABLE LOG_DIRECTION
-- (	ID VARCHAR2(50) NOT NULL ENABLE,
--     VAL VARCHAR2(255),
--     DESCE VARCHAR2(255),
--     PRIMARY KEY (ID)
-- );
--
-- CREATE TABLE CATEGORIE_PAIE
-- (
--     ID VARCHAR2(100) NOT NULL ENABLE,
--     VAL VARCHAR2(500),
--     DESCE VARCHAR2(500),
--     MONTANT NUMBER(30,2),
--     REMARQUE VARCHAR2(500),
--     DROIT_HEURE_SUP VARCHAR2(500),
--     ESSAIE NUMBER(30,2),
--     CONSTRAINT CATEGORIE_PAIE_PK PRIMARY KEY (ID)
-- );
--
-- CREATE TABLE QUALIFICATION_PAIE
-- (	ID VARCHAR2(100) NOT NULL ENABLE,
--      VAL VARCHAR2(500),
--      DESCE VARCHAR2(500),
--      CONSTRAINT QUALIFICATION_PAIE_PK PRIMARY KEY (ID)
-- );

-- CREATE TABLE MODEPAIEMENT
-- (
--     ID VARCHAR2(255),
--     VAL VARCHAR2(400),
--     DESCE VARCHAR2(400),
--     CONSTRAINT MODEPAIEMENT_PK PRIMARY KEY (ID)
-- );

CREATE TABLE LOG_PERSONNEL_NON_VALIDE
(
    ID VARCHAR2(100) NOT NULL ENABLE,
    IDLOGPERS VARCHAR2(100) NOT NULL ENABLE,
    DATEAPPLICATION DATE NOT NULL ENABLE,
    IDTYPEDEBAUCHE VARCHAR2(100) NOT NULL ENABLE,
    ETAT NUMBER(*,0),
    IDUSER VARCHAR2(100),
    MOTIF VARCHAR2(100),
    DATE_REINTEGRATION DATE,
    DATE_DECISION DATE,
    REFDECISION VARCHAR2(100),
    IDAVANCEMENT VARCHAR2(100),
    DATEFIN DATE,
    IDPASSATION VARCHAR2(100),
    DUREEPREAVIS NUMBER(30,2),
    STC NUMBER,
    CONSTRAINT LOG_EMPLOYE_VALIDE_PK PRIMARY KEY (ID)
);



CREATE TABLE PAIE_EDITIONMOISANNEE
(
    ID VARCHAR2(150) NOT NULL ENABLE,
    IDPERSONNEL VARCHAR2(150),
    MOIS NUMBER(*,0) NOT NULL ENABLE,
    ANNEE NUMBER(*,0) NOT NULL ENABLE,
    MONTANT NUMBER(30,2),
    GAIN NUMBER(30,2),
    RETENUE NUMBER(30,2),
    ETAT NUMBER(*,0),
    IDUSER VARCHAR2(150),
    IDDIRECTION VARCHAR2(150),
    DATY DATE,
    CONSTRAINT PAIE_EDITIONMOISANNEE_PK PRIMARY KEY (ID)
);

CREATE TABLE PAIE_EDITION
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    IDPERSONNEL VARCHAR2(50) NOT NULL ENABLE,
    IDELEMENTPAIE VARCHAR2(50) NOT NULL ENABLE,
    MOIS NUMBER(*,0) NOT NULL ENABLE,
    ANNEE NUMBER(*,0) NOT NULL ENABLE,
    GAIN NUMBER(30,2),
    RETENUE NUMBER(30,2),
    DATEDEBUT DATE,
    DATEFIN DATE,
    IDEDITION VARCHAR2(100),
    REMARQUE VARCHAR2(1000),
    COMPTEGEN_DB VARCHAR2(100),
    COMPTEANA_DB VARCHAR2(100),
    COMPTEGEN_CR VARCHAR2(100),
    COMPTEANA_CR VARCHAR2(100),
    IDFONCTION VARCHAR2(50),
    IDCATEGORIE VARCHAR2(50),
    TAUXHORAIRE NUMBER(30,2),
    SALAIREDEBASE NUMBER(30,2),
    MATRICULE VARCHAR2(50),
    DIRECTION VARCHAR2(50),
    SERVICE VARCHAR2(50),
    MODEPAIEMENT VARCHAR2(50),
    NBENFANT NUMBER,
    REGROUPEMENT NUMBER,
    TEMPORAIRE NUMBER,
    ETAT NUMBER,
    CONSTRAINT PAIE_EDITION_PKEY PRIMARY KEY (ID),
    CONSTRAINT FK_PAIE_EDITIONMOISANNEE FOREIGN KEY (IDEDITION)
        REFERENCES PAIE_EDITIONMOISANNEE (ID) ENABLE
);

CREATE TABLE PAIE_AVANCEMENT
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    ID_LOGPERS VARCHAR2(50) NOT NULL ENABLE,
    DATE_APPLICATION DATE,
    DIRECTION VARCHAR2(50),
    SERVICE VARCHAR2(50),
    IDFONCTION VARCHAR2(50),
    IDCATEGORIE VARCHAR2(50),
    ECHELON NUMBER(*,0),
    DATEDECISION DATE,
    REMARQUE VARCHAR2(255),
    REFDECISION VARCHAR2(255),
    CLASSEE VARCHAR2(50),
    INDICEGRADE NUMBER(*,0),
    INDICE_FONCTIONNEL NUMBER(*,0),
    MATRICULE_PATRON VARCHAR2(50),
    STATUT VARCHAR2(50),
    DROIT_HS VARCHAR2(20),
    VEHICULEE NUMBER(*,0) DEFAULT 0,
    ETAT NUMBER(*,0),
    CTG VARCHAR2(50),
    MOTIF VARCHAR2(50),
    IDUSER VARCHAR2(50),
    INDICE_CT NUMBER(*,0),
    CODE_BANQUE VARCHAR2(100),
    REGION VARCHAR2(500),
    CONTRAT VARCHAR2(255),
    TYPEPERSONNEL VARCHAR2(255),
    DUREECONTRAT NUMBER,
    MODEPAIEMENT VARCHAR2(255),
    CONSTRAINT PAIE_AVANCEMENT_PKEY PRIMARY KEY (ID)
);

CREATE TABLE PAIE_EDITIONMOISANNEE_STC
(
    ID VARCHAR2(150) NOT NULL ENABLE,
    IDPERSONNEL VARCHAR2(150),
    MOIS NUMBER(*,0) NOT NULL ENABLE,
    ANNEE NUMBER(*,0) NOT NULL ENABLE,
    MONTANT NUMBER(30,2),
    GAIN NUMBER(30,2),
    RETENUE NUMBER(30,2),
    ETAT NUMBER(*,0),
    IDUSER VARCHAR2(150),
    IDDIRECTION VARCHAR2(150),
    DATY DATE,
    CONSTRAINT PAIE_EDITIONMOISANNEE_STC_PK PRIMARY KEY (ID)
);

CREATE TABLE PAIE_CATEGORIE
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    VAL VARCHAR2(50),
    DESCE VARCHAR2(255),
    TAUX VARCHAR2(50),
    CONSTRAINT PAIE_CATEGORIE_PKEY PRIMARY KEY (ID)
);

/* ================================================ */
--
-- CREATE TABLE PAIE_INFO_PERSONNEL
-- (
--     ID VARCHAR2(50) NOT NULL ENABLE,
--     DATESAISIE DATE,
--     MATRICULE VARCHAR2(50),
--     LIEU_NAISSANCE_COMMUNE VARCHAR2(50),
--     LIEU_DELIVRANCE_CIN VARCHAR2(50),
--     SITUATION_MATRIMONIAL VARCHAR2(50),
--     INITIALE VARCHAR2(50),
--     CTURGENCE_NOM_PRENOM VARCHAR2(255),
--     CTURGENCE_TELEPHONE1 VARCHAR2(50),
--     CTURGENCE_TELEPHONE2 VARCHAR2(50),
--     CTURGENCE_TELEPHONE3 VARCHAR2(50),
--     IDCONJOINT VARCHAR2(50),
--     CODE_AGENCE_BANQUE VARCHAR2(50),
--     BANQUE_NUMERO_COMPTE VARCHAR2(50),
--     BANQUE_COMPTE_CLE VARCHAR2(50),
--     DATEEMBAUCHE DATE,
--     IDFONCTION VARCHAR2(50),
--     IDCATEGORIE VARCHAR2(50),
--     MODE_PAIEMENT VARCHAR2(50),
--     CLASSEE VARCHAR2(50),
--     INDICEGRADE NUMBER(*,0),
--     INDICE_FONCTIONNEL NUMBER(*,0),
--     MATRICULE_PATRON VARCHAR2(50),
--     STATUT VARCHAR2(50),
--     DROIT_HS VARCHAR2(1),
--     VEHICULEE NUMBER(*,0) DEFAULT 0,
--     ECHELON NUMBER(*,0),
--     ETAT NUMBER(*,0),
--     CTG VARCHAR2(50),
--     IDUSER VARCHAR2(50),
--     INDICE_CT NUMBER(*,0),
--     DATEPROMOTION DATE,
--     NUMERO_CNAPS VARCHAR2(50),
--     NUMERO_OSTIE VARCHAR2(50),
--     TEMPORAIRE NUMBER(*,0),
--     N_EMBAUCHE VARCHAR2(50),
--     DATE_DEPART DATE,
--     N_DEPART VARCHAR2(50),
--     NBENFANT NUMBER(*,0),
--     HEUREJOURNALIER NUMBER(30,2),
--     HEUREHEBDOMADAIRE NUMBER(30,2),
--     HEUREMENSUEL NUMBER(30,2),
--     INDESIRABLE NUMBER(*,0),
--     DUREE NUMBER(30,2),
--     TELEPHONE VARCHAR2(100),
--     MAIL VARCHAR2(500),
--     ADRESSE_LIGNE1 VARCHAR2(100),
--     ADRESSE_LIGNE2 VARCHAR2(100),
--     CODE_POSTAL VARCHAR2(100),
--     REGION VARCHAR2(100),
--     IDCATEGORIE_PAIE VARCHAR2(500),
--     IDQUALIFICATION VARCHAR2(500),
--     FORMATION VARCHAR2(1000),
--     DISCIPLINE VARCHAR2(1000),
--     ANNEEEXPERIENCE VARCHAR2(1000),
--     PERSONNEL_ETAT NUMBER(*,0),
--     PERIODE_ESSAI NUMBER(*,0),
--     DEBUTCONTRAT DATE,
--     FINCONTRAT DATE,
--     REFUSER NUMBER(*,0),
--     TYPECONTRAT VARCHAR2(100),
--     CONSTRAINT PAIE_INFO_PERSONNEL_PK PRIMARY KEY (ID) ENABLE,
--     CONSTRAINT CATEGORIE_PAIE_FK FOREIGN KEY (IDCATEGORIE_PAIE)
--         REFERENCES CATEGORIE_PAIE (ID) ENABLE,
--     CONSTRAINT QUALIFICATION_PAIE_FK FOREIGN KEY (IDQUALIFICATION)
--         REFERENCES QUALIFICATION_PAIE (ID) ENABLE
-- );

ALTER TABLE PAIE_INFO_PERSONNEL
    ADD (
        TYPECONTRAT VARCHAR2(100)
    );


CREATE TABLE PAIE_ARCHIVE
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    IDPERSONNEL VARCHAR2(50),
    MOIS NUMBER(*,0),
    ANNEE NUMBER(*,0),
    FONCTION VARCHAR2(50),
    MONTANT NUMBER(30,2),
    CONSTRAINT PAIE_ARCHIVE_PK PRIMARY KEY (ID),
    CONSTRAINT PAIE_ARCHIVE_PERSONNEL_FK FOREIGN KEY (IDPERSONNEL)
        REFERENCES PAIE_INFO_PERSONNEL (ID) ENABLE
);
--
-- CREATE TABLE CATEGORIE_QUALIFICATION
-- (
--     ID VARCHAR2(100) NOT NULL ENABLE,
--     IDCATEGORIE VARCHAR2(500),
--     IDQUALIFICATION VARCHAR2(500),
--     REMARQUE VARCHAR2(500),
--     ETAT NUMBER(*,0),
--     MONTANT NUMBER(30,2),
--     DATE_DEBUT DATE,
--     DATE_FIN DATE,
--     AVENANT NUMBER(*,0),
--     CONSTRAINT CATEGORIE_QUALIFICATION_PK PRIMARY KEY (ID),
--     CONSTRAINT CATEGORIE_FK FOREIGN KEY (IDCATEGORIE)
--         REFERENCES CATEGORIE_PAIE (ID) ENABLE,
--     CONSTRAINT QUALIFICATION_FK FOREIGN KEY (IDQUALIFICATION)
--         REFERENCES QUALIFICATION_PAIE (ID) ENABLE
-- );
/* =================================== */

CREATE TABLE PAIE_EDITION_STC
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    IDPERSONNEL VARCHAR2(50) NOT NULL ENABLE,
    IDELEMENTPAIE VARCHAR2(50) NOT NULL ENABLE,
    MOIS NUMBER(*,0) NOT NULL ENABLE,
    ANNEE NUMBER(*,0) NOT NULL ENABLE,
    GAIN NUMBER(30,2),
    RETENUE NUMBER(30,2),
    DATEDEBUT DATE,
    DATEFIN DATE,
    IDEDITION VARCHAR2(100),
    REMARQUE VARCHAR2(1000),
    COMPTEGEN_DB VARCHAR2(100),
    COMPTEANA_DB VARCHAR2(100),
    COMPTEGEN_CR VARCHAR2(100),
    COMPTEANA_CR VARCHAR2(100),
    IDFONCTION VARCHAR2(50),
    IDCATEGORIE VARCHAR2(50),
    TAUXHORAIRE NUMBER(30,2),
    SALAIREDEBASE NUMBER(30,2),
    MATRICULE VARCHAR2(50),
    DIRECTION VARCHAR2(50),
    SERVICE VARCHAR2(50),
    MODEPAIEMENT VARCHAR2(50),
    NBENFANT NUMBER,
    REGROUPEMENT NUMBER,
    TEMPORAIRE NUMBER,
    ETAT NUMBER,
    CONSTRAINT PAIE_EDITION_STC_PKEY PRIMARY KEY (ID)
);

CREATE TABLE PAIE_SOLDETOUTCOMPTE
(
    ID VARCHAR2(100) NOT NULL ENABLE,
    ID_EMPLOYER VARCHAR2(100) NOT NULL ENABLE,
    DATE_SOLDE DATE NOT NULL ENABLE,
    MONTANT NUMBER(30,2) NOT NULL ENABLE,
    MOTIF VARCHAR2(250),
    ETAT NUMBER(*,0),
    IDUSER VARCHAR2(150),
    MONTANTCONGE NUMBER(30,2),
    CONSTRAINT PAIE_SOLDETOUTCOMPTE_PK PRIMARY KEY (ID)
);
/* ================================================ */


CREATE TABLE TRAITEMENT_PAIE
(
    ID VARCHAR2(255) NOT NULL ENABLE,
    IDPERSONNEL VARCHAR2(255),
    NETAPAYER NUMBER(30,2),
    MODEPAIEMENT VARCHAR2(255),
    NUMEROCOMPTE VARCHAR2(100),
    ETAT NUMBER(*,0),
    IDEDITION VARCHAR2(50),
    CONSTRAINT TRAITEMENT_PAIE_PK PRIMARY KEY (ID),
    CONSTRAINT TRAITEPAIE_EDITION_FK FOREIGN KEY (IDEDITION)
        REFERENCES PAIE_EDITIONMOISANNEE (ID) ENABLE
);


/* ================================================ */
/* ================================================ */
/* ================================================ */

-- si besoin ihany vao atao fa normalement tokony efa hisy tables roles
-- CREATE TABLE ROLES
-- (	IDROLE VARCHAR2(20) NOT NULL ENABLE,
--      DESCROLE VARCHAR2(50),
--      RANG NUMBER(*,0),
--      CONSTRAINT PK_ROLES PRIMARY KEY (IDROLE)
-- ) ;



-- drop table LOG_PERSONNEL;
-- CREATE TABLE LOG_PERSONNEL
-- (
--     ID VARCHAR2(50) NOT NULL ENABLE,
--     PERMIS_CONDUIRE VARCHAR2(255),
--     CHEMIN_PERMIS VARCHAR2(255),
--     REMARQUE VARCHAR2(255),
--     ID_PERS VARCHAR2(50),
--     NOM VARCHAR2(100),
--     PRENOM VARCHAR2(100),
--     DATE_NAISSANCE DATE,
--     SEXE CHAR(1),
--     NUMERO_CIN VARCHAR2(100),
--     DATE_CIN DATE,
--     DATE_DUPL_CIN DATE,
--     NATIONALITE VARCHAR2(50) NOT NULL ENABLE,
--     ADRESSE VARCHAR2(200),
--     FOKOTANY VARCHAR2(50),
--     ACTE_NAISSANCE VARCHAR2(100),
--     DIRECTION VARCHAR2(50) NOT NULL ENABLE,
--     SERVICE VARCHAR2(50) NOT NULL ENABLE,
--     REFUSER NUMBER(*,0),
--     IDSUP VARCHAR2(100),
--     IDHIERARCHIE VARCHAR2(100),
--     CHEMINIMAGE VARCHAR2(255),
--     PRIMARY KEY (ID) ENABLE,
--     CONSTRAINT LOGPERS_ETATH_ID_FK FOREIGN KEY (IDHIERARCHIE)
--         REFERENCES ETATHIERARCHIE (ID) ENABLE,
--     CONSTRAINT LOGPERS_LOGPERS_ID_FK FOREIGN KEY (IDSUP)
--         REFERENCES LOG_PERSONNEL (ID) ENABLE,
--     CONSTRAINT LOGPERS_UTILISATEUR_ID_FK FOREIGN KEY (REFUSER)
--         REFERENCES UTILISATEUR (REFUSER) ENABLE
-- );

ALTER TABLE LOG_PERSONNEL
    ADD (
        REFUSER NUMBER(*,0),
        IDSUP VARCHAR2(100),
        IDHIERARCHIE VARCHAR2(100),
        CHEMINIMAGE VARCHAR2(255)
    );

ALTER TABLE LOG_PERSONNEL
    ADD CONSTRAINT LOGPERS_UTILISATEUR_ID_FK
        FOREIGN KEY (REFUSER)
            REFERENCES UTILISATEUR (REFUSER);



CREATE TABLE PAIE_FONCTION
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    VAL VARCHAR2(50),
    DESCE VARCHAR2(255),
    IDGROUPEFONCTION VARCHAR2(50),
    GRATIFICATION VARCHAR2(5),
    CONSTRAINT PAIE_FONCTION_PKEY PRIMARY KEY (ID)
);

CREATE TABLE ORGANIGRAMME
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(500),
     DESCE VARCHAR2(500),
     RANG NUMBER(*,0),
     CONSTRAINT "ORGANIGRAMME_PK" PRIMARY KEY ("ID")
) ;


CREATE TABLE PAIE_PERSONNEL_ELEMENTPAIE
(
    ID VARCHAR2(100) NOT NULL ENABLE,
    CODE_RUBRIQUE VARCHAR2(100) NOT NULL ENABLE,
    DATE_DEBUT DATE,
    DATE_FIN DATE,
    GAIN NUMBER(30,2),
    RETENUE NUMBER(30,2),
    REMARQUE VARCHAR2(255),
    IDPERSONNEL VARCHAR2(100),
    ETAT NUMBER(*,0) DEFAULT 1 NOT NULL ENABLE,
    ID_OBJET VARCHAR2(100),
    IDUSER VARCHAR2(100),
    MOISREGULARISATION VARCHAR2(10),
    ANNEEREGULARISATION VARCHAR2(10),
    IDCATEGORIE_QUALIFICATION VARCHAR2(100),
    IDFONCTION VARCHAR2(100),
    POURCENTAGE NUMBER(30,2),
    QUANTITE NUMBER(30,2),
    UNITE VARCHAR2(200),
    CONSTRAINT PAIE_PERS_ELPAIE_PKEY PRIMARY KEY (ID),
    CONSTRAINT PAIE_CATEGORIE_FK FOREIGN KEY (IDCATEGORIE_QUALIFICATION)
        REFERENCES CATEGORIE_QUALIFICATION (ID) ENABLE,
    CONSTRAINT PAIE_PERSONNEL_FONCTION_FK FOREIGN KEY (IDFONCTION)
        REFERENCES PAIE_FONCTION (ID) ENABLE
);

-- CREATE TABLE POSTE
-- (
--     ID VARCHAR2(100) NOT NULL ENABLE,
--     VAL VARCHAR2(500),
--     DESCE VARCHAR2(500),
--     CONSTRAINT POSTE_PK PRIMARY KEY (ID) ENABLE
-- );

CREATE TABLE FORMATION_DIPLOME
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(500),
     DESCE VARCHAR2(500),
     CONSTRAINT FORMATION_DIPLOME_PK PRIMARY KEY (ID)
);

CREATE TABLE PAIE_GROUPEFONCTION
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(50),
     DESCE VARCHAR2(100),
     CONSTRAINT PK_ID_PAIE_GROUPEFONCTION PRIMARY KEY (ID)
);


CREATE TABLE POINTAGE
(	ID VARCHAR2(255) NOT NULL ENABLE,
     IDPERSONNEL VARCHAR2(50),
     DIRECTION VARCHAR2(50),
     HEURENORMAL NUMBER(30,2),
     HEURESUPNORMAL NUMBER(30,2),
     HEURESUPNUIT NUMBER(30,2),
     HEURESUPFERIE NUMBER(30,2),
     HEURESUPWEEKEND NUMBER(30,2),
     ABSENCE NUMBER(30,2),
     DATY DATE,
     MOIS NUMBER(*,0),
     ANNEE NUMBER(*,0),
     ETAT NUMBER(*,0),
     CONSTRAINT POINTAGE_PK PRIMARY KEY (ID)
) ;

-- CREATE TABLE CONFIGURATION
-- (	ID VARCHAR2(100) NOT NULL ENABLE,
--      VALMIN VARCHAR2(100),
--      VALMAX VARCHAR2(100),
--      DESCE VARCHAR2(100),
--      REMARQUE VARCHAR2(100),
--      DATY DATE,
--      TYPECONFIG VARCHAR2(100),
--      COMPTE_CREDIT VARCHAR2(50),
--      CONSTRAINT CONFIGURATION_PK PRIMARY KEY (ID)
-- );
--

INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0002', '1', '1', 'pourcentage ostie', 'pourcentage ostie', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0003', '0', '350000', 'IRSA', '0', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0008', '2000', '350000', 'irsa conf', 'irsa conf', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0009', '2000', '2000', 'Abbatement enfant', 'Abbatement enfant', TIMESTAMP '2022-05-21 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0004', '350000', '400000', 'IRSA', '5', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0005', '400000', '500000', 'IRSA', '10', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0006', '500000', '600000', 'IRSA', '15', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0007', '600000', '80000000000', 'IRSA', '20', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONFSIGN', 'RAZANAMAVO Solo Fiononana', 'RANDIMBY Nirina', 'Signataire pdf', 'Signataire pdf', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF000250', '0', '0', 'valeur d''indice', 'valeur d''indice', TIMESTAMP '2021-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONFCNAPS', '0.01', '0.01', 'pourcentage cnaps', 'pourcentage cnaps', TIMESTAMP '2022-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONFCNAPS-EMP', '0.13', '0.13', 'pourcentage cnaps emp', 'pourcentage cnaps emp', TIMESTAMP '2022-01-22 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONFIG0002', '20', '20', 'avance', 'avance', TIMESTAMP '2022-03-23 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF00010', '16000', '16000', 'pourcentage cnaps', 'cnaps_plafond', TIMESTAMP '2022-11-30 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONFIG0010', 'AAA', 'ZZZ', 'lettrage', 'AAF', TIMESTAMP '2023-03-30 00:00:00.000000', 'lettrage', NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF00011', '17364', '17364', 'pourcentage cnaps', 'cnaps_plafond', TIMESTAMP '2022-11-30 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF0001', '21014.40', '21014.40', 'plafond cnaps', 'cnaps_plafond', TIMESTAMP '2024-03-01 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF00012', '19104', '19104', 'plafond cnaps', 'cnaps_plafond', TIMESTAMP '2023-08-01 00:00:00.000000', NULL, NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF000252', '173.33', '173.33', 'Heure mensuelle non-agricole', 'HeureMensuelleNA', TIMESTAMP '2019-04-30 00:00:00.000000', 'paie', NULL);

INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONF000065111	0	26	Cycle Compta Lettrage	KBI	2015-11-17 00:00:00.000	lettrage	', '0', '26', 'Cycle Compta Lettrage', 'AAG', NULL, 'lettrage', NULL);
INSERT INTO CONFIGURATION
(ID, VALMIN, VALMAX, DESCE, REMARQUE, DATY, TYPECONFIG, COMPTE_CREDIT)
VALUES('CONFSMIG', '300000', '300000', 'SMIG', NULL, TIMESTAMP '2025-07-01 00:00:00.000000', 'Charge', NULL);



CREATE TABLE RUBRIQUEMANUEL
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(500),
     DESCE VARCHAR2(500),
     CONSTRAINT RUBRIQUEMANUEL_PK PRIMARY KEY (ID)
);


CREATE TABLE TYPEAVANCE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(100) NOT NULL ENABLE,
     DESCE VARCHAR2(100) NOT NULL ENABLE,
     CONSTRAINT TYPEAVANCE_PK PRIMARY KEY (ID)
);

INSERT INTO TYPEAVANCE (ID, VAL, DESCE) VALUES ('PRU0447', 'Avance sur salaire', '810');
INSERT INTO TYPEAVANCE (ID, VAL, DESCE) VALUES ('PRU0453', 'Avance Exceptionnelle', '800');

CREATE TABLE AVANCE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     IDTYPEAVANCE VARCHAR2(100) NOT NULL ENABLE,
     IDPERSONNEL VARCHAR2(100) NOT NULL ENABLE,
     MONTANT NUMBER(30,2),
     NBREMBOURSEMENT NUMBER(*,0),
     DATY DATE,
     DATEAVANCE DATE,
     REMARQUE VARCHAR2(1000),
     ETAT NUMBER(*,0),
     CONSTRAINT AVANCE_TYPE_FK FOREIGN KEY (IDTYPEAVANCE)
         REFERENCES TYPEAVANCE (ID) ENABLE
);

CREATE TABLE REMBOURSEMENT
(	ID VARCHAR2(100) NOT NULL ENABLE,
     IDAVANCE VARCHAR2(100) NOT NULL ENABLE,
     MOIS NUMBER(*,0),
     ANNEE NUMBER(*,0),
     MONTANT NUMBER(30,2),
     DATY DATE,
     REMARQUE VARCHAR2(1000),
     ETAT NUMBER(*,0)
);

CREATE TABLE TYPEFAUTE
(	ID VARCHAR2(100),
     VAL VARCHAR2(255),
     DESCE VARCHAR2(255),
     CONSTRAINT TYPEFAUTE_PK PRIMARY KEY (ID)
);

INSERT INTO TYPEFAUTE
(ID, VAL, DESCE)
VALUES('TFAU002', 'Légère', 'Légère');
INSERT INTO TYPEFAUTE
(ID, VAL, DESCE)
VALUES('TFAU003', 'Répetéé', 'Répetéé');
INSERT INTO TYPEFAUTE
(ID, VAL, DESCE)
VALUES('TFAU004', 'Sérieuse', 'Sérieuse');
INSERT INTO TYPEFAUTE
(ID, VAL, DESCE)
VALUES('TFAU005', 'Grave', 'Grave');
INSERT INTO TYPEFAUTE
(ID, VAL, DESCE)
VALUES('TFAU006', 'Lourde', 'Lourde');

CREATE TABLE TYPESANCTION
(	ID VARCHAR2(100),
     VAL VARCHAR2(255),
     DESCE VARCHAR2(255),
     CONSTRAINT TYPESANCTION_PK PRIMARY KEY (ID)
);

INSERT INTO TYPESANCTION
(ID, VAL, DESCE)
VALUES('TSANC009', 'Licenciement sans préavis', 'Licenciement sans préavis');

CREATE TABLE REGLEMENTINTERIEUR
(	ID VARCHAR2(100),
     NUMEROREGLE NUMBER(*,0),
     DESCRIPTIONREGLE VARCHAR2(200),
     NIVEAU NUMBER(*,0),
     CONSTRAINT REGLEMENTINTERIEUR_PK PRIMARY KEY (ID)
);

INSERT INTO REGLEMENTINTERIEUR
(ID, NUMEROREGLE, DESCRIPTIONREGLE, NIVEAU)
VALUES('RGI00001', 1, 'Respecter les horaires de travail', 1);
INSERT INTO REGLEMENTINTERIEUR
(ID, NUMEROREGLE, DESCRIPTIONREGLE, NIVEAU)
VALUES('RGI0001', 27, 'Prevenir en cas d`absence ou de retard', 1);


CREATE TABLE SANCTION
(	ID VARCHAR2(255) NOT NULL ENABLE,
     DATY DATE,
     IDPERSONNE VARCHAR2(255),
     TYPEFAUTE VARCHAR2(100),
     DESCRIPTIONFAUTE VARCHAR2(200),
     IDREGLEENFREINTE VARCHAR2(100),
     TYPESANCTION VARCHAR2(100),
     NIVEAUSANCTION NUMBER(*,0),
     DATEDEBUT DATE,
     DUREE NUMBER(*,0),
     ETAT NUMBER(*,0),
     CONSTRAINT SANCTION_PK PRIMARY KEY (ID),
     CONSTRAINT SANCTION_PAIEINFO_FK FOREIGN KEY (IDPERSONNE)
         REFERENCES PAIE_INFO_PERSONNEL (ID) ENABLE,
     CONSTRAINT SANCTION_REGLE_FK FOREIGN KEY (IDREGLEENFREINTE)
         REFERENCES REGLEMENTINTERIEUR (ID) ENABLE,
     CONSTRAINT SANCTION_TYPEFAUTE_FK FOREIGN KEY (TYPEFAUTE)
         REFERENCES TYPEFAUTE (ID) ENABLE,
     CONSTRAINT SANCTION_TYPE_FK FOREIGN KEY (TYPESANCTION)
         REFERENCES TYPESANCTION (ID) ENABLE
) ;

CREATE TABLE DEC_DECISION_CATEGORIE
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(255),
     DESCE VARCHAR2(255),
     CONSTRAINT DEC_DECISION_CATEGORIE_PKEY PRIMARY KEY (ID)
);

INSERT INTO DEC_DECISION_CATEGORIE (ID, VAL, DESCE) VALUES ('DECC1', 'DEPART', 'DEPART');
INSERT INTO DEC_DECISION_CATEGORIE (ID, VAL, DESCE) VALUES ('DECC2', 'MOUVEMENT', 'MOUVEMENT');
INSERT INTO DEC_DECISION_CATEGORIE (ID, VAL, DESCE) VALUES ('DECC3', 'CONGE', 'CONGE');
INSERT INTO DEC_DECISION_CATEGORIE (ID, VAL, DESCE) VALUES ('DECC4', 'DEPLACEMENT', 'DEPLACEMENT');


CREATE TABLE DEC_DECISION_TYPE
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(255),
     DESCE VARCHAR2(50),
     CONSTRAINT DEC_DECISION_TYPE_PKEY PRIMARY KEY (ID),
     CONSTRAINT DEC_DECISION_TYPE_DESCE_FKEY FOREIGN KEY (DESCE)
         REFERENCES DEC_DECISION_CATEGORIE (ID) ENABLE
);

INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000005', 'CHANGEMENT D'' INDICE', 'DECC2');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000006', 'CHANGEMENT DE SALAIRE', 'DECC2');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000007', 'CHANGEMENT DE RATTACHEMENT', 'DECC2');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000008', 'CHANGEMENT DE FONCTION', 'DECC2');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000009', 'CHANGEMENNT DE REGION', 'DECC3');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000010', 'CHANGEMENT D''AFFECTATION', 'DECC3');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000011', 'CHANGEMENNT DE MODE DE PAIEMENT', 'DECC1');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD000012', 'CHANGEMENT DE COMPTE', 'DECC1');
INSERT INTO DEC_DECISION_TYPE (ID, VAL, DESCE) VALUES ('TYD0000_13', 'CHANGEMENT DE CONTRAT', 'DECC2');

CREATE TABLE REGION
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(500),
     DESCE VARCHAR2(500),
     CONSTRAINT REGION_PK PRIMARY KEY (ID)
);

INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG0001', 'ANALAMANGA', 'ANL');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG0003', 'VAKINAKARATRA', 'VKN');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG000000', 'MENABE', 'MNB');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG0004', 'ANOSY', 'ANS');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG000002', 'BETSIBOKA', 'BET');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG0002', 'BONGOLAVA', 'BGL');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG000004', 'HAUTE MATSIATRA', 'HM');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG000006', 'ATSINANANA', 'ATS');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG000007', 'ITASY', 'ITASY');
INSERT INTO REGION (ID, VAL, DESCE) VALUES ('REG000005', 'AMORON''IMANIA', 'AIM');

CREATE TABLE TRS_BANQUES_AGENCES
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(50) NOT NULL ENABLE,
     DESCE VARCHAR2(200),
     CONSTRAINT TRS_BANQUES_AGENCES_PKEY PRIMARY KEY (ID)
);


CREATE TABLE ETATHIERARCHIE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(200),
     DESCE VARCHAR2(200),
     ETATVISA NUMBER(*,0),
     ETATANNULE NUMBER(*,0),
     IDROLE VARCHAR2(100),
     CONSTRAINT ETATHIERARCHIE_PK PRIMARY KEY (ID),
     CONSTRAINT ETATHIERAR_ROLE_ID_FK FOREIGN KEY (IDROLE)
         REFERENCES ROLES (IDROLE) ENABLE
);

/* =================================================== */

CREATE TABLE MOUVEMENTABSENCE
(	ID VARCHAR2(255) NOT NULL ENABLE,
     IDSOURCE VARCHAR2(100),
     IDPERSONNEL VARCHAR2(50),
     DATEDEBUT DATE,
     MOIS NUMBER(*,0),
     ANNEE NUMBER(*,0),
     PLUS NUMBER(30,2),
     MOINS NUMBER(30,2),
     MOTIF VARCHAR2(255),
     REMARQUE VARCHAR2(500),
     IDREMPLACANT VARCHAR2(50),
     DATEDEMANDE DATE,
     CONSTRAINT MOUVEMENTABSENCE_PK PRIMARY KEY (ID),
     CONSTRAINT MVTABS_PAIEINFO_FK FOREIGN KEY (IDPERSONNEL)
         REFERENCES PAIE_INFO_PERSONNEL (ID) ENABLE
) ;




CREATE TABLE TYPEABSENCE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(200),
     DESCE VARCHAR2(200),
     CONSTRAINT TYPEABSENCE_PK PRIMARY KEY (ID)
) ;

CREATE TABLE TYPEDEMANDE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(200),
     DESCE VARCHAR2(200),
     CONSTRAINT TYPEDEMANDE_PK PRIMARY KEY (ID)
) ;

INSERT INTO TYPEDEMANDE (ID, VAL, DESCE) VALUES ('TD1', 'Demande de cong&eacute;
absence', 'conge');
INSERT INTO TYPEDEMANDE (ID, VAL, DESCE) VALUES ('TD2', 'Demande d`absence', 'absence');
INSERT INTO TYPEDEMANDE (ID, VAL, DESCE) VALUES ('TD3', 'Demande de sortie', 'sortie');
INSERT INTO TYPEDEMANDE (ID, VAL, DESCE) VALUES ('TD4', 'Justification retard', 'retard');
INSERT INTO TYPEDEMANDE (ID, VAL, DESCE) VALUES ('TD6', 'Demande sortie stock', 'Demande sortie stock');



CREATE TABLE DEMANDE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     IDPERSONNEL VARCHAR2(100),
     IDTYPEDEMANDE VARCHAR2(100),
     TITRE VARCHAR2(100),
     HORAIRENORMAL VARCHAR2(20),
     HEUREDEPART VARCHAR2(20),
     HEUREARRIVE VARCHAR2(20),
     IDTYPEABSENCE VARCHAR2(100),
     MOTIF VARCHAR2(100),
     NUMERO VARCHAR2(50),
     DESCE VARCHAR2(200),
     ETAT NUMBER(*,0),
     DATY DATE,
     DUREE NUMBER(10,2),
     DATEDEPART DATE,
     DATERETOUR DATE,
     OBSERVATION VARCHAR2(50),
     REMARQUE VARCHAR2(200),
     IDREMPLACENTS VARCHAR2(100),
     RESTE_CONGE NUMBER(10,2),
     DATEFIN DATE,
     AVENANT VARCHAR2(250),
     RESTE_PERMISSION NUMBER(10,2),
     MOTIFREFU VARCHAR2(500),
     CONSTRAINT DEMANDE_PK PRIMARY KEY (ID),
     CONSTRAINT DEMANDE_PAIEINFOPERS_ID_FK FOREIGN KEY (IDPERSONNEL)
         REFERENCES PAIE_INFO_PERSONNEL (ID) ENABLE,
     CONSTRAINT DEMANDE_TYPEABS_ID_FK FOREIGN KEY (IDTYPEABSENCE)
         REFERENCES TYPEABSENCE (ID) ENABLE,
     CONSTRAINT DEMANDE_TYPEDEMANDE_ID_FK FOREIGN KEY (IDTYPEDEMANDE)
         REFERENCES TYPEDEMANDE (ID) ENABLE
);


CREATE TABLE ETATDEMANDE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(200),
     DESCE VARCHAR2(200),
     RANG NUMBER(*,0),
     IDTYPEDEMANDE VARCHAR2(100),
     IDETATHIERARCHIE VARCHAR2(100),
     CONSTRAINT ETATDEMANDE_PK PRIMARY KEY (ID)
         USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS
         STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
         PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
         TABLESPACE USERS  ENABLE,
     CONSTRAINT ETATDEMA_ETATHIER_ID_FK FOREIGN KEY (IDETATHIERARCHIE)
         REFERENCES ETATHIERARCHIE (ID) ENABLE,
     CONSTRAINT ETATDEMANDE_TYPEDEMANDE_ID_FK FOREIGN KEY (IDTYPEDEMANDE)
         REFERENCES TYPEDEMANDE (ID) ENABLE
);

CREATE TABLE HISTORIQUEDEMANDE
(	ID VARCHAR2(100) NOT NULL ENABLE,
     IDPERSONNEL VARCHAR2(100),
     IDDEMANDE VARCHAR2(100),
     DATY DATE,
     HEURE VARCHAR2(50),
     ETATDEMANDE NUMBER(*,0),
     CONSTRAINT HISTORIQUEDEMANDE_PK PRIMARY KEY (ID)
         USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS
         STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
         PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
         TABLESPACE USERS  ENABLE,
     CONSTRAINT HISTDEMANDE_DEMANDE_ID_FK FOREIGN KEY (IDDEMANDE)
         REFERENCES DEMANDE (ID) ENABLE,
     CONSTRAINT HISTDEMANDE_PAIEINFOPERS_ID_FK FOREIGN KEY (IDPERSONNEL)
         REFERENCES PAIE_INFO_PERSONNEL (ID) ENABLE
);


CREATE TABLE PAIE_RUBRIQUE
(
    ID VARCHAR2(50) NOT NULL ENABLE,
    VAL VARCHAR2(100),
    DESCE VARCHAR2(255),
    RANG NUMBER(*,0),
    REMARQUE VARCHAR2(255),
    COMPTEPCG VARCHAR2(50),
    CODE VARCHAR2(50),
    TYPERUBRIQUE VARCHAR2(1),
    BCS VARCHAR2(50),
    BG VARCHAR2(1),
    IMPOSABLE VARCHAR2(1),
    NATURE VARCHAR2(50),
    AVANTAGE VARCHAR2(1),
    FORMULE VARCHAR2(100),
    ISINFINI NUMBER(*,0) DEFAULT 1,
    ETAT NUMBER(*,0) DEFAULT 1 NOT NULL ENABLE,
    CPT_GEN_DB VARCHAR2(50),
    CPT_GEN_CR VARCHAR2(50),
    CPT_ANA_DB VARCHAR2(50),
    CPT_ANA_CR VARCHAR2(50),
    AFFICHER NUMBER(*,0),
    REGROUPEMENT NUMBER(*,0),
    ARRONDI NUMBER(*,0),
    INSERTED NUMBER(*,0) DEFAULT 1,
    SOMMABLE NUMBER(*,0) DEFAULT 1,
    BENEFICIAIRE VARCHAR2(1000),
    REMARQUEFORMULE VARCHAR2(1000),
    UNITEFORMULE VARCHAR2(1000),
    QTEFORMULE VARCHAR2(1000),
    MAJORATION NUMBER(*,0),
    QTE VARCHAR2(1000),
    PU NUMBER(30,2),
    RANGBULLETIN NUMBER(*,0),
    CONSTRAINT PAIE_RUBRIQUE_PKEY PRIMARY KEY (ID)
);



INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000021', 'INDEMNITÉS DIVERSES FIXES', 'INDEMNITÉS DIVERSES FIXES', 210, NULL, NULL, '103', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 8, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000061', 'ALLOCATION CONGÉ', 'ALLOCATION CONGÉ', 300, NULL, NULL, '104', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 6, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 4);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRUNIARD', 'net imposable arrondi', 'net imposable arondi', 8810, NULL, NULL, 'NIA', 'R', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 0, 13, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 13);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000081', 'AUTRES INDEMNITES', 'GAUTRES', 220, NULL, NULL, '105', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, NULL, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 5);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000121', 'DIVERSES RETENUES', 'RRETENU', 9500, NULL, NULL, '202', 'R', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, NULL, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 7);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000141', 'IRSA', 'IRSA', 9300, NULL, NULL, '299', 'R', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 14, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 9);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000181', 'ABATTEMENT', 'GABBT', 9000, NULL, NULL, '106', 'G', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 0, NULL, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 8);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000041', 'SALAIRE DE BASE', 'SBASE', 100, NULL, NULL, '101', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 1, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000001', 'PRIME', 'PRIME', 200, NULL, NULL, '102', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 5, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 3);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000101', 'CNAPS', 'CNAPS', 1000, NULL, NULL, '201', 'R', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 10, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 6);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000141NET', 'IRSA NET', 'IRSA NET', 9350, NULL, NULL, '300', 'R', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 15, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 9);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRU000I710', 'OSTIE', 'OSTIE', 1100, NULL, NULL, '205', 'R', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 11, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 8);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRUNI', 'net imposable', 'net imposable', 8800, NULL, NULL, 'NI', 'R', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 12, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 13);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000210A', 'NET A PAYER', 'NET A PAYER', 10000, NULL, NULL, '199', 'G', NULL, NULL, NULL, 'variable', NULL, NULL, 1, 1, NULL, NULL, NULL, NULL, 1, 18, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 15);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000224', 'RAPPEL', 'RAPPEL', 100, NULL, NULL, '107', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 3, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRU0453', 'Avance exceptionnelle', 'Avance exceptionnelle', 9800, NULL, NULL, '810', 'R', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 11, NULL, NULL, NULL, NULL, 1, 17, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRU0447', 'Avance sur salaire', 'Avance sur salaire', 9800, NULL, NULL, '800', 'R', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 11, NULL, NULL, NULL, NULL, 1, 16, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRU01000', 'Solde de tout compte', 'Solde de tout compte', 150, NULL, NULL, '108', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, NULL, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000225', 'RETENUE SUR ABSENCE', 'RETENUE SUR ABSENCE', 9100, NULL, NULL, '203', 'R', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 4, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 8);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000FRM', 'Frais médicaux', 'Frais médicaux', 1001, NULL, NULL, 'FRM', 'G', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 0, NULL, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 6);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000210Z', 'NET A PAYER ARRONDI', 'NET A PAYER ARRONDI', 11000, NULL, NULL, '219', 'G', NULL, NULL, NULL, 'variable', NULL, NULL, 1, 11, NULL, NULL, NULL, NULL, 1, 19, 2, 1, 0, '%', NULL, NULL, NULL, 0, NULL, 0, 15);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRUSIS014', 'Total gain', 'Total gain', 500, NULL, NULL, 'SUMG', 'G', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 9, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 0);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR000042', 'ALLOCATION FAMILIALE', 'ALLOCATION FAMILIALE', 100, NULL, NULL, '102', 'G', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 20, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PRUSIS015', 'Total retenu', 'Total retenu', 9900, NULL, NULL, 'SUMR', 'R', NULL, NULL, NULL, 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, NULL, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 0);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000221', 'HEURE SUPP NUIT', 'Heure supp nuit', 221, NULL, NULL, '110', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 2, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000222', 'HEURE SUPP FERIE', 'Heure supp ferie', 222, NULL, NULL, '111', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 2, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000223', 'HEURE SUPP WEEK-END', 'Heure supp week-end', 223, NULL, NULL, '112', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 2, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000229', 'HEURE SUPP NORMAL', 'Heure supp normal', 221, NULL, NULL, '113', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 2, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000232', 'PREAVIS', 'PREAVIS', 221, NULL, NULL, '206', 'R', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 7, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000220', 'HEURE NORMAL', 'Heure normal', 220, NULL, NULL, '109', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 1, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);
INSERT INTO PAIE_RUBRIQUE
(ID, VAL, DESCE, RANG, REMARQUE, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, FORMULE, ISINFINI, ETAT, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, AFFICHER, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, MAJORATION, QTE, PU, RANGBULLETIN)
VALUES('PR0000233', 'INDEMNITÉS DE LICENSIEMENT', 'INDEMNITÉS DE LICENSIEMENT', 221, NULL, NULL, '114', 'G', NULL, NULL, 'I', 'variable', NULL, NULL, 0, 1, NULL, NULL, NULL, NULL, 1, 7, 2, 1, 1, '%', NULL, NULL, NULL, NULL, NULL, NULL, 2);


CREATE TABLE DETFORMU
(	ID VARCHAR2(100) NOT NULL ENABLE,
     MIN NUMBER(30,2),
     MAX NUMBER(30,2),
     FORMULE VARCHAR2(1000),
     UNITE NUMBER(30,2),
     REMARQUE VARCHAR2(100),
     MERE VARCHAR2(100),
     FORMULECONDITION VARCHAR2(1000),
     ETAT NUMBER(*,0) DEFAULT 11 NOT NULL ENABLE,
     CREATION DATE,
     CONSTRAINT DETFORMU_PK PRIMARY KEY (ID),
     CONSTRAINT DETFORMU_MERE_FKEY FOREIGN KEY (MERE)
         REFERENCES PAIE_RUBRIQUE (ID) ENABLE
);

INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET6_1', 0.00, -1.00, 'if(([299]-[106])<3000){3000}else{[299]-[106]}', 1.00, null, 'PR000141NET', '[NI]>0 ', -1, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_PREAVIS', 0.00, -1.00, '[pers::salaire_Base]/30*[pers::nbjpreavis]', 1.00, null, 'PR0000232', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETOSTI', 0.00, -1.00, '[201]', 1.00, null, 'PRU000I710', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET5', 600000.00, -1.00, 'Math.max(([NIA]-600000),0)*0.2', 1.00, null, 'PR000141', '[NI]>600000', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETNI', 0.00, 1.00, 'Math.max([++imposable==I],0)', 1.00, null, 'PRUNI', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETNIARD', 0.00, 1.00, '[NI]-([NI]%100)', 1.00, null, 'PRUNIARD', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET2', 350000.00, 400000.00, 'Math.max((Math.min([NIA],400000)-350000),0)*0.05', 1.00, null, 'PR000141', '[NI]>350000', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET3', 400000.00, 500000.00, 'Math.max((Math.min([NIA],500000)-400000),0)*0.1', 1.00, null, 'PR000141', '[NI]>400000', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET4', 500000.00, 600000.00, 'Math.max((Math.min([NIA],600000)-500000),0)*0.15', 1.00, null, 'PR000141', '[NI]>500000', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETNAP2', 0.00, -1.00, '[199]-([199]%100)', 1.00, null, 'PR000210Z', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETSUMG', 0.00, -1.00, '[101]+[102]+[103]+[104]+[105]+[107]+[107]+[108]+[109]+[110]+[111]+[112]+[113]+[114]', 1.00, null, 'PRUSIS014', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETNAP3', 0.00, -1.00, '[SUMG]-[SUMR]', 1.00, null, 'PR000210A', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETFRAISM', 0.00, -1.00, '0.06*[++imposable==I..gain]', 1.00, null, 'PR000FRM', '1>0', -1, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETNAP', 0.00, -1.00, 'Math.round(([NI]-[204]-[300])*10)/10', 1.00, null, 'PR000210A', '1>0', -1, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETSUMR', 0.00, -1.00, '[201]+[202]+[203]+[205]+[206]+[300]+[800]+[810]', 1.00, null, 'PRUSIS015', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET6', 0.00, -1.00, 'Math.max(3000,[299]-[106])', 1.00, null, 'PR000141NET', '[NI]>0 ', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETATM', 0.00, -1.00, 'Math.max([pers::nbenfant]*[conf::CONF0009],0)', 1.00, null, 'PR000181', '1>0 ', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_LIECNSIEMENT', 0.00, -1.00, 'Math.min ( ([pers::salaire_Base]/30)*10*[pers::anciennete] ,([pers::salaire_Base]*6) )', 1.00, null, 'PR0000233', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETCNAPS', 0.00, -1.00, 'Math.min (0.01*[++imposable==I..gain], [conf::CONF0001])', 1.00, null, 'PR000101', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DETSAL', 0.00, -1.00, '([pers::salaire_Base]*[pers::nbpro])/[pers::nbjmois]', 1.00, '--', 'PR000041', '1>0', -1, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET1', 0.00, 350000.00, '3000', -1.00, null, 'PR000141', '[NI]<=350000', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_HN', 0.00, -1.00, '[pers::salaire_Base]/[conf::CONF000252]*[pers::heurenormal]*1', 1.00, null, 'PR000041', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_HS_NORM', 0.00, -1.00, '[pers::salaire_Base]/[conf::CONF000252]*[pers::heuresupnormal]*1', 1.00, null, 'PR0000229', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_HS_NUIT', 0.00, -1.00, '[pers::salaire_Base]/[conf::CONF000252]*[pers::heuresupnuit]*1.3', 1.00, null, 'PR0000221', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_HS_FERIE', 0.00, -1.00, '[pers::salaire_Base]/[conf::CONF000252]*[pers::heuresupferie]*2', 1.00, null, 'PR0000222', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_HS_WEEK', 0.00, -1.00, '[pers::salaire_Base]/[conf::CONF000252]*[pers::heuresupweekend]*2', 1.00, null, 'PR0000223', '1>0', 11, null);
INSERT INTO DETFORMU (ID, MIN, MAX, FORMULE, UNITE, REMARQUE, MERE, FORMULECONDITION, ETAT, CREATION) VALUES ('DET_CONGE2', 0.00, -1.00, '[pers::imposable12]/12/30*[pers::nbconge]', 1.00, '--', 'PR000061', '[pers::stc]>=1', 11, null);


-- DROP TABLE COMPTA_COMPTE CASCADE CONSTRAINTS;
-- CREATE TABLE COMPTA_COMPTE
-- (	ID VARCHAR2(50) NOT NULL ENABLE,
--      COMPTE VARCHAR2(100),
--      LIBELLE VARCHAR2(200),
--      TYPECOMPTE VARCHAR2(255),
--      CLASSY VARCHAR2(50),
--      ANALYTIQUE_OBLI VARCHAR2(10),
--      IDJOURNAL VARCHAR2(50),
--      CONVENTIONPROGRAMME VARCHAR2(100),
--      PLANBUDGETAIRE VARCHAR2(100),
--      FINANCEMENTCATEGORIE VARCHAR2(100),
--      PLANGEOGRAPHIQUE VARCHAR2(100),
--      PLANANALYTIQUE VARCHAR2(100),
--      MERE VARCHAR2(500),
--      CLASSE VARCHAR2(50),
--      PRIMARY KEY (ID),
--      CONSTRAINT COMPTA_COMPTE_UK1 UNIQUE (COMPTE)
-- ) ;

--
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8304', '607004', 'ACHAT ANTI-ASTHMATIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8305', '607005', 'ACHAT ANTIBIOTIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8306', '607006', 'ACHAT ANTI-CANCEREUX', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8307', '607007', 'ACHAT ANTI-DIABETIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8308', '607008', 'ACHAT ANTIEMETIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8309', '607009', 'ACHAT ANTI-GOUTTEUX', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8310', '607010', 'ACHAT ANTI-GRIPPAL', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8311', '607011', 'ACHAT ANTI-HELMENTHIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8312', '607012', 'ACHAT ANTI-HEMORRAGIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8313', '607013', 'ACHAT ANTI-HYPERTENSEUR', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8314', '607014', 'ACHAT ANTI-INFLAMMATOIRE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8315', '607015', 'ACHAT ANTI-MYCOSIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8316', '607016', 'ACHAT ANTI-PALUDEEN', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8317', '607017', 'ACHAT ANTIPYRIETIQUES', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8318', '607018', 'ACHAT ANTISEPTIQUE ET PANS', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8319', '607019', 'ACHAT ANTI-SPASMODIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8320', '607020', 'ACHAT ANTI-TUSSIF', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8321', '607021', 'ACHAT CARDIOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8322', '607022', 'ACHAT CORTICOIDE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8323', '607023', 'ACHAT DERMATOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8324', '607024', 'ACHAT DIVERS', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8325', '607025', 'ACHAT PRODUIT ECHOGRAPHIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8326', '607026', 'ACHAT FOURNITURE ECHOGRAPHIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8327', '607027', 'ACHAT FOURNTURE ECG', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC83271', '44571', 'TVA COLLECTEE', '1', '4', null, 'COMP000037', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC83272', '44566', 'TVA DEDUCTIBLE', '1', '4', null, 'COMP000037', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COCTGP01', '666000', 'PERTE DE CHANGE', '1', '6', null, null, null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COCTGP02', '766000', 'GAIN DE CHANGE', '1', '7', null, null, null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COCTGP03', '608000', 'DEDOUANEMENT', '1', '6', null, null, null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COCTGP04', '627000', 'FRAIS BANCAIRE', '1', '6', null, null, null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COCTGP05', '624000', 'TRANSPORT', '1', '6', null, null, null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008330', '3678900000000', 'Perte et Gain', '1', null, null, null, null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC10005', '46111001', 'Dunk Test', '1', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC10006', '411050', 'HM International', '1', '4', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC10007', '411051', 'Agriculture International', '1', '4', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC10008', '411025', 'Client 1', '1', '4', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0011', '71001', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0012', '71002', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0011', '61001', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0012', '61002', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0013', '61003', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('CCS1', '411053', 'Epicerie Cool', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0014', '61004', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('CCS2', '461110', 'Epicerie Antsa', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0013', '71003', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0014', '71004', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0015', '71005', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0016', '71006', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0017', '71007', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0018', '71008', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0019', '71009', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0020', '710010', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0021', '710011', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0022', '710012', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPB0023', '710013', 'vente matière première', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccS0001', '72001', 'vente main d’oeuvre', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccS0002', '72002', 'vente main d’oeuvre', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccS0003', '72003', 'vente machine', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccS0004', '72004', 'vente energie', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPF0011', '73001', 'vente PF', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPF0012', '73002', 'vente PF', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPF0013', '73003', 'vente PF', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPF0014', '73004', 'vente PF', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPV0014', '74001', 'vente pain', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPV0015', '74002', 'vente pain', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPV0016', '74003', 'vente pain', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPV0017', '74004', 'vente pain', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccPV0018', '74005', 'vente viennoiserie', '7', '1', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0015', '61005', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0016', '61006', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0017', '61007', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0018', '61008', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0019', '61009', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0020', '610010', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0021', '610011', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0022', '610012', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPB0023', '610013', 'achat matière première', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaS0001', '62001', 'achat main d’oeuvre', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaS0002', '62002', 'achat main d’oeuvre', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaS0003', '62003', 'achat machine', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaS0004', '62004', 'achat matiere premiere', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPF0011', '63001', 'achat PF', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPF0012', '63002', 'achat PF', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPF0013', '63003', 'achat PF', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPF0014', '63004', 'achat PF', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPV0014', '64001', 'achat pain', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPV0015', '64002', 'achat pain', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPV0016', '64003', 'achat pain', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPV0017', '64004', 'achat pain', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ccaPV0018', '64005', 'achat viennoiserie', '6', '1', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('CCS3', '411052', 'Bazar du quartier', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('CCS4', '411231', 'Le point chaud', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC00M712000', '712000', 'VENTES DE MARCHANDISES', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007904', '2184000000000', 'MOBILIER', '1', '2', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007920', '4112120000000', 'CLIENT ARBIOCHEM', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008205', '1431120000000', 'IMPOT', '1', '1', null, 'COMP000042', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008204', '4011234000000', 'CLIENT VAO', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007914', '1010000000000', 'CAPITAL', '1', '1', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007901', '2130000000000', 'CONSTRUCTION', '1', '2', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007902', '2182000000000', 'MAT TRANSP', '1', '2', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007906', '4110000000000', 'CLIENT', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007910', '5170000000000', 'CCPAZE', '1', '5', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007913', '5300000000000', 'CAISSE', '1', '5', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007916', '4010000000000', 'FOURNISSEUR', '1', '4', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007917', '6070000000000', 'ACHAT DE MARCHANDISES', '1', '6', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007900', '2110000000000', 'TERRAIN', '1', '2', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007903', '2183000000000', 'MAT BUREAU', '1', '2', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007905', '3700000000000', 'STOCK DE MARCHANDISES', '1', '3', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('ART2048', '8900100', 'BILAN D'' OUVERTURE', '1', '8', null, '56', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007899', '2070000000000', 'FOND  COMMERCIAL', '1', '2', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007915', '1640000000000', 'EMPRUNT', '1', '1', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007918', '6241000000000', 'PART FORFAITAIRE', '1', '6', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC007919', '5120000000000', 'BANQUE', '1', '5', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008206', '607028', 'ACHAT FOIES ET VOIES BILI', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008207', '607029', 'ACHAT FOURNITURES MEDICAUX', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008208', '607030', 'ACHAT GASTRO INTESTINALE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008209', '607031', 'ACHAT GYNECOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008210', '607032', 'ACHAT PRODUIT LABORATOIRE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008211', '607033', 'ACHAT MATERIELS MEDICAUX', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008212', '607034', 'ACHAT METABOLISME', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008213', '607035', 'ACHAT NEURO-PSYCHIATRIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008214', '607036', 'ACHAT OPHTALMOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008215', '607037', 'ACHAT ORL', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008216', '607038', 'ACHAT OUTILLAGES MEDICAUX', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008217', '607039', 'ACHAT PANSEMENT GASTRIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008218', '607040', 'ACHAT PATHOLOGIE INTESTINALE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008219', '607041', 'ACHAT PROTECTEUR VEINEUX', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008220', '607042', 'ACHAT FOURNITURE RADIOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008221', '607043', 'ACHAT PRODUIT RADIOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008222', '607044', 'ACHAT PRODUIT STOMATOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008223', '607045', 'ACHAT SULFAMIDE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008224', '607046', 'ACHAT URGENCES', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008225', '607047', 'ACHAT FOURNITURE STOMATOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008226', '607048', 'ACHAT OUTILLAGE STOMATOLOGIE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008227', '607049', 'ACHAT CATEG_TEST', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008228', '607050', 'ACHAT FOURNITURE DE BUREAU', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008229', '707001', 'VENTE ANTALGIQUE PUR', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008230', '707002', 'VENTE ANTI-ALLERGIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008231', '707003', 'VENTE ANTI-ARTHOSIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008232', '707004', 'VENTE ANTI-ASTHMATIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008233', '707005', 'VENTE ANTIBIOTIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008234', '707006', 'VENTE ANTI-CANCEREUX', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008235', '707007', 'VENTE ANTI-DIABETIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008236', '707008', 'VENTE ANTIEMETIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008237', '707009', 'VENTE ANTI-GOUTTEUX', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008238', '707010', 'VENTE ANTI-GRIPPAL', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008239', '707011', 'VENTE ANTI-HELMENTHIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008240', '707012', 'VENTE ANTI-HEMORRAGIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008241', '707013', 'VENTE ANTI-HYPERTENSEUR', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008242', '707014', 'VENTE ANTI-INFLAMMATOIRE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008243', '707015', 'VENTE ANTI-MYCOSIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008244', '707016', 'VENTE ANTI-PALUDEEN', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008245', '707017', 'VENTE ANTIPYRIETIQUES', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008246', '707018', 'VENTE ANTISEPTIQUE ET PANS', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008247', '707019', 'VENTE ANTI-SPASMODIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008248', '707020', 'VENTE ANTI-TUSSIF', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008249', '707021', 'VENTE CARDIOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008250', '707022', 'VENTE CORTICOIDE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008251', '707023', 'VENTE DERMATOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008252', '707024', 'VENTE DIVERS', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008253', '707025', 'VENTE PRODUIT ECHOGRAPHIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008254', '707026', 'VENTE FOURNITURE ECHOGRAPHIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008255', '707027', 'VENTE FOURNTURE ECG', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008256', '707028', 'VENTE FOIES ET VOIES BILI', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008257', '707029', 'VENTE FOURNITURES MEDICAUX', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008258', '707030', 'VENTE GASTRO INTESTINALE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008259', '707031', 'VENTE GYNECOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008260', '707032', 'VENTE PRODUIT LABORATOIRE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008261', '707033', 'VENTE MATERIELS MEDICAUX', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008262', '707034', 'VENTE METABOLISME', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008263', '707035', 'VENTE NEURO-PSYCHIATRIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008264', '707036', 'VENTE OPHTALMOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008265', '707037', 'VENTE ORL', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008266', '707038', 'VENTE OUTILLAGES MEDICAUX', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008267', '707039', 'VENTE PANSEMENT GASTRIQUE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008268', '707040', 'VENTE PATHOLOGIE INTESTINALE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008269', '707041', 'VENTE PROTECTEUR VEINEUX', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008270', '707042', 'VENTE FOURNITURE RADIOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008271', '707043', 'VENTE PRODUIT RADIOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008272', '707044', 'VENTE PRODUIT STOMATOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008273', '707045', 'VENTE SULFAMIDE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008274', '707046', 'VENTE URGENCES', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008275', '707047', 'VENTE FOURNITURE STOMATOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008276', '707048', 'VENTE OUTILLAGE STOMATOLOGIE', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008277', '707049', 'VENTE CATEG_TEST', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC008278', '707050', 'VENTE FOURNITURE DE BUREAU', '1', '7', null, 'COMP000039', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC0079151', '530002', 'CAISSE Pharmacie de la Digue', '1', '5', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC0079141', '530001', 'CAISSE Pharmacie Isoraka', '1', '5', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC0079152', '530003', 'CAISSE Pharmacie metropole', '1', '5', null, 'COMP000034', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8279', '401001', 'Divers Fournisseur', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8280', '401002', 'Fournisseur10', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8281', '401003', 'Fournisseur8', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8282', '401004', 'Fournisseur11', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8283', '401005', 'Fournisseur3', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8284', '401006', 'Fournisseur4', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8285', '401007', 'Fournisseur7', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8286', '401008', 'Fournisseur6', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8287', '401009', 'Fournisseur9', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8288', '401010', 'Fournisseur12', '1', '4', null, 'COMP000035', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8289', '411001', 'TIANASOA FREDERICK', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8290', '411002', 'RAKOTOMANANA JEAN', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8291', '411003', 'ANDRIAMBOLOLONA HERY', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8292', '411004', 'RASAMIMANANA FARA', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8293', '411005', 'RAKOTONIRINA SITRAKA', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8294', '411006', 'RANDRIA JOSEPH', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8295', '411007', 'RAHARISON LOVA', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8296', '411008', 'RAVOAJANAHARY MAMY', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8297', '411009', 'RAFIDISON NIRY', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8298', '411010', 'RABENJAMINA RINA', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8299', '411011', 'RASOLOFOMANANA NINA', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8300', '411012', 'DIVERS', '1', '4', null, 'COMP000044', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8301', '607001', 'ACHAT ANTALGIQUE PUR', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8302', '607002', 'ACHAT ANTI-ALLERGIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);
-- INSERT INTO COMPTA_COMPTE (ID, COMPTE, LIBELLE, TYPECOMPTE, CLASSY, ANALYTIQUE_OBLI, IDJOURNAL, CONVENTIONPROGRAMME, PLANBUDGETAIRE, FINANCEMENTCATEGORIE, PLANGEOGRAPHIQUE, PLANANALYTIQUE, MERE, CLASSE) VALUES ('COC8303', '607003', 'ACHAT ANTI-ARTHOSIQUE', '1', '6', null, 'COMP000067', null, null, null, null, null, null, null);

/* ====================================== */



CREATE TABLE MOISCP
(	ID NUMBER(*,0) NOT NULL ENABLE,
     VAL VARCHAR2(50),
     DESCE VARCHAR2(50),
     CONSTRAINT MOISCP_PKEY PRIMARY KEY (ID)
);



CREATE TABLE SEXE
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(50),
     DESCE VARCHAR2(50)
);
--
INSERT INTO SEXE (ID, VAL, DESCE) VALUES ('00', 'Feminin', 'Feminin');
INSERT INTO SEXE (ID, VAL, DESCE) VALUES ('11', 'Masculin', 'Masculin');

CREATE TABLE CONGE_FIN_2023
(	ID VARCHAR2(50) NOT NULL ENABLE,
     MATRICULE VARCHAR2(50),
     CONGE NUMBER(10,2),
     CONSTRAINT CONGE_FIN2023_PKEY PRIMARY KEY (ID) ENABLE,
     CONSTRAINT CONGE_FIN_2023_MATRICULE_KEY UNIQUE (MATRICULE)
);


CREATE TABLE ETAT_CATEG_QUALIF2
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(100) NOT NULL ENABLE,
     DESCE VARCHAR2(100) NOT NULL ENABLE,
     CONSTRAINT ETATCATEG2_PK PRIMARY KEY (ID)
);




CREATE TABLE SIG_FOKONTANY
(	ID VARCHAR2(100) NOT NULL ENABLE,
     VAL VARCHAR2(100) NOT NULL ENABLE,
     DESCE VARCHAR2(100),
     CODE_COMMUNE VARCHAR2(100) NOT NULL ENABLE,
     ID_FIV VARCHAR2(100),
     CONSTRAINT SIG_FOKONTANY_PKEY PRIMARY KEY (ID)
) ;

CREATE TABLE PAYS
(	ID VARCHAR2(50) NOT NULL ENABLE,
     VAL VARCHAR2(100),
     DESCE VARCHAR2(100),
     CONSTRAINT PK_PAYS PRIMARY KEY (ID)
);


CREATE TABLE CONFIGCNAPS_PLAFOND
(	ID VARCHAR2(100) NOT NULL ENABLE,
     DESCE VARCHAR2(100),
     REMARQUE VARCHAR2(100),
     DATY DATE,
     TYPECONFIG VARCHAR2(100),
     COMPTE_CREDIT VARCHAR2(50),
     VALMIN NUMBER(30,2),
     VALMAX NUMBER(30,2)
)  ;


-- CREATE TABLE ACTIONROLE
-- (	ID VARCHAR2(50) NOT NULL ENABLE,
--      NOMTABLEOBJET VARCHAR2(50),
--      ACTION VARCHAR2(50),
--      ROLEMINIMUM NUMBER(30,0),
--      DIRECTION VARCHAR2(50)
-- ) ;



CREATE TABLE RETRAIT_FRAIS_MEDICAUX
(	ID VARCHAR2(100) NOT NULL ENABLE,
     DATY DATE,
     IDPERSONNEL VARCHAR2(100),
     DESCRIPTION VARCHAR2(1000),
     MONTANT NUMBER(30,2),
     ETAT NUMBER(*,0),
     CONSTRAINT "RETRAIT_FRAIS_MEDICAUX_PK" PRIMARY KEY ("ID")
) ;




CREATE TABLE SOLDE_FRM_2023
(	ID VARCHAR2(100) NOT NULL ENABLE,
     IDPERSONNEL VARCHAR2(100),
     DATY DATE,
     MONTANT NUMBER(30,2),
     ETAT NUMBER(*,0),
     CONSTRAINT "RETRAIT_FRAIS_MEDICAUXSOLDE_PK" PRIMARY KEY ("ID")
) ;

/* =========================================================================================== */
/* MANOMBOKA ETO DIA VIEW SY SEQUENCE ======================================================== */
/* =========================================================================================== */
/* =========================================================================================== */
/* =========================================================================================== */
/* =========================================================================================== */
/* =========================================================================================== */


CREATE SEQUENCE seqformation_diplome
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;


CREATE OR REPLACE FUNCTION GETSEQFORMATIONDIPLOME
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seqformation_diplome.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE OR REPLACE FUNCTION GET_SEQFORMATION_DIPLOME
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seqformation_diplome.NEXTVAL into retour from dual;
RETURN retour;
END;


CREATE SEQUENCE seqpaie_groupefonction
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;

CREATE OR REPLACE FUNCTION GETSEQPAIE_GROUPEFONCTION
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seqpaie_groupefonction.NEXTVAL into retour from dual;
RETURN retour;
END;


CREATE SEQUENCE seq_logservice
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;

CREATE OR REPLACE FUNCTION GETSEQLOGSERVICE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_logservice.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


CREATE SEQUENCE seq_POINTAGE
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;

CREATE OR REPLACE FUNCTION GET_SEQ_POINTAGE
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seq_POINTAGE.NEXTVAL into retour from dual;
RETURN retour;
END;


CREATE SEQUENCE SEQ_MVTABSENCE
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;

CREATE OR REPLACE FUNCTION GET_SEQ_MVTABSENCE
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT SEQ_MVTABSENCE.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE SEQUENCE seq_typeabsence
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;

CREATE OR REPLACE FUNCTION GET_SEQ_TYPEABSENCE
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seq_typeabsence.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE OR REPLACE FUNCTION GET_SEQ_DEMANDE
RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seq_demande.NEXTVAL INTO retour FROM dual;
RETURN retour;
END;


CREATE SEQUENCE seqrubriquemanuel
    START WITH 1
    INCREMENT BY 1
    MAXVALUE 999999999999
    NOCYCLE
CACHE 20;

CREATE OR REPLACE FUNCTION GET_SEQRUBRIQUEMANUEL
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seqrubriquemanuel.NEXTVAL into retour from dual;
RETURN retour;
END;

-- DEPART ETO

CREATE OR REPLACE VIEW EMPLOYE_COMPLET  AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       logp.sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       logp.fokotany,
       logp.nationalite,
       logp.acte_naissance,
       paie.situation_matrimonial,
       paie.idconjoint,
       logp.direction,
       logp.service,
       paie.idfonction,
       paie.ctg,
       paie.idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       paie.mode_paiement,
       paie.code_agence_banque,
       paie.banque_numero_compte,
       paie.banque_compte_cle,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.etat,
       paie.vehiculee,
       tab.date_dernierpromo,
       paie.droit_hs,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       paie.nbenfant,
       paie.indesirable,
       paie.duree,
       paie.telephone,
       paie.mail,
       paie.idcategorie_paie,
       paie.idqualification,
       paie.discipline,
       paie.formation,
       paie.anneeexperience,
       paie.personnel_etat,
       paie.debutcontrat,
       paie.fincontrat,
       logp.refuser,
       logp.idhierarchie AS idetathierarchie,
       et.etatvisa,
       et.etatannule,
       paie.typecontrat,
       logp.cheminImage
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN categorie_paie cp ON cp.id = paie.idcategorie_paie
         LEFT JOIN qualification_paie qp ON qp.id = paie.idqualification
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = paie.idcategorie_paie AND cq.idqualification = paie.idqualification AND cq.REMARQUE = logp.id
         LEFT JOIN etathierarchie et ON et.id = logp.idhierarchie;


CREATE OR REPLACE VIEW PAIE_INFO_PERSONNEL_ENFANT (ID, MATRICULE, CTURGENCE_NOM_PRENOM, NBENFANT) AS
SELECT pip.id,
       pip.matricule,
       (((lp.nom || ' ') || lp.prenom)) AS cturgence_nom_prenom,
       pip.nbenfant
FROM paie_info_personnel pip
         JOIN log_personnel lp ON lp.id = pip.id;

CREATE OR REPLACE VIEW PAIE_FONCTIONLIBELLE (ID, VAL, DESCE, IDGROUPEFONCTION) AS
SELECT p.id,
       p.val,
       p.desce,
       pg.val AS idgroupefonction
FROM paie_fonction p
         LEFT JOIN paie_groupefonction pg ON p.idgroupefonction = pg.id;

CREATE OR REPLACE VIEW CATEGORIE_QUALIFICATION_LIBC (ID, IDCATEGORIE, IDQUALIFICATION, REMARQUE, ETAT, MONTANT, IDCATEGORIELIB, CATEGORIE_QUALIFICATIONLIB) AS
SELECT
    cq.id,
    cq.idcategorie,
    cq.idqualification,
    cq.remarque,
    cq.etat,
    cq.montant,
    cp.val AS idcategorielib,
    qp.val AS categorie_qualificationlib
FROM categorie_qualification cq
         JOIN qualification_paie qp ON TO_CHAR(qp.id) = TO_CHAR(cq.idqualification)
         JOIN categorie_paie cp ON TO_CHAR(cp.id) = TO_CHAR(cq.idcategorie);

CREATE OR REPLACE VIEW PAIE_PERS_ELTPAIE_LIB2 (ID, MATRICULE, CODE_RUBRIQUE, DATE_DEBUT, DATE_FIN, GAIN, RETENUE, REMARQUE, IDPERSONNEL, ETAT, ID_OBJET, IDUSER, MOISREGULARISATION, ANNEEREGULARISATION, IDCATEGORIE_QUALIFICATION, IDFONCTION, POURCENTAGE) AS
SELECT
    ppe.id,
    pip2.matricule,
    pr.val AS code_rubrique,
    ppe.date_debut,
    ppe.date_fin,
    ppe.gain,
    ppe.retenue,
    ppe.remarque,
    pip.nom || ' ' || pip.prenom AS idpersonnel,
    ppe.etat,
    ppe.id_objet,
    ppe.iduser,
    ppe.moisregularisation,
    ppe.anneeregularisation,
    cq.idcategorielib || ' ' || cq.categorie_qualificationlib AS idcategorie_qualification,
    pf.desce AS idfonction,
    ppe.pourcentage
FROM paie_personnel_elementpaie ppe
         LEFT JOIN log_personnel pip ON TO_CHAR(pip.id) = TO_CHAR(ppe.idpersonnel)
         LEFT JOIN categorie_qualification_libc cq ON TO_CHAR(ppe.idcategorie_qualification) = TO_CHAR(cq.id)
         LEFT JOIN paie_fonction pf ON TO_CHAR(ppe.idfonction) = TO_CHAR(pf.id)
         LEFT JOIN paie_rubrique pr ON TO_CHAR(pr.id) = TO_CHAR(ppe.code_rubrique)
         JOIN paie_info_personnel pip2 ON TO_CHAR(pip.id) = TO_CHAR(pip2.id);


CREATE OR REPLACE VIEW CATEG_QUALI_LIBCOMPLET (ID, IDCATEGORIE, IDQUALIFICATION, REMARQUE, ETAT, MONTANT, IDCATEGORIELIB, CATEGORIE_QUALIFICATIONLIB) AS
SELECT cq.id,
       cq.idcategorie,
       cq.idqualification,
       cq.remarque,
       cq.etat,
       cq.montant,
       cp.val AS idcategorielib,
       qp.val AS categorie_qualificationlib
FROM categorie_qualification cq
         JOIN qualification_paie qp ON qp.id = cq.idqualification
         JOIN categorie_paie cp ON cq.idcategorie = cp.id;


CREATE OR REPLACE VIEW PAIE_PERSONNEL_ELEMENTPAIE_LIB (ID, CODE_RUBRIQUE, DATE_DEBUT, DATE_FIN, GAIN, RETENUE, REMARQUE, IDPERSONNEL, ETAT, ID_OBJET, IDUSER, MOISREGULARISATION, ANNEEREGULARISATION, IDCATEGORIE_QUALIFICATION, IDFONCTION, POURCENTAGE) AS
SELECT ppe.id,
       pr.val AS code_rubrique,
       ppe.date_debut,
       ppe.date_fin,
       ppe.gain,
       ppe.retenue,
       ppe.remarque,
       (pip.nom || ' ') || pip.prenom AS idpersonnel,
       ppe.etat,
       ppe.id_objet,
       ppe.iduser,
       ppe.moisregularisation,
       ppe.anneeregularisation,
       (cq.idcategorielib || ' ') || cq.categorie_qualificationlib AS idcategorie_qualification,
       pf.val AS idfonction,
       ppe.pourcentage
FROM paie_personnel_elementpaie ppe
         LEFT JOIN log_personnel pip ON pip.id = ppe.idpersonnel
         LEFT JOIN categ_quali_libcomplet cq ON ppe.idcategorie_qualification = cq.id
         LEFT JOIN paie_fonction pf ON ppe.idfonction = pf.id
         LEFT JOIN paie_rubrique pr ON pr.id = ppe.code_rubrique;

CREATE OR REPLACE VIEW SOLDECONGE_FIN_2023 (IDPERSONNEL, ID, MATRICULE, CONGE) AS
SELECT pip.id AS idpersonnel,
       cf.id,
       cf.matricule,
       cf.conge
FROM conge_fin_2023 cf
         LEFT JOIN paie_info_personnel pip ON pip.matricule = cf.matricule;

CREATE OR REPLACE  VIEW DROITDECONGE_PARPERS (IDPERSONNEL, CONGE) AS
SELECT cd.idpersonnel AS idpersonnel,
       sum(cd.conge) AS conge
FROM soldeconge_fin_2023 cd
GROUP BY cd.idpersonnel;

CREATE OR REPLACE  VIEW JOURS_PAR_MOIS (ANNEE, MOIS, NB_JOUR, CONGE_JOURNALIER) AS
SELECT
    EXTRACT(YEAR FROM ADD_MONTHS(DATE '2019-01-01', LEVEL - 1)) AS annee,
    EXTRACT(MONTH FROM ADD_MONTHS(DATE '2019-01-01', LEVEL - 1)) AS mois,
    TO_NUMBER(TO_CHAR(LAST_DAY(ADD_MONTHS(DATE '2019-01-01', LEVEL - 1)), 'DD')) AS nb_jour,
    ROUND(2.5 / TO_NUMBER(TO_CHAR(LAST_DAY(ADD_MONTHS(DATE '2019-01-01', LEVEL - 1)), 'DD')), 6) AS conge_journalier
FROM dual
    CONNECT BY ADD_MONTHS(DATE '2019-01-01', LEVEL - 1) < SYSDATE;

CREATE OR REPLACE  VIEW PAIE_INFO_JOURS_MOIS (ID, DATEEMBAUCHE, DATE_DEPART, ANNEE, MOIS, NB_JOUR, CONGE_JOURNALIER, JOURPLUSDEPART, JOURPLUSEMBAUCHE) AS
SELECT
    pip.id,
    pip.dateembauche,
    pip.date_depart,
    j.annee,
    j.mois,
    j.nb_jour,
    j.conge_journalier,
    0 AS jourplusdepart,
    CASE
        WHEN j.annee = EXTRACT(YEAR FROM pip.dateembauche)
            AND j.mois = EXTRACT(MONTH FROM pip.dateembauche)
            THEN EXTRACT(DAY FROM pip.dateembauche)
        ELSE 0
        END AS jourplusembauche
FROM
    paie_info_personnel pip,
    jours_par_mois j
WHERE
    TO_DATE(j.annee || LPAD(j.mois, 2, '0'), 'YYYYMM') >=
    TO_DATE(TO_CHAR(pip.dateembauche, 'YYYYMM'), 'YYYYMM')
  AND pip.date_depart IS NULL

UNION

SELECT
    pip.id,
    pip.dateembauche,
    pip.date_depart,
    j.annee,
    j.mois,
    j.nb_jour,
    j.conge_journalier,
    CASE
        WHEN j.annee = EXTRACT(YEAR FROM pip.date_depart)
            AND j.mois = EXTRACT(MONTH FROM pip.date_depart)
            THEN EXTRACT(DAY FROM pip.date_depart)
        ELSE 0
        END AS jourplusdepart,
    CASE
        WHEN j.annee = EXTRACT(YEAR FROM pip.dateembauche)
            AND j.mois = EXTRACT(MONTH FROM pip.dateembauche)
            THEN EXTRACT(DAY FROM pip.dateembauche)
        ELSE 0
        END AS jourplusembauche
FROM
    paie_info_personnel pip,
    jours_par_mois j
WHERE
    TO_DATE(j.annee || LPAD(j.mois, 2, '0'), 'YYYYMM') >=
    TO_DATE(TO_CHAR(pip.dateembauche,'YYYYMM'), 'YYYYMM')
  AND pip.date_depart IS NOT NULL
  AND TO_DATE(j.annee || LPAD(j.mois, 2, '0'), 'YYYYMM') <=
      TO_DATE(TO_CHAR(pip.date_depart, 'YYYYMM'), 'YYYYMM');

CREATE OR REPLACE  VIEW PAIE_INFO_JOURS_MOIS2 (ID, DATEEMBAUCHE, DATE_DEPART, ANNEE, MOIS, NB_JOUR, CONGE_JOURNALIER, JOURPLUSDEPART, JOURPLUSEMBAUCHE, NBJOURSVRAI) AS
SELECT p.id,
       p.dateembauche,
       p.date_depart,
       p.annee,
       p.mois,
       p.nb_jour,
       p.conge_journalier,
       p.jourplusdepart,
       p.jourplusembauche,
       CASE
           WHEN p.jourplusdepart > 0 AND p.jourplusembauche = 0 THEN p.jourplusdepart
           WHEN p.jourplusdepart = 0 AND p.jourplusembauche > 0 THEN p.nb_jour - p.jourplusembauche + 1
           WHEN p.jourplusdepart > 0 AND p.jourplusembauche > 0 THEN p.jourplusdepart - p.jourplusembauche
           WHEN p.annee = EXTRACT(YEAR FROM sysdate ) AND p.mois = EXTRACT(MONTH  FROM sysdate ) THEN EXTRACT(DAY FROM sysdate )
           ELSE p.nb_jour
           END AS nbjoursvrai
FROM paie_info_jours_mois p;

CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS2_BIS (ID, DATEEMBAUCHE, DATE_DEPART, ANNEE, MOIS, NB_JOUR, CONGE_JOURNALIER, JOURPLUSDEPART, JOURPLUSEMBAUCHE, NBJOURSVRAI) AS
SELECT pijm.id,
       pijm.dateembauche,
       pijm.date_depart,
       pijm.annee,
       pijm.mois,
       pijm.nb_jour,
       pijm.conge_journalier,
       pijm.jourplusdepart,
       pijm.jourplusembauche,
       pijm.nbjoursvrai
FROM paie_info_jours_mois2 pijm
WHERE pijm.dateembauche <= TO_DATE('2024-01-01', 'YYYY-MM-DD')
  AND pijm.annee >= 2024;

CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS3_BIS (ID, JOURCONGE) AS
SELECT paie_info_jours_mois2_bis.id,
       round(sum(paie_info_jours_mois2_bis.nbjoursvrai * paie_info_jours_mois2_bis.conge_journalier), 1) AS jourconge
FROM paie_info_jours_mois2_bis
GROUP BY paie_info_jours_mois2_bis.id;

CREATE OR REPLACE VIEW DROITDECONGE_PARPERSONNE (IDPERSONNEL, CONGE) AS
SELECT dp.idpersonnel,
       round((dp.conge + pij.jourconge) * 2) / 2 - 1.5 AS conge
FROM droitdeconge_parpers dp
         LEFT JOIN paie_info_jours_mois3_bis pij ON dp.idpersonnel = pij.id;

CREATE OR REPLACE  VIEW CONGEPRIS (ID, IDPERSONNEL, IDTYPEDEMANDE, TITRE, HORAIRENORMAL, HEUREDEPART, HEUREARRIVE, IDTYPEABSENCE, MOTIF, NUMERO, DESCE, ETAT, DATY, DUREE, DATEDEPART, DATERETOUR, OBSERVATION, REMARQUE, IDREMPLACENTS, RESTE_CONGE, DATEFIN) AS
SELECT demande.id,
       demande.idpersonnel,
       demande.idtypedemande,
       demande.titre,
       demande.horairenormal,
       demande.heuredepart,
       demande.heurearrive,
       demande.idtypeabsence,
       demande.motif,
       demande.numero,
       demande.desce,
       demande.etat,
       demande.daty,
       demande.duree,
       demande.datedepart,
       demande.dateretour,
       demande.observation,
       demande.remarque,
       demande.idremplacents,
       demande.reste_conge,
       demande.datefin
FROM demande
WHERE demande.etat = 11 AND demande.idtypeabsence = 'TYP000004';

CREATE OR REPLACE  VIEW CONGEPRISGROUPBYPERS (IDPERSONNEL, CONGE) AS
SELECT congepris.idpersonnel,
       sum(congepris.duree) AS conge
FROM congepris
GROUP BY congepris.idpersonnel;

CREATE OR REPLACE VIEW LOG_PERSONNEL_FIN (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, CODE_DR, MATRICULE, IDCATEGORIE, CTG, INDICEGRADE, INDICE_FONCTIONNEL, STATUT, CATEGORIEVAL, CTGVAL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, DROIT, PRIE, RESTECONGE, ETAT, IDPERSONNEL, IDDIRECTION) AS
SELECT l.id,
       l.permis_conduire,
       l.chemin_permis,
       l.remarque,
       l.id_pers,
       l.nom,
       l.prenom,
       l.date_naissance,
       sex.desce AS sexe,
       l.numero_cin,
       l.date_cin,
       l.date_dupl_cin,
       l.nationalite,
       l.adresse,
       l.fokotany,
       l.acte_naissance,
       d.val AS direction,
       s.code_service AS service,
       s.code_dr,
       TO_CHAR(paie.matricule) AS matricule,
       paie.idcategorie,
       paie.ctg,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.statut,
       c.taux AS categorieval,
       ' ' AS ctgval,
       paie.numero_cnaps,
       paie.numero_ostie,
       CASE
           WHEN paie.temporaire = -1 THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire,
       NVL(dr.conge, 0) AS droit,
       NVL(cg.conge, 0) AS prie,
       NVL(dr.conge, 0) - NVL(cg.conge, 0) AS resteconge,
       paie.etat,
       l.id AS idpersonnel,
       l.direction AS iddirection
FROM log_personnel l
         LEFT JOIN log_service s ON l.service = s.id
         LEFT JOIN paie_info_personnel paie ON paie.id = l.id
         LEFT JOIN sexe sex ON l.sexe = sex.id
         LEFT JOIN log_direction d ON d.id = l.direction
         LEFT JOIN paie_categorie c ON c.id = paie.idcategorie
         LEFT JOIN droitdeconge_parpersonne dr ON dr.idpersonnel = l.id
         LEFT JOIN congeprisgroupbypers cg ON cg.idpersonnel = l.id;

CREATE OR REPLACE  VIEW LOG_PERSONNEL_V (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, CODE_DR, MATRICULE, IDCATEGORIE, CTG, INDICEGRADE, INDICE_FONCTIONNEL, STATUT, CATEGORIEVAL, CTGVAL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, RESTECONGE, IDDIRECTION) AS
SELECT log_personnel_fin.id,
       log_personnel_fin.permis_conduire,
       log_personnel_fin.chemin_permis,
       log_personnel_fin.remarque,
       log_personnel_fin.id_pers,
       log_personnel_fin.nom,
       log_personnel_fin.prenom,
       log_personnel_fin.date_naissance,
       log_personnel_fin.sexe,
       log_personnel_fin.numero_cin,
       log_personnel_fin.date_cin,
       log_personnel_fin.date_dupl_cin,
       log_personnel_fin.nationalite,
       log_personnel_fin.adresse,
       log_personnel_fin.fokotany,
       log_personnel_fin.acte_naissance,
       log_personnel_fin.direction,
       log_personnel_fin.service,
       log_personnel_fin.code_dr,
       log_personnel_fin.matricule,
       log_personnel_fin.idcategorie,
       log_personnel_fin.ctg,
       log_personnel_fin.indicegrade,
       log_personnel_fin.indice_fonctionnel,
       log_personnel_fin.statut,
       log_personnel_fin.categorieval,
       log_personnel_fin.ctgval,
       log_personnel_fin.numero_cnaps,
       log_personnel_fin.numero_ostie,
       log_personnel_fin.temporaire,
       log_personnel_fin.resteconge,
       log_personnel_fin.idDIRECTION
FROM log_personnel_fin
WHERE NOT (log_personnel_fin.id IN ( SELECT log_personnel_non_valide.idlogpers
                                     FROM log_personnel_non_valide
                                     WHERE log_personnel_non_valide.etat >= 11));

CREATE OR REPLACE VIEW CATEGORIE_PAIE_LIB (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE) AS
SELECT cp.id,
       cp.val,
       cp.desce,
       cp.montant,
       cp.remarque,
       CASE
           WHEN cp.droit_heure_sup = 'o' THEN 'OUI'
           WHEN cp.droit_heure_sup = 'n' THEN 'NON'
           ELSE NULL
           END AS droit_heure_sup,
       cp.essaie
FROM categorie_paie cp;

CREATE OR REPLACE VIEW LOG_PERSONNEL_V2 (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, CODE_DR, MATRICULE, IDCATEGORIE, CTG, INDICEGRADE, INDICE_FONCTIONNEL, STATUT, CATEGORIEVAL, CTGVAL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, RESTECONGE, CATEGORIE, QUALIFICATION, IDDIRECTION) AS
SELECT lpv.id,
       lpv.permis_conduire,
       lpv.chemin_permis,
       lpv.remarque,
       lpv.id_pers,
       lpv.nom,
       lpv.prenom,
       lpv.date_naissance,
       lpv.sexe,
       lpv.numero_cin,
       lpv.date_cin,
       lpv.date_dupl_cin,
       lpv.nationalite,
       lpv.adresse,
       lpv.fokotany,
       lpv.acte_naissance,
       lpv.direction,
       lpv.service,
       lpv.code_dr,
       lpv.matricule,
       lpv.idcategorie,
       lpv.ctg,
       lpv.indicegrade,
       lpv.indice_fonctionnel,
       lpv.statut,
       lpv.categorieval,
       lpv.ctgval,
       lpv.numero_cnaps,
       lpv.numero_ostie,
       lpv.temporaire,
       lpv.resteconge,
       cpl.val AS categorie,
       qp.val AS qualification,
       lpv.idDIRECTION
FROM log_personnel_v lpv
         LEFT JOIN paie_info_personnel pinfo ON pinfo.id = lpv.id
         LEFT JOIN categorie_paie_lib cpl ON cpl.id = pinfo.idcategorie_paie
         LEFT JOIN qualification_paie qp ON qp.id = pinfo.idqualification;


CREATE OR REPLACE  VIEW VUE_ID_MATRICULE (ID, PRENOM, NOM, MATRICULE, DIRECTION, IDDIRECTION, ETAT) AS
SELECT lp.id,
       lp.prenom,
       lp.nom,
       pip.matricule,
       ld.VAL AS direction,
       ld.ID AS iddirection,
       pip.ETAT
FROM paie_info_personnel pip
         JOIN log_personnel lp ON pip.id = lp.id
         LEFT JOIN LOG_DIRECTION ld ON ld.ID = lp.direction;

CREATE OR REPLACE VIEW CATEG_QUALILIBCOMPLET (ID, IDCATEGORIE, IDQUALIFICATION, REMARQUE, ETAT, MONTANT, ETATLIBELLE, ETATVAL, MATRICULE, DATE_DEBUT, DATE_FIN, NOMCPL, PRENOM) AS
SELECT cq.id,
       cp.val AS idcategorie,
       qp.val AS idqualification,
       cq.remarque,
       cq.etat,
       cq.montant,
       CASE
           WHEN cq.etat = 1 THEN 'actif'
           ELSE 'inactif'
           END AS etatlibelle,
       ecq.desce AS etatval,
       vim.matricule,
       cq.date_debut,
       cq.date_fin,
       vim.NOM || vim.PRENOM AS nomCpl,
       vim.PRENOM
FROM categorie_qualification cq
         JOIN categorie_paie cp ON cp.id = cq.idcategorie
         JOIN qualification_paie qp ON qp.id = cq.idqualification
         JOIN etat_categ_qualif2 ecq ON ecq.id = cq.etat
         LEFT JOIN vue_id_matricule vim ON vim.id = cq.remarque;


CREATE OR REPLACE VIEW CATEG_QUALI_CONTRAT (ID, IDCATEGORIE, IDQUALIFICATION, REMARQUE, ETAT, MONTANT, DATE_DEBUT, DATE_FIN, AVENANT) AS
SELECT cq.id,
       cq.idcategorie,
       cq.idqualification,
       cq.remarque,
       cq.etat,
       cq.montant,
       cq.date_debut,
       cq.date_fin,
       cq.avenant
FROM categorie_qualification cq
WHERE cq.avenant >=0 AND cq.remarque IS NOT NULL;

CREATE OR REPLACE VIEW CATEG_QUALI_CONTRAT_2 (ID, IDCATEGORIE, IDQUALIFICATION, REMARQUE, ETAT, MONTANT, DATE_DEBUT, DATE_FIN, DATEFIN, AVENANT, NUMERO) AS
SELECT
    cq.id,
    cq.idcategorie,
    cq.idqualification,
    cq.remarque,
    cq.etat,
    cq.montant,
    cq.date_debut,
    cq.date_fin,

    -- Utilisation de LEAD pour datefin
    NVL(
            LEAD(cq.date_debut) OVER (PARTITION BY cq.remarque ORDER BY cq.date_debut) - 1,
            cq.date_fin
    ) AS datefin,

    -- Generation de l''avenant
    CASE
        WHEN ROW_NUMBER() OVER (PARTITION BY cq.remarque ORDER BY cq.date_debut) = 1 THEN 'initial'
        ELSE 'Avenant N?' || (ROW_NUMBER() OVER (PARTITION BY cq.remarque ORDER BY cq.date_debut) - 1)
        END AS avenant,

    -- Numero de l''avenant
    CASE
        WHEN ROW_NUMBER() OVER (PARTITION BY cq.remarque ORDER BY cq.date_debut) = 1 THEN '0'
        ELSE TO_CHAR(ROW_NUMBER() OVER (PARTITION BY cq.remarque ORDER BY cq.date_debut) - 1)
        END AS numero

FROM categ_quali_contrat cq;


CREATE OR REPLACE VIEW PAIE_INFO_PERSONNEL_LIBCOMPLET (ID, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, VEHICULEE, ECHELON, ETAT, CTG, IDUSER, INDICE_CT, DATEPROMOTION, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, N_EMBAUCHE, DATE_DEPART, N_DEPART, NBENFANT, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, INDESIRABLE, DUREE, TELEPHONE, MAIL, ADRESSE_LIGNE1, ADRESSE_LIGNE2, CODE_POSTAL, REGION, IDCATEGORIE_PAIE, IDQUALIFICATION, FORMATION, DISCIPLINE, ANNEEEXPERIENCE, PERSONNEL_ETAT, PERIODE_ESSAI, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, DEBUTCONTRAT, FINCONTRAT) AS
SELECT p.id,
       p.datesaisie,
       p.matricule,
       p.lieu_naissance_commune,
       p.lieu_delivrance_cin,
       p.situation_matrimonial,
       p.initiale,
       (l.nom || ' ') || l.prenom AS cturgence_nom_prenom,
       p.cturgence_telephone1,
       p.cturgence_telephone2,
       p.cturgence_telephone3,
       p.idconjoint,
       p.code_agence_banque,
       p.banque_numero_compte,
       p.banque_compte_cle,
       p.dateembauche,
       p.idfonction,
       p.idcategorie,
       p.mode_paiement,
       p.classee,
       p.indicegrade,
       p.indice_fonctionnel,
       p.matricule_patron,
       p.statut,
       p.droit_hs,
       p.vehiculee,
       p.echelon,
       p.etat,
       p.ctg,
       p.iduser,
       p.indice_ct,
       p.datepromotion,
       p.numero_cnaps,
       p.numero_ostie,
       p.temporaire,
       p.n_embauche,
       p.date_depart,
       p.n_depart,
       p.nbenfant,
       p.heurejournalier,
       p.heurehebdomadaire,
       p.heuremensuel,
       p.indesirable,
       p.duree,
       p.telephone,
       p.mail,
       p.adresse_ligne1,
       p.adresse_ligne2,
       p.code_postal,
       p.region,
       p.idcategorie_paie,
       p.idqualification,
       p.formation,
       p.discipline,
       p.anneeexperience,
       p.personnel_etat,
       p.periode_essai,
       l.permis_conduire,
       l.chemin_permis,
       l.remarque,
       l.id_pers,
       l.nom,
       l.prenom,
       l.date_naissance,
       l.sexe,
       l.numero_cin,
       l.date_cin,
       l.date_dupl_cin,
       l.nationalite,
       l.adresse,
       l.fokotany,
       l.acte_naissance,
       l.direction,
       l.service,
       p.debutcontrat,
       p.fincontrat
FROM paie_info_personnel p
         LEFT JOIN log_personnel l ON l.id = p.id;

CREATE OR REPLACE  VIEW PAIE_INFO_PERSONNEL_HISTORIC_3 (ID, IDPERSONNEL, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, VEHICULEE, ECHELON, ETAT, CTG, IDUSER, INDICE_CT, DATEPROMOTION, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, N_EMBAUCHE, DATE_DEPART, N_DEPART, NBENFANT, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, INDESIRABLE, DUREE, TELEPHONE, MAIL, ADRESSE_LIGNE1, ADRESSE_LIGNE2, CODE_POSTAL, REGION, IDCATEGORIE_PAIE, IDQUALIFICATION, FORMATION, DISCIPLINE, ANNEEEXPERIENCE, PERSONNEL_ETAT, PERIODE_ESSAI, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, SEXEPDF, PRONOMPERSONNELSUJET, GENREPDF, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, MONTANT, CATEGORIE_QUALIFICATIONLIB, CATEGORIE_PAIELIB, DATE_DEBUT, DATE_FIN, AVENANT, FONCTIONLIB, DEBUTCONTRAT, FINCONTRAT, NUMERO) AS
SELECT
    pip.matricule || cq.numero AS id,
    pip.id AS idpersonnel,
    pip.datesaisie,
    pip.matricule,
    pip.lieu_naissance_commune,
    pip.lieu_delivrance_cin,
    pip.situation_matrimonial,
    pip.initiale,
    pip.cturgence_nom_prenom,
    pip.cturgence_telephone1,
    pip.cturgence_telephone2,
    pip.cturgence_telephone3,
    pip.idconjoint,
    pip.code_agence_banque,
    pip.banque_numero_compte,
    pip.banque_compte_cle,
    pip.dateembauche,
    pip.idfonction,
    pip.idcategorie,
    pip.mode_paiement,
    pip.classee,
    pip.indicegrade,
    pip.indice_fonctionnel,
    pip.matricule_patron,
    pip.statut,
    pip.droit_hs,
    pip.vehiculee,
    pip.echelon,
    pip.etat,
    pip.ctg,
    pip.iduser,
    pip.indice_ct,
    pip.datepromotion,
    pip.numero_cnaps,
    pip.numero_ostie,
    pip.temporaire,
    pip.n_embauche,
    pip.date_depart,
    pip.n_depart,
    pip.nbenfant,
    pip.heurejournalier,
    pip.heurehebdomadaire,
    pip.heuremensuel,
    pip.indesirable,
    pip.duree,
    pip.telephone,
    pip.mail,
    pip.adresse_ligne1,
    pip.adresse_ligne2,
    pip.code_postal,
    pip.region,
    pip.idcategorie_paie,
    pip.idqualification,
    pip.formation,
    pip.discipline,
    pip.anneeexperience,
    pip.personnel_etat,
    pip.periode_essai,
    pip.permis_conduire,
    pip.chemin_permis,
    pip.remarque,
    pip.id_pers,
    pip.nom,
    pip.prenom,
    pip.date_naissance,
    pip.sexe,
    CASE
        WHEN pip.sexe = '0' THEN 'Madame'
        ELSE 'Monsieur'
        END AS sexepdf,
    CASE
        WHEN pip.sexe = '0' THEN 'elle'
        ELSE 'il'
        END AS pronompersonnelsujet,
    CASE
        WHEN pip.sexe = '0' THEN 'Elle'
        ELSE 'Il'
        END AS genrepdf,
    pip.numero_cin,
    pip.date_cin,
    pip.date_dupl_cin,
    pip.nationalite,
    pip.adresse,
    pip.fokotany,
    pip.acte_naissance,
    pip.direction,
    pip.service,
    cq.montant,
    qp.val AS categorie_qualificationlib,
    cp.val AS categorie_paielib,
    cq.date_debut,
    cq.date_fin,
    cq.avenant,
    pf.desce AS fonctionlib,
    pip.debutcontrat,
    pip.fincontrat,
    cq.numero
FROM
    categ_quali_contrat_2 cq
        LEFT JOIN paie_info_personnel_libcomplet pip ON pip.id = cq.remarque
        LEFT JOIN categorie_paie cp ON cp.id = pip.idcategorie_paie
        LEFT JOIN qualification_paie qp ON qp.id = pip.idqualification
        LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction;

create or replace view PAIE_INFO_PERS_HISTO_CONTRAT as
SELECT paie_info_personnel_historic_3.id,
       paie_info_personnel_historic_3.idpersonnel,
       paie_info_personnel_historic_3.datesaisie,
       paie_info_personnel_historic_3.matricule,
       paie_info_personnel_historic_3.lieu_naissance_commune,
       paie_info_personnel_historic_3.lieu_delivrance_cin,
       paie_info_personnel_historic_3.situation_matrimonial,
       paie_info_personnel_historic_3.initiale,
       paie_info_personnel_historic_3.cturgence_nom_prenom,
       paie_info_personnel_historic_3.cturgence_telephone1,
       paie_info_personnel_historic_3.cturgence_telephone2,
       paie_info_personnel_historic_3.cturgence_telephone3,
       paie_info_personnel_historic_3.idconjoint,
       paie_info_personnel_historic_3.code_agence_banque,
       paie_info_personnel_historic_3.banque_numero_compte,
       paie_info_personnel_historic_3.banque_compte_cle,
       paie_info_personnel_historic_3.dateembauche,
       paie_info_personnel_historic_3.idfonction,
       paie_info_personnel_historic_3.idcategorie,
       paie_info_personnel_historic_3.mode_paiement,
       paie_info_personnel_historic_3.classee,
       paie_info_personnel_historic_3.indicegrade,
       paie_info_personnel_historic_3.indice_fonctionnel,
       paie_info_personnel_historic_3.matricule_patron,
       paie_info_personnel_historic_3.statut,
       paie_info_personnel_historic_3.droit_hs,
       paie_info_personnel_historic_3.vehiculee,
       paie_info_personnel_historic_3.echelon,
       paie_info_personnel_historic_3.etat,
       paie_info_personnel_historic_3.ctg,
       paie_info_personnel_historic_3.iduser,
       paie_info_personnel_historic_3.indice_ct,
       paie_info_personnel_historic_3.datepromotion,
       paie_info_personnel_historic_3.numero_cnaps,
       paie_info_personnel_historic_3.numero_ostie,
       paie_info_personnel_historic_3.temporaire,
       paie_info_personnel_historic_3.n_embauche,
       paie_info_personnel_historic_3.date_depart,
       paie_info_personnel_historic_3.n_depart,
       paie_info_personnel_historic_3.nbenfant,
       paie_info_personnel_historic_3.heurejournalier,
       paie_info_personnel_historic_3.heurehebdomadaire,
       paie_info_personnel_historic_3.heuremensuel,
       paie_info_personnel_historic_3.indesirable,
       paie_info_personnel_historic_3.duree,
       paie_info_personnel_historic_3.telephone,
       paie_info_personnel_historic_3.mail,
       paie_info_personnel_historic_3.adresse_ligne1,
       paie_info_personnel_historic_3.adresse_ligne2,
       paie_info_personnel_historic_3.code_postal,
       paie_info_personnel_historic_3.region,
       paie_info_personnel_historic_3.idcategorie_paie,
       paie_info_personnel_historic_3.idqualification,
       paie_info_personnel_historic_3.formation,
       paie_info_personnel_historic_3.discipline,
       paie_info_personnel_historic_3.anneeexperience,
       paie_info_personnel_historic_3.personnel_etat,
       paie_info_personnel_historic_3.periode_essai,
       paie_info_personnel_historic_3.permis_conduire,
       paie_info_personnel_historic_3.chemin_permis,
       paie_info_personnel_historic_3.remarque,
       paie_info_personnel_historic_3.id_pers,
       paie_info_personnel_historic_3.nom,
       paie_info_personnel_historic_3.prenom,
       paie_info_personnel_historic_3.date_naissance,
       paie_info_personnel_historic_3.sexe,
       paie_info_personnel_historic_3.sexepdf,
       paie_info_personnel_historic_3.pronompersonnelsujet,
       paie_info_personnel_historic_3.genrepdf,
       paie_info_personnel_historic_3.numero_cin,
       paie_info_personnel_historic_3.date_cin,
       paie_info_personnel_historic_3.date_dupl_cin,
       paie_info_personnel_historic_3.nationalite,
       paie_info_personnel_historic_3.adresse,
       paie_info_personnel_historic_3.fokotany,
       paie_info_personnel_historic_3.acte_naissance,
       paie_info_personnel_historic_3.direction,
       paie_info_personnel_historic_3.service,
       paie_info_personnel_historic_3.montant,
       paie_info_personnel_historic_3.categorie_qualificationlib,
       paie_info_personnel_historic_3.categorie_paielib,
       paie_info_personnel_historic_3.debutcontrat AS date_debut,
       paie_info_personnel_historic_3.date_fin,
       paie_info_personnel_historic_3.avenant,
       paie_info_personnel_historic_3.fonctionlib,
       paie_info_personnel_historic_3.debutcontrat,
       paie_info_personnel_historic_3.fincontrat,
       paie_info_personnel_historic_3.numero,
       paie_info_personnel_historic_3.id           AS idcontrat_avant
FROM paie_info_personnel_historic_3
WHERE paie_info_personnel_historic_3.avenant = 'initial';


INSERT INTO ETAT_CATEG_QUALIF2 (ID, VAL, DESCE) VALUES ('1', 'actif', 'ac1');
INSERT INTO ETAT_CATEG_QUALIF2 (ID, VAL, DESCE) VALUES ('-1', 'inactif', 'in1');

CREATE OR REPLACE VIEW LOG_SERVICE_LIB (ID, CODE_DR, DR_RATTACHE, LIBELLE, CODE_SERVICE, LIBELLEDIRECTION) AS
SELECT
    ls.ID ,
    ls.CODE_DR ,
    ls.DR_RATTACHE ,
    ls.LIBELLE ,
    ls.CODE_SERVICE ,
    ld.val AS libelleDirection

FROM LOG_SERVICE ls
         LEFT JOIN LOG_DIRECTION ld ON ld.id = ls.DR_RATTACHE ;


create or replace view PAIE_INFO_PERSL_HISTO_AVENANT as
SELECT paie_info_personnel_historic_3.id,
       paie_info_personnel_historic_3.idpersonnel,
       paie_info_personnel_historic_3.datesaisie,
       paie_info_personnel_historic_3.matricule,
       paie_info_personnel_historic_3.lieu_naissance_commune,
       paie_info_personnel_historic_3.lieu_delivrance_cin,
       paie_info_personnel_historic_3.situation_matrimonial,
       paie_info_personnel_historic_3.initiale,
       paie_info_personnel_historic_3.cturgence_nom_prenom,
       paie_info_personnel_historic_3.cturgence_telephone1,
       paie_info_personnel_historic_3.cturgence_telephone2,
       paie_info_personnel_historic_3.cturgence_telephone3,
       paie_info_personnel_historic_3.idconjoint,
       paie_info_personnel_historic_3.code_agence_banque,
       paie_info_personnel_historic_3.banque_numero_compte,
       paie_info_personnel_historic_3.banque_compte_cle,
       paie_info_personnel_historic_3.dateembauche,
       paie_info_personnel_historic_3.idfonction,
       paie_info_personnel_historic_3.idcategorie,
       paie_info_personnel_historic_3.mode_paiement,
       paie_info_personnel_historic_3.classee,
       paie_info_personnel_historic_3.indicegrade,
       paie_info_personnel_historic_3.indice_fonctionnel,
       paie_info_personnel_historic_3.matricule_patron,
       paie_info_personnel_historic_3.statut,
       paie_info_personnel_historic_3.droit_hs,
       paie_info_personnel_historic_3.vehiculee,
       paie_info_personnel_historic_3.echelon,
       paie_info_personnel_historic_3.etat,
       paie_info_personnel_historic_3.ctg,
       paie_info_personnel_historic_3.iduser,
       paie_info_personnel_historic_3.indice_ct,
       paie_info_personnel_historic_3.datepromotion,
       paie_info_personnel_historic_3.numero_cnaps,
       paie_info_personnel_historic_3.numero_ostie,
       paie_info_personnel_historic_3.temporaire,
       paie_info_personnel_historic_3.n_embauche,
       paie_info_personnel_historic_3.date_depart,
       paie_info_personnel_historic_3.n_depart,
       paie_info_personnel_historic_3.nbenfant,
       paie_info_personnel_historic_3.heurejournalier,
       paie_info_personnel_historic_3.heurehebdomadaire,
       paie_info_personnel_historic_3.heuremensuel,
       paie_info_personnel_historic_3.indesirable,
       paie_info_personnel_historic_3.duree,
       paie_info_personnel_historic_3.telephone,
       paie_info_personnel_historic_3.mail,
       paie_info_personnel_historic_3.adresse_ligne1,
       paie_info_personnel_historic_3.adresse_ligne2,
       paie_info_personnel_historic_3.code_postal,
       paie_info_personnel_historic_3.region,
       paie_info_personnel_historic_3.idcategorie_paie,
       paie_info_personnel_historic_3.idqualification,
       paie_info_personnel_historic_3.formation,
       paie_info_personnel_historic_3.discipline,
       paie_info_personnel_historic_3.anneeexperience,
       paie_info_personnel_historic_3.personnel_etat,
       paie_info_personnel_historic_3.periode_essai,
       paie_info_personnel_historic_3.permis_conduire,
       paie_info_personnel_historic_3.chemin_permis,
       paie_info_personnel_historic_3.remarque,
       paie_info_personnel_historic_3.id_pers,
       paie_info_personnel_historic_3.nom,
       paie_info_personnel_historic_3.prenom,
       paie_info_personnel_historic_3.date_naissance,
       paie_info_personnel_historic_3.sexe,
       paie_info_personnel_historic_3.sexepdf,
       paie_info_personnel_historic_3.pronompersonnelsujet,
       paie_info_personnel_historic_3.genrepdf,
       paie_info_personnel_historic_3.numero_cin,
       paie_info_personnel_historic_3.date_cin,
       paie_info_personnel_historic_3.date_dupl_cin,
       paie_info_personnel_historic_3.nationalite,
       paie_info_personnel_historic_3.adresse,
       paie_info_personnel_historic_3.fokotany,
       paie_info_personnel_historic_3.acte_naissance,
       paie_info_personnel_historic_3.direction,
       paie_info_personnel_historic_3.service,
       paie_info_personnel_historic_3.montant,
       paie_info_personnel_historic_3.categorie_qualificationlib,
       paie_info_personnel_historic_3.categorie_paielib,
       paie_info_personnel_historic_3.date_debut,
       paie_info_personnel_historic_3.date_fin,
       paie_info_personnel_historic_3.avenant,
       paie_info_personnel_historic_3.fonctionlib,
       paie_info_personnel_historic_3.debutcontrat,
       paie_info_personnel_historic_3.fincontrat,
       paie_info_personnel_historic_3.numero
FROM paie_info_personnel_historic_3
WHERE paie_info_personnel_historic_3.avenant <> 'initial';


create or replace view PAIE_INFO_PERS_HISTO_ALL as
SELECT piphc.id,
       piphc.idpersonnel,
       piphc.datesaisie,
       piphc.matricule,
       piphc.lieu_naissance_commune,
       piphc.lieu_delivrance_cin,
       piphc.situation_matrimonial,
       piphc.initiale,
       piphc.cturgence_nom_prenom,
       piphc.cturgence_telephone1,
       piphc.cturgence_telephone2,
       piphc.cturgence_telephone3,
       piphc.idconjoint,
       piphc.code_agence_banque,
       piphc.banque_numero_compte,
       piphc.banque_compte_cle,
       piphc.dateembauche,
       piphc.idfonction,
       piphc.idcategorie,
       piphc.mode_paiement,
       piphc.classee,
       piphc.indicegrade,
       piphc.indice_fonctionnel,
       piphc.matricule_patron,
       piphc.statut,
       piphc.droit_hs,
       piphc.vehiculee,
       piphc.echelon,
       piphc.etat,
       piphc.ctg,
       piphc.iduser,
       piphc.indice_ct,
       piphc.datepromotion,
       piphc.numero_cnaps,
       piphc.numero_ostie,
       piphc.temporaire,
       piphc.n_embauche,
       piphc.date_depart,
       piphc.n_depart,
       piphc.nbenfant,
       piphc.heurejournalier,
       piphc.heurehebdomadaire,
       piphc.heuremensuel,
       piphc.indesirable,
       piphc.duree,
       piphc.telephone,
       piphc.mail,
       piphc.adresse_ligne1,
       piphc.adresse_ligne2,
       piphc.code_postal,
       piphc.region,
       piphc.idcategorie_paie,
       piphc.idqualification,
       piphc.formation,
       piphc.discipline,
       piphc.anneeexperience,
       piphc.personnel_etat,
       piphc.periode_essai,
       piphc.permis_conduire,
       piphc.chemin_permis,
       piphc.remarque,
       piphc.id_pers,
       piphc.nom,
       piphc.prenom,
       piphc.date_naissance,
       piphc.sexe,
       piphc.sexepdf,
       piphc.pronompersonnelsujet,
       piphc.genrepdf,
       piphc.numero_cin,
       piphc.date_cin,
       piphc.date_dupl_cin,
       piphc.nationalite,
       piphc.adresse,
       piphc.fokotany,
       piphc.acte_naissance,
       piphc.direction,
       piphc.service,
       piphc.montant,
       piphc.categorie_qualificationlib,
       piphc.categorie_paielib,
       piphc.date_debut,
       piphc.date_fin,
       piphc.avenant,
       piphc.fonctionlib,
       piphc.debutcontrat,
       piphc.fincontrat,
       piphc.numero
FROM paie_info_pers_histo_contrat piphc
UNION ALL
SELECT paie_info_persl_histo_avenant.id,
       paie_info_persl_histo_avenant.idpersonnel,
       paie_info_persl_histo_avenant.datesaisie,
       paie_info_persl_histo_avenant.matricule,
       paie_info_persl_histo_avenant.lieu_naissance_commune,
       paie_info_persl_histo_avenant.lieu_delivrance_cin,
       paie_info_persl_histo_avenant.situation_matrimonial,
       paie_info_persl_histo_avenant.initiale,
       paie_info_persl_histo_avenant.cturgence_nom_prenom,
       paie_info_persl_histo_avenant.cturgence_telephone1,
       paie_info_persl_histo_avenant.cturgence_telephone2,
       paie_info_persl_histo_avenant.cturgence_telephone3,
       paie_info_persl_histo_avenant.idconjoint,
       paie_info_persl_histo_avenant.code_agence_banque,
       paie_info_persl_histo_avenant.banque_numero_compte,
       paie_info_persl_histo_avenant.banque_compte_cle,
       paie_info_persl_histo_avenant.dateembauche,
       paie_info_persl_histo_avenant.idfonction,
       paie_info_persl_histo_avenant.idcategorie,
       paie_info_persl_histo_avenant.mode_paiement,
       paie_info_persl_histo_avenant.classee,
       paie_info_persl_histo_avenant.indicegrade,
       paie_info_persl_histo_avenant.indice_fonctionnel,
       paie_info_persl_histo_avenant.matricule_patron,
       paie_info_persl_histo_avenant.statut,
       paie_info_persl_histo_avenant.droit_hs,
       paie_info_persl_histo_avenant.vehiculee,
       paie_info_persl_histo_avenant.echelon,
       paie_info_persl_histo_avenant.etat,
       paie_info_persl_histo_avenant.ctg,
       paie_info_persl_histo_avenant.iduser,
       paie_info_persl_histo_avenant.indice_ct,
       paie_info_persl_histo_avenant.datepromotion,
       paie_info_persl_histo_avenant.numero_cnaps,
       paie_info_persl_histo_avenant.numero_ostie,
       paie_info_persl_histo_avenant.temporaire,
       paie_info_persl_histo_avenant.n_embauche,
       paie_info_persl_histo_avenant.date_depart,
       paie_info_persl_histo_avenant.n_depart,
       paie_info_persl_histo_avenant.nbenfant,
       paie_info_persl_histo_avenant.heurejournalier,
       paie_info_persl_histo_avenant.heurehebdomadaire,
       paie_info_persl_histo_avenant.heuremensuel,
       paie_info_persl_histo_avenant.indesirable,
       paie_info_persl_histo_avenant.duree,
       paie_info_persl_histo_avenant.telephone,
       paie_info_persl_histo_avenant.mail,
       paie_info_persl_histo_avenant.adresse_ligne1,
       paie_info_persl_histo_avenant.adresse_ligne2,
       paie_info_persl_histo_avenant.code_postal,
       paie_info_persl_histo_avenant.region,
       paie_info_persl_histo_avenant.idcategorie_paie,
       paie_info_persl_histo_avenant.idqualification,
       paie_info_persl_histo_avenant.formation,
       paie_info_persl_histo_avenant.discipline,
       paie_info_persl_histo_avenant.anneeexperience,
       paie_info_persl_histo_avenant.personnel_etat,
       paie_info_persl_histo_avenant.periode_essai,
       paie_info_persl_histo_avenant.permis_conduire,
       paie_info_persl_histo_avenant.chemin_permis,
       paie_info_persl_histo_avenant.remarque,
       paie_info_persl_histo_avenant.id_pers,
       paie_info_persl_histo_avenant.nom,
       paie_info_persl_histo_avenant.prenom,
       paie_info_persl_histo_avenant.date_naissance,
       paie_info_persl_histo_avenant.sexe,
       paie_info_persl_histo_avenant.sexepdf,
       paie_info_persl_histo_avenant.pronompersonnelsujet,
       paie_info_persl_histo_avenant.genrepdf,
       paie_info_persl_histo_avenant.numero_cin,
       paie_info_persl_histo_avenant.date_cin,
       paie_info_persl_histo_avenant.date_dupl_cin,
       paie_info_persl_histo_avenant.nationalite,
       paie_info_persl_histo_avenant.adresse,
       paie_info_persl_histo_avenant.fokotany,
       paie_info_persl_histo_avenant.acte_naissance,
       paie_info_persl_histo_avenant.direction,
       paie_info_persl_histo_avenant.service,
       paie_info_persl_histo_avenant.montant,
       paie_info_persl_histo_avenant.categorie_qualificationlib,
       paie_info_persl_histo_avenant.categorie_paielib,
       paie_info_persl_histo_avenant.date_debut,
       paie_info_persl_histo_avenant.date_fin,
       paie_info_persl_histo_avenant.avenant,
       paie_info_persl_histo_avenant.fonctionlib,
       paie_info_persl_histo_avenant.debutcontrat,
       paie_info_persl_histo_avenant.fincontrat,
       paie_info_persl_histo_avenant.numero
FROM paie_info_persl_histo_avenant;


CREATE OR REPLACE  VIEW PAIE_INFO_PERSO_HISTO_AVENANTS (ID, IDPERSONNEL, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, VEHICULEE, ECHELON, ETAT, CTG, IDUSER, INDICE_CT, DATEPROMOTION, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, N_EMBAUCHE, DATE_DEPART, N_DEPART, NBENFANT, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, INDESIRABLE, DUREE, TELEPHONE, MAIL, ADRESSE_LIGNE1, ADRESSE_LIGNE2, CODE_POSTAL, REGION, IDCATEGORIE_PAIE, IDQUALIFICATION, FORMATION, DISCIPLINE, ANNEEEXPERIENCE, PERSONNEL_ETAT, PERIODE_ESSAI, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, SEXEPDF, PRONOMPERSONNELSUJET, GENREPDF, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, MONTANT, CATEGORIE_QUALIFICATIONLIB, CATEGORIE_PAIELIB, DATE_DEBUT, DATE_FIN, AVENANT, FONCTIONLIB, DEBUTCONTRAT, FINCONTRAT, NUMERO, IDCONTRAT_AVANT) AS
SELECT pip.id,
       pip.idpersonnel,
       pip.datesaisie,
       pip.matricule,
       pip.lieu_naissance_commune,
       pip.lieu_delivrance_cin,
       pip.situation_matrimonial,
       pip.initiale,
       pip.cturgence_nom_prenom,
       pip.cturgence_telephone1,
       pip.cturgence_telephone2,
       pip.cturgence_telephone3,
       pip.idconjoint,
       pip.code_agence_banque,
       pip.banque_numero_compte,
       pip.banque_compte_cle,
       pip.dateembauche,
       pip.idfonction,
       pip.idcategorie,
       pip.mode_paiement,
       pip.classee,
       pip.indicegrade,
       pip.indice_fonctionnel,
       pip.matricule_patron,
       pip.statut,
       pip.droit_hs,
       pip.vehiculee,
       pip.echelon,
       pip.etat,
       pip.ctg,
       pip.iduser,
       pip.indice_ct,
       pip.datepromotion,
       pip.numero_cnaps,
       pip.numero_ostie,
       pip.temporaire,
       pip.n_embauche,
       pip.date_depart,
       pip.n_depart,
       pip.nbenfant,
       pip.heurejournalier,
       pip.heurehebdomadaire,
       pip.heuremensuel,
       pip.indesirable,
       pip.duree,
       pip.telephone,
       pip.mail,
       pip.adresse_ligne1,
       pip.adresse_ligne2,
       pip.code_postal,
       pip.region,
       pip.idcategorie_paie,
       pip.idqualification,
       pip.formation,
       pip.discipline,
       pip.anneeexperience,
       pip.personnel_etat,
       pip.periode_essai,
       pip.permis_conduire,
       pip.chemin_permis,
       pip.remarque,
       pip.id_pers,
       pip.nom,
       pip.prenom,
       pip.date_naissance,
       pip.sexe,
       pip.sexepdf,
       pip.pronompersonnelsujet,
       pip.genrepdf,
       pip.numero_cin,
       pip.date_cin,
       pip.date_dupl_cin,
       pip.nationalite,
       pip.adresse,
       pip.fokotany,
       pip.acte_naissance,
       pip.direction,
       pip.service,
       pip.montant,
       pip.categorie_qualificationlib,
       pip.categorie_paielib,
       pip.date_debut,
       pip.date_fin,
       pip.avenant,
       pip.fonctionlib,
       pip.debutcontrat,
       pip.fincontrat,
       pip.numero,
       ( SELECT pip2.id
         FROM paie_info_pers_histo_contrat pip2
         WHERE pip2.idpersonnel = pip.idpersonnel) AS idcontrat_avant
FROM paie_info_pers_histo_all pip
WHERE pip.avenant <> 'initial';


CREATE OR REPLACE  VIEW LOG_PERSONNEL_INFOCOMPLET3 (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, IDINFO, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, ETAT) AS
select log_personnel.ID,log_personnel.PERMIS_CONDUIRE,log_personnel.CHEMIN_PERMIS,log_personnel.REMARQUE,log_personnel.ID_PERS,log_personnel.NOM,log_personnel.PRENOM,log_personnel.DATE_NAISSANCE,log_personnel.SEXE,log_personnel.NUMERO_CIN,log_personnel.DATE_CIN,log_personnel.DATE_DUPL_CIN,log_personnel.NATIONALITE,log_personnel.ADRESSE,log_personnel.FOKOTANY,log_personnel.ACTE_NAISSANCE,log_personnel.DIRECTION,log_personnel.SERVICE,
       paie_info_personnel.id as idinfo,
       paie_info_personnel.datesaisie,
       paie_info_personnel.matricule,
       paie_info_personnel.lieu_naissance_commune,
       paie_info_personnel.lieu_delivrance_cin,
       paie_info_personnel.situation_matrimonial,
       paie_info_personnel.initiale,
       paie_info_personnel.cturgence_nom_prenom,
       paie_info_personnel.cturgence_telephone1,
       paie_info_personnel.cturgence_telephone2,
       paie_info_personnel.cturgence_telephone3,
       paie_info_personnel.idconjoint,
       paie_info_personnel.code_agence_banque,
       paie_info_personnel.banque_numero_compte,
       paie_info_personnel.banque_compte_cle,
       paie_info_personnel.dateembauche,
       fuc.val as idfonction,
       paie_info_personnel.idcategorie,
       paie_info_personnel.mode_paiement,
       paie_info_personnel.etat
from log_personnel join
     paie_info_personnel on (log_personnel.id = paie_info_personnel.id)
                   left join paie_fonction fuc on(paie_info_personnel.idfonction=fuc.id)
                   left join log_personnel_non_valide on log_personnel.id_pers = log_personnel_non_valide.idlogpers
WHERE log_personnel.id != '1002067';



CREATE OR REPLACE VIEW LOG_SERVICE_CRT (ID, VAL, DESCE) AS
SELECT log_service.id,
       log_service.code_service AS val,
       log_service.libelle AS desce
FROM log_service;


CREATE OR REPLACE VIEW LOG_PERSONNEL_INFOPOINTAGE (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, IDINFO, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, DATE_DEPART, IDFONCTION, FONCTION, IDCATEGORIE, MODE_PAIEMENT, ETAT, TEMPORAIRE, IDGROUPEFONCTION, SERVICE_LIBELLE) AS
select log_personnel.ID,log_personnel.PERMIS_CONDUIRE,log_personnel.CHEMIN_PERMIS,log_personnel.REMARQUE,log_personnel.ID_PERS,log_personnel.NOM,log_personnel.PRENOM,log_personnel.DATE_NAISSANCE,log_personnel.SEXE,log_personnel.NUMERO_CIN,log_personnel.DATE_CIN,log_personnel.DATE_DUPL_CIN,log_personnel.NATIONALITE,log_personnel.ADRESSE,log_personnel.FOKOTANY,log_personnel.ACTE_NAISSANCE,log_personnel.DIRECTION,log_personnel.SERVICE,
       paie_info_personnel.id as idinfo,
       paie_info_personnel.datesaisie,
       paie_info_personnel.matricule,
       paie_info_personnel.lieu_naissance_commune,
       paie_info_personnel.lieu_delivrance_cin,
       paie_info_personnel.situation_matrimonial,
       paie_info_personnel.initiale,
       paie_info_personnel.cturgence_nom_prenom,
       paie_info_personnel.cturgence_telephone1,
       paie_info_personnel.cturgence_telephone2,
       paie_info_personnel.cturgence_telephone3,
       paie_info_personnel.idconjoint,
       paie_info_personnel.code_agence_banque,
       paie_info_personnel.banque_numero_compte,
       paie_info_personnel.banque_compte_cle,
       paie_info_personnel.dateembauche,
       paie_info_personnel.date_depart,
       fuc.val as idfonction,
       paie_info_personnel.idfonction as fonction,
       paie_info_personnel.idcategorie,
       paie_info_personnel.mode_paiement,
       paie_info_personnel.etat, paie_info_personnel.temporaire,
       fuc.IDGROUPEFONCTION,
       ls.CODE_SERVICE||' '|| ls.LIBELLE as service_libelle
from log_personnel LEFT join paie_info_personnel on (log_personnel.id = paie_info_personnel.id)
                   LEFT join log_service ls on ls.id=log_personnel.SERVICE
                   join paie_fonction fuc on(paie_info_personnel.idfonction=fuc.id) where log_personnel.id != '1002067';

CREATE OR REPLACE VIEW POINTAGE_LIB (ID, IDPERSONNEL, DIRECTION, ANNEE, MOIS, HEURENORMAL, HEURESUPFERIE, HEURESUPNORMAL, HEURESUPNUIT, HEURESUPWEEKEND, ABSENCE, DATY, ETAT, DIRECTIONLIB, MOISLIB, MATRICULE, NOMPERSONNEL) AS
SELECT
    p.ID,
    p.IDPERSONNEL,
    p.direction,
    p.ANNEE,
    p.MOIS,
    p.HEURENORMAL,
    p.HEURESUPFERIE,
    p.HEURESUPNORMAL,
    p.HEURESUPNUIT,
    p.HEURESUPWEEKEND,
    p.ABSENCE,
    p.DATY,
    p.ETAT,
    ld.VAL AS directionLib,
    TO_CHAR(
            TO_DATE(TO_CHAR(p.mois, 'FM00'), 'MM'),
            'FMMonth',
            'NLS_DATE_LANGUAGE=FRENCH'
    ) AS moisLib,
    ec.MATRICULE ,
    ec.nom || ' ' || ec.PRENOM AS nomPersonnel
FROM POINTAGE p
         LEFT JOIN LOG_DIRECTION ld ON ld.id = p.DIRECTION
         LEFT JOIN EMPLOYE_COMPLET ec ON ec.id = p.IDPERSONNEL ;


CREATE OR REPLACE VIEW POINTAGEVISEE_VISA_MULTIPLE (ID, IDPERSONNEL, MATRICULE, PERSONNEL, MOISLIB, MOIS, ANNEE, HEURENORMAL, HEURESUPNORMAL, HEURESUPNUIT, HEURESUPFERIE, HEURESUPWEEKEND, ABSENCE, ETAT, DIRECTION, DIRECTIONLIB) AS
SELECT pp.id as id,pp.IDPERSONNEL,lpad(pif.matricule, 5, '0') as matricule, lg.nom || ' ' || lg.prenom as personnel,
       case
           when pp.mois=1 then
               'Janvier'
           when pp.mois=2
               then
               'Fevrier'
           when pp.mois=3
               then
               'Mars'
           when pp.mois=4
               then
               'Avril'
           when pp.mois=5
               then
               'Mai'
           when pp.mois=6
               then
               'Juin'
           when pp.mois=7
               then
               'Juillet'
           when pp.mois=8
               then
               'Aout'
           when pp.mois=9
               then
               'Septembre'
           when pp.mois=10
               then
               'Octobre'
           when pp.mois=11
               then
               'Novembre'
           when pp.mois=12
               then
               'Decembre'
           end as moisLib,
       pp.mois as mois,
       pp.annee,
       sum(nvl(pp.HEURENORMAL,0)) as HEURENORMAL,
       sum(nvl(pp.HEURESUPNORMAL,0)) as HEURESUPNORMAL,
       sum(nvl(pp.HEURESUPNUIT,0)) as HEURESUPNUIT,
       sum(nvl(pp.HEURESUPFERIE,0)) as HEURESUPFERIE,
       sum(nvl(pp.HEURESUPWEEKEND,0)) as HEURESUPWEEKEND,
       sum(nvl(pp.ABSENCE,0)) as ABSENCE,
       pp.etat,
       lg.direction,
       ld.VAL AS directionLib
FROM LOG_PERSONNEL lg
         JOIN Pointage pp ON lg.id = pp.idpersonnel
         JOIN paie_info_personnel pif ON pif.id = lg.id
         LEFT JOIN LOG_DIRECTION ld ON ld.id = pp.DIRECTION
GROUP BY lpad(pif.matricule, 5, '0'), lg.nom || ' ' || lg.prenom, pp.mois, pp.annee, pp.etat,pp.ID,pp.IDPERSONNEL,pp.mois,lg.direction, ld.val;


CREATE OR REPLACE VIEW SOLDECONGE_PERS_CPL (DROIT, CONGEPRIS, SOLDE, NOMPERSONNEL, ID, MATRICULE) AS
SELECT
    CAST(sum(nvl(m.PLUS,0)) AS NUMBER(30, 2)) AS droit ,
    CAST(sum(nvl(m.MOINS ,0)) AS NUMBER(30, 2)) AS congePris ,
    CAST(sum(nvl(m.PLUS,0)) - sum(nvl(m.MOINS ,0)) AS NUMBER(30, 2)) AS solde ,
    lp.NOM || ' ' || lp.PRENOM AS nomPersonnel,
    lp.ID ,
    pip.MATRICULE
FROM MOUVEMENTABSENCE m
         LEFT JOIN LOG_PERSONNEL lp ON lp.ID = m.IDPERSONNEL
         LEFT JOIN PAIE_INFO_PERSONNEL pip ON pip.id = lp.ID WHERE m.IDSOURCE ='TYP000004'
GROUP BY lp.NOM ,
         lp.PRENOM , lp.ID, pip.MATRICULE ;


create or replace view EMPLOYE_COMPLET_LIBELLE2 as
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule AS matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       s.desce AS sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       sf.val AS fokotany,
       p.val AS nationalite,
       logp.acte_naissance,
       sitmat.desce AS situation_matrimonial,
       paie.idconjoint,
       ld.val AS direction,
       serv.libelle AS service,
       pf.desce AS idfonction,
       paie.ctg,
       pc.val AS idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       pm.val AS mode_paiement,
       paie.code_agence_banque,
       paie.banque_compte_cle,
       paie.banque_numero_compte,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.vehiculee,
       CASE paie.vehiculee
           WHEN 0 THEN 'non'
           WHEN 1 THEN 'oui'
           ELSE NULL
           END AS vehiculee_str,
       tab.date_dernierpromo,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       CASE
           WHEN paie.temporaire = '-1' THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire_lib,
       paie.nbenfant,
       lpnv.motif AS motif_debauche,
       ddt.val AS type_debauche,
       paie.adresse_ligne1,
       paie.adresse_ligne2,
       paie.mail,
       paie.telephone,
       paie.code_postal,
       reg.val AS region,
       paie.anneeexperience,
       fd.val AS formation,
       paie.discipline,
       paie.etat,
       cp.DESCE AS categoriePaieLib
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN sexe s ON logp.sexe = s.id
         LEFT JOIN sig_fokontany sf ON logp.fokotany = sf.id
         LEFT JOIN pays p ON logp.nationalite = p.id
         LEFT JOIN log_direction ld ON logp.direction = ld.id
         LEFT JOIN paie_fonction pf ON paie.idfonction = pf.id
         LEFT JOIN paie_categorie pc ON paie.idcategorie = pc.id
         LEFT JOIN modepaiement pm ON paie.mode_paiement = pm.id
         LEFT JOIN situation_matrimoniale sitmat ON paie.situation_matrimonial = sitmat.id
         LEFT JOIN log_personnel_non_valide lpnv ON logp.id = lpnv.idlogpers
         LEFT JOIN dec_decision_type ddt ON lpnv.idtypedebauche = ddt.id
         LEFT JOIN region reg ON reg.id = paie.region
         LEFT JOIN formation_diplome fd ON fd.id = paie.formation
         LEFT JOIN categorie_paie cp ON paie.IDCATEGORIE_PAIE = cp.id
WHERE logp.id <> '1002067';


create or replace view DEMANDE_REMPLACENTS as
SELECT d.id,
       LISTAGG(t.nom || ' ' || t.prenom, '   ,    ') WITHIN GROUP (ORDER BY t.nom) AS remplacents
FROM demande d
    LEFT JOIN employe_complet_libelle2 t ON INSTR(d.idremplacents, t.id) > 0
GROUP BY d.id;

CREATE OR REPLACE VIEW DEMANDE_LIBCOMPLET (ID, IDPERSONNEL, MATRICULE, IDFONCTION, FONCTIONLIB, IDTYPEDEMANDE, TYPEDEMANDELIB, TITRE, HORAIRENORMAL, HEUREDEPART, HEUREARRIVE, IDTYPEABSENCE, TYPEABSENCELIB, MOTIF, NUMERO, DESCE, ETAT, DATY, DUREE, DATEDEPART, DATERETOUR, OBSERVATION, REMARQUE, NOM, PRENOM, IDDIRECTION, DIRECTIONLIB, ETATLIB, REFUSER, RANGUSER, IDREMPLACENTS, REMPLACENTS, MATRICULES, DATEFIN, PERSONNEL, IDSUP, AVENANT, ANNULER, SUPERIEUR, MOTIFREFU) AS
SELECT d.id,
       d.idpersonnel,
       pip.matricule,
       pip.idfonction,
       pf.val AS fonctionlib,
       d.idtypedemande,
       t.val AS typedemandelib,
       d.titre,
       d.horairenormal,
       d.heuredepart,
       d.heurearrive,
       d.idtypeabsence,
       t2.desce AS typeabsencelib,
       d.motif,
       d.numero,
       d.desce,
       d.etat,
       d.daty,
       d.duree,
       d.datedepart,
       d.dateretour,
       d.observation,
       d.remarque,
       lp.nom,
       lp.prenom,
       lp.direction AS iddirection,
       ld.val AS directionlib,
       CASE
           WHEN d.etat = 1 THEN 'cree'
           WHEN d.etat = 11 THEN 'visee'
           ELSE NULL
           END AS etatlib,
       u.refuser,
       r.rang AS ranguser,
       d.idremplacents,
       rmp.remplacents,
       pip.matricule AS matricules,
       d.datefin,
       (lp.nom || ' ') || lp.prenom AS personnel,
       lp.idsup,
       d.avenant,
       CASE
           WHEN d.avenant IS NOT NULL THEN 'OUI'
           ELSE NULL
           END AS annuler,
       (pl.nom || ' ') || pl.prenom AS superieur,
       d.MOTIFREFU
FROM demande d
         LEFT JOIN paie_info_personnel pip ON d.idpersonnel = pip.id
         LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction
         LEFT JOIN typedemande t ON t.id = d.idtypedemande
         LEFT JOIN typeabsence t2 ON t2.id = d.idtypeabsence
         LEFT JOIN log_personnel lp ON lp.id = pip.id
         LEFT JOIN log_direction ld ON ld.id = lp.direction
         LEFT JOIN utilisateur u ON u.refuser = lp.refuser
         LEFT JOIN roles r ON r.idrole = u.idrole
         LEFT JOIN demande_remplacents rmp ON rmp.id = d.id
         LEFT JOIN log_personnel pl ON pl.id = lp.idsup;


CREATE OR REPLACE VIEW LOG_PERSONNEL_FIN (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, CODE_DR, MATRICULE, IDCATEGORIE, CTG, INDICEGRADE, INDICE_FONCTIONNEL, STATUT, CATEGORIEVAL, CTGVAL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, DROIT, PRIE, RESTECONGE, ETAT, IDPERSONNEL, IDDIRECTION) AS
SELECT l.id,
       l.permis_conduire,
       l.chemin_permis,
       l.remarque,
       l.id_pers,
       l.nom,
       l.prenom,
       l.date_naissance,
       sex.desce AS sexe,
       l.numero_cin,
       l.date_cin,
       l.date_dupl_cin,
       l.nationalite,
       l.adresse,
       l.fokotany,
       l.acte_naissance,
       d.val AS direction,
       s.code_service AS service,
       s.code_dr,
       TO_CHAR(paie.matricule) AS matricule,
       paie.idcategorie,
       paie.ctg,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.statut,
       c.taux AS categorieval,
       '''' AS ctgval,
       paie.numero_cnaps,
       paie.numero_ostie,
       CASE
           WHEN paie.temporaire = -1 THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire,
       NVL(dr.conge, 0) AS droit,
       NVL(cg.conge, 0) AS prie,
       NVL(dr.conge, 0) - NVL(cg.conge, 0) AS resteconge,
       paie.etat,
       l.id AS idpersonnel,
       l.direction AS iddirection
FROM log_personnel l
         LEFT JOIN log_service s ON l.service = s.id
         LEFT JOIN paie_info_personnel paie ON paie.id = l.id
         LEFT JOIN sexe sex ON l.sexe = sex.id
         LEFT JOIN log_direction d ON d.id = l.direction
         LEFT JOIN paie_categorie c ON c.id = paie.idcategorie
         LEFT JOIN droitdeconge_parpersonne dr ON dr.idpersonnel = l.id
         LEFT JOIN congeprisgroupbypers cg ON cg.idpersonnel = l.id;

CREATE OR REPLACE VIEW ETATDEMANDE_LIBCPL (ID, VAL, DESCE, RANG, IDTYPEDEMANDE, IDETATHIERARCHIE, IDTYPEDEMANDELIB, IDETATHIERARCHIELIB) AS
SELECT e.id,
       e.val,
       e.desce,
       e.rang,
       e.idtypedemande,
       e.idetathierarchie,
       td.val AS idtypedemandelib,
       eh.val AS idetathierarchielib
FROM etatdemande e
         LEFT JOIN typedemande td ON td.id = e.idtypedemande
         LEFT JOIN etathierarchie eh ON eh.id = e.idetathierarchie;


CREATE OR REPLACE  VIEW EMPLOYE_COMPLET_NOU2 (ID, NOM, PRENOM, ID_PERS, INITIALE, MATRICULE, DATE_NAISSANCE, LIEU_NAISSANCE_COMMUNE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, LIEU_DELIVRANCE_CIN, ADRESSE, FOKOTANY, NATIONALITE, ACTE_NAISSANCE, SITUATION_MATRIMONIAL, IDCONJOINT, DIRECTION, SERVICE, IDFONCTION, CTG, IDCATEGORIE, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, MODE_PAIEMENT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, PERMIS_CONDUIRE, REMARQUE, CHEMIN_PERMIS, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, DATEEMBAUCHE, DATESAISIE, CODE_DR, BANQUE_CODE, ECHELON, ETAT, VEHICULEE, DATE_DERNIERPROMO, DROIT_HS, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, NBENFANT, PERIODE_ESSAI, IDSUP, IDETATHIERARCHIE, REFUSER, ETATVISA, ETATANNULE, IDROLE, RANG) AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       logp.sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       logp.fokotany,
       logp.nationalite,
       logp.acte_naissance,
       paie.situation_matrimonial,
       paie.idconjoint,
       logp.direction,
       logp.service,
       paie.idfonction,
       paie.ctg,
       paie.idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       paie.mode_paiement,
       paie.code_agence_banque,
       paie.banque_numero_compte,
       paie.banque_compte_cle,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.etat,
       paie.vehiculee,
       tab.date_dernierpromo,
       paie.droit_hs,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       paie.nbenfant,
       paie.periode_essai,
       logp.idsup,
       logp.idhierarchie AS idetathierarchie,
       logp.refuser,
       et.etatvisa,
       et.etatannule,
       r.idrole,
       r.rang
FROM log_personnel logp
         JOIN paie_info_personnel paie ON logp.id = paie.id
         JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN etathierarchie et ON et.id = logp.idhierarchie
         LEFT JOIN utilisateur u ON logp.refuser = u.refuser
         LEFT JOIN roles r ON r.idrole = u.idrole;

CREATE OR REPLACE VIEW EMPLOYE_COMPLET_NOU_AVECSUP (ID, NOM, PRENOM, ID_PERS, INITIALE, MATRICULE, DATE_NAISSANCE, LIEU_NAISSANCE_COMMUNE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, LIEU_DELIVRANCE_CIN, ADRESSE, FOKOTANY, NATIONALITE, ACTE_NAISSANCE, SITUATION_MATRIMONIAL, IDCONJOINT, DIRECTION, SERVICE, IDFONCTION, CTG, IDCATEGORIE, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, MODE_PAIEMENT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, PERMIS_CONDUIRE, REMARQUE, CHEMIN_PERMIS, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, DATEEMBAUCHE, DATESAISIE, CODE_DR, BANQUE_CODE, ECHELON, ETAT, VEHICULEE, DATE_DERNIERPROMO, DROIT_HS, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, NBENFANT, PERIODE_ESSAI, IDSUP, IDETATHIERARCHIE, REFUSER, ETATVISA, ETATANNULE, IDROLE, RANG, REFUSERSUP, IDROLESUP, RANGSUP) AS
SELECT ecn.id,
       ecn.nom,
       ecn.prenom,
       ecn.id_pers,
       ecn.initiale,
       ecn.matricule,
       ecn.date_naissance,
       ecn.lieu_naissance_commune,
       ecn.sexe,
       ecn.numero_cin,
       ecn.date_cin,
       ecn.date_dupl_cin,
       ecn.lieu_delivrance_cin,
       ecn.adresse,
       ecn.fokotany,
       ecn.nationalite,
       ecn.acte_naissance,
       ecn.situation_matrimonial,
       ecn.idconjoint,
       ecn.direction,
       ecn.service,
       ecn.idfonction,
       ecn.ctg,
       ecn.idcategorie,
       ecn.classee,
       ecn.indicegrade,
       ecn.indice_fonctionnel,
       ecn.matricule_patron,
       ecn.statut,
       ecn.mode_paiement,
       ecn.code_agence_banque,
       ecn.banque_numero_compte,
       ecn.banque_compte_cle,
       ecn.permis_conduire,
       ecn.remarque,
       ecn.chemin_permis,
       ecn.cturgence_nom_prenom,
       ecn.cturgence_telephone1,
       ecn.cturgence_telephone2,
       ecn.cturgence_telephone3,
       ecn.dateembauche,
       ecn.datesaisie,
       ecn.code_dr,
       ecn.banque_code,
       ecn.echelon,
       ecn.etat,
       ecn.vehiculee,
       ecn.date_dernierpromo,
       ecn.droit_hs,
       ecn.heurejournalier,
       ecn.heurehebdomadaire,
       ecn.heuremensuel,
       ecn.numero_cnaps,
       ecn.numero_ostie,
       ecn.temporaire,
       ecn.nbenfant,
       ecn.periode_essai,
       ecn.idsup,
       ecn.idetathierarchie,
       ecn.refuser,
       ecn.etatvisa,
       ecn.etatannule,
       ecn.idrole,
       ecn.rang,
       ecn2.refuser AS refusersup,
       ecn2.idrole AS idrolesup,
       ecn2.rang AS rangsup
FROM employe_complet_nou2 ecn
         LEFT JOIN employe_complet_nou2 ecn2 ON ecn.idsup = ecn2.id;

CREATE OR REPLACE  VIEW EMPLOYE_COMPLET2 (ID, NOM, PRENOM, ID_PERS, INITIALE, MATRICULE, DATE_NAISSANCE, LIEU_NAISSANCE_COMMUNE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, LIEU_DELIVRANCE_CIN, ADRESSE, FOKOTANY, NATIONALITE, ACTE_NAISSANCE, SITUATION_MATRIMONIAL, IDCONJOINT, DIRECTION, SERVICE, IDFONCTION, CTG, IDCATEGORIE, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, MODE_PAIEMENT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, PERMIS_CONDUIRE, REMARQUE, CHEMIN_PERMIS, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, DATEEMBAUCHE, DATESAISIE, CODE_DR, BANQUE_CODE, ECHELON, ETAT, VEHICULEE, DATE_DERNIERPROMO, DROIT_HS, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, NBENFANT, INDESIRABLE, DUREE, TELEPHONE, MAIL, IDCATEGORIE_PAIE, IDQUALIFICATION, DISCIPLINE, FORMATION, ANNEEEXPERIENCE, PERSONNEL_ETAT, REFUSER, IDETATHIERARCHIE, ETATVISA, ETATANNULE, IDROLE, RANG) AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       logp.sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       logp.fokotany,
       logp.nationalite,
       logp.acte_naissance,
       paie.situation_matrimonial,
       paie.idconjoint,
       logp.direction,
       logp.service,
       paie.idfonction,
       paie.ctg,
       paie.idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       paie.mode_paiement,
       paie.code_agence_banque,
       paie.banque_numero_compte,
       paie.banque_compte_cle,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.etat,
       paie.vehiculee,
       tab.date_dernierpromo,
       paie.droit_hs,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       paie.nbenfant,
       paie.indesirable,
       paie.duree,
       paie.telephone,
       paie.mail,
       paie.idcategorie_paie,
       paie.idqualification,
       paie.discipline,
       paie.formation,
       paie.anneeexperience,
       paie.personnel_etat,
       logp.refuser,
       logp.idhierarchie AS idetathierarchie,
       et.etatvisa,
       et.etatannule,
       r.idrole,
       r.rang
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN categorie_paie cp ON cp.id = paie.idcategorie_paie
         LEFT JOIN qualification_paie qp ON qp.id = paie.idqualification
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = paie.idcategorie_paie AND cq.idqualification = paie.idqualification
         LEFT JOIN etathierarchie et ON et.id = logp.idhierarchie
         LEFT JOIN utilisateur u ON logp.refuser = u.refuser
         LEFT JOIN roles r ON r.idrole = u.idrole;

CREATE OR REPLACE VIEW HISTORIQUEDEMANDEMAX (IDDEMANDE, DATY, HEURE) AS
SELECT h.iddemande,
       max(h.daty) AS daty,
       max(h.heure) AS heure
FROM historiquedemande h
GROUP BY h.iddemande;


CREATE OR REPLACE VIEW ETATDEMANDE_ETAT (ID, VAL, DESCE, RANG, IDTYPEDEMANDE, IDETATHIERARCHIE, VALETATHIERARCHIE, ETATVISA, ETATANNULE) AS
SELECT e.id,
       e.val,
       e.desce,
       e.rang,
       e.idtypedemande,
       e.idetathierarchie,
       e2.val AS valetathierarchie,
       e2.etatvisa,
       e2.etatannule
FROM etatdemande e
         JOIN etathierarchie e2 ON e2.id = e.idetathierarchie;

CREATE OR REPLACE VIEW SITUATIONDEMANDE (ID, IDPERSONNEL, IDTYPEDEMANDE, TITRE, HORAIRENORMAL, HEUREDEPART, HEUREARRIVE, IDTYPEABSENCE, MOTIF, NUMERO, DESCE, ETAT, DATY, DUREE, DATEDEPART, DATERETOUR, OBSERVATION, REMARQUE, DATEHISTORIQUE, HEUREHISTORIQUE, VALETATHIERARCHIE, RANG) AS
SELECT d.id,
       d.idpersonnel,
       d.idtypedemande,
       d.titre,
       d.horairenormal,
       d.heuredepart,
       d.heurearrive,
       d.idtypeabsence,
       d.motif,
       d.numero,
       d.desce,
       d.etat,
       d.daty,
       d.duree,
       d.datedepart,
       d.dateretour,
       d.observation,
       d.remarque,
       h.daty AS datehistorique,
       h.heure AS heurehistorique,
       e.valetathierarchie,
       e.rang
FROM demande d
         JOIN historiquedemandemax h ON h.iddemande = d.id
         JOIN etatdemande_etat e ON e.idtypedemande = d.idtypedemande AND d.etat = e.etatvisa OR d.etat = e.etatannule;


CREATE OR REPLACE VIEW SITUATIONDEMANDE_SUIVANT (ID, IDPERSONNEL, IDTYPEDEMANDE, TITRE, HORAIRENORMAL, HEUREDEPART, HEUREARRIVE, IDTYPEABSENCE, MOTIF, NUMERO, DESCE, ETAT, DATY, DUREE, DATEDEPART, DATERETOUR, OBSERVATION, REMARQUE, DATEHISTORIQUE, HEUREHISTORIQUE, VALETATHIERARCHIE, RANG, RANGSUIVANT, VALETATHIERARCHIESUIVANT, IDETATHIERARCHIE) AS
SELECT s.id,
       s.idpersonnel,
       s.idtypedemande,
       s.titre,
       s.horairenormal,
       s.heuredepart,
       s.heurearrive,
       s.idtypeabsence,
       s.motif,
       s.numero,
       s.desce,
       s.etat,
       s.daty,
       s.duree,
       s.datedepart,
       s.dateretour,
       s.observation,
       s.remarque,
       s.datehistorique,
       s.heurehistorique,
       s.valetathierarchie,
       s.rang,
       e.rang AS rangsuivant,
       e.valetathierarchie AS valetathierarchiesuivant,
       e.idetathierarchie
FROM situationdemande s
         JOIN etatdemande_etat e ON e.idtypedemande = s.idtypedemande AND e.rang = (s.rang + 1);


CREATE OR REPLACE VIEW DEMANDE_VIDE (IDPERSONNEL, MATRICULE, IDFONCTION, FONCTIONLIB, IDTYPEDEMANDE, TYPEDEMANDELIB, TITRE, HORAIRENORMAL, IDTYPEABSENCE, TYPEABSENCELIB, NOM, PRENOM, REFUSER, RANGUSER, IDSUP, ANNULER, DUREEFINAL, TETAT, ASIDDIRECTION, DIRECTIONLIB, ETATLIB, DATY) AS
SELECT
    CAST(NULL AS VARCHAR2(100)) AS idpersonnel,
    CAST(NULL AS VARCHAR2(100)) AS matricule,
    CAST(NULL AS VARCHAR2(100)) AS idfonction,
    CAST(NULL AS VARCHAR2(100)) AS fonctionlib,
    CAST(NULL AS VARCHAR2(100)) AS idtypedemande,
    CAST(NULL AS VARCHAR2(100)) AS typedemandelib,
    CAST(NULL AS VARCHAR2(100)) AS titre,
    CAST(NULL AS VARCHAR2(100)) AS horairenormal,
    CAST(NULL AS VARCHAR2(100)) AS idtypeabsence,
    CAST(NULL AS VARCHAR2(100)) AS typeabsencelib,
    CAST(NULL AS VARCHAR2(100)) AS nom,
    CAST(NULL AS VARCHAR2(100)) AS prenom,
    0 AS refuser,
    0 AS ranguser,
    CAST(NULL AS VARCHAR2(100)) AS idsup,
    CAST(NULL AS VARCHAR2(100)) AS annuler,
    CAST(0 AS NUMBER(32, 0)) AS dureefinal,
    0 AS tetat,
    CAST(NULL AS VARCHAR2(100)) AS asiddirection,
    CAST(NULL AS VARCHAR2(100)) AS directionlib,
    CAST(NULL AS VARCHAR2(100)) AS etatlib,
    SYSDATE AS daty
FROM dual;


CREATE OR REPLACE  VIEW SOLDEPERMISSION_PERS (IDPERSONNEL, ANNEE, PERMISSIONPRIS) AS
SELECT
    m.IDPERSONNEL ,
    m.ANNEE ,
    CAST(SUM(NVL(m.MOINS,0)) AS NUMBER(30, 2)) AS permissionPris
FROM
    MOUVEMENTABSENCE m
GROUP BY m.IDPERSONNEL , m.ANNEE ;

CREATE OR REPLACE  VIEW VUE_CNAPS (IDPERSONNEL, MOIS, ANNEE, RETENUE) AS
SELECT pe.idpersonnel,
       pe.mois,
       pe.annee,
       pe.retenue
FROM paie_edition pe
WHERE pe.idelementpaie = 'PR000101';

CREATE OR REPLACE VIEW LOG_PERSONNEL_INFOCOMPLET (ID, PERMIS_CONDUIRE, CHEMIN_PERMIS, REMARQUE, ID_PERS, NOM, PRENOM, DATE_NAISSANCE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, NATIONALITE, ADRESSE, FOKOTANY, ACTE_NAISSANCE, DIRECTION, SERVICE, IDINFO, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT) AS
SELECT log_personnel.id,
       log_personnel.permis_conduire,
       log_personnel.chemin_permis,
       log_personnel.remarque,
       log_personnel.id_pers,
       log_personnel.nom,
       log_personnel.prenom,
       log_personnel.date_naissance,
       log_personnel.sexe,
       log_personnel.numero_cin,
       log_personnel.date_cin,
       log_personnel.date_dupl_cin,
       log_personnel.nationalite,
       log_personnel.adresse,
       log_personnel.fokotany,
       log_personnel.acte_naissance,
       log_personnel.direction,
       log_personnel.service,
       paie_info_personnel.id AS idinfo,
       paie_info_personnel.datesaisie,
       paie_info_personnel.matricule,
       paie_info_personnel.lieu_naissance_commune,
       paie_info_personnel.lieu_delivrance_cin,
       paie_info_personnel.situation_matrimonial,
       paie_info_personnel.initiale,
       paie_info_personnel.cturgence_nom_prenom,
       paie_info_personnel.cturgence_telephone1,
       paie_info_personnel.cturgence_telephone2,
       paie_info_personnel.cturgence_telephone3,
       paie_info_personnel.idconjoint,
       paie_info_personnel.code_agence_banque,
       paie_info_personnel.banque_numero_compte,
       paie_info_personnel.banque_compte_cle,
       paie_info_personnel.dateembauche,
       paie_info_personnel.idfonction,
       paie_info_personnel.idcategorie,
       paie_info_personnel.mode_paiement
FROM log_personnel
         JOIN paie_info_personnel ON log_personnel.id = paie_info_personnel.id;

CREATE OR REPLACE VIEW PAIE_EDITION_LIBCOMPLET (ID, IDPERSONNEL, IDELEMENTPAIE, MOIS, ANNEE, GAIN, RETENUE, DATEDEBUT, DATEFIN, IDEDITION, REMARQUE, IDPERSONNELLIB, IDELEMENTPAIELIB, MATRICULE, CODERUBRIQUE, MOISLIB) AS
SELECT pe.id,
       pe.idpersonnel,
       pe.idelementpaie,
       pe.mois,
       pe.annee,
       pe.gain,
       pe.retenue,
       pe.datedebut,
       pe.datefin,
       pe.idedition,
       pe.remarque,
       (lp.nom || ' ') || lp.prenom AS idpersonnellib,
       (pr.code || ' ') || pr.val AS idelementpaielib,
       lp.matricule,
       pr.code AS coderubrique,
       TO_CHAR(
               TO_DATE(TO_CHAR(pe.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM paie_edition pe
         LEFT JOIN log_personnel_infocomplet lp ON lp.id = pe.idpersonnel
         LEFT JOIN paie_rubrique pr ON pr.id = pe.idelementpaie
         LEFT JOIN paie_editionmoisannee p ON pe.idedition = p.id;

CREATE OR REPLACE VIEW PAIE_INFO_PERSONNEL_SPEC (ID, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, VEHICULEE, ECHELON, ETAT, CTG, IDUSER, INDICE_CT, DATEPROMOTION, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, N_EMBAUCHE, DATE_DEPART, N_DEPART, NBENFANT, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, INDESIRABLE, DUREE, TELEPHONE, MAIL, ADRESSE_LIGNE1, ADRESSE_LIGNE2, CODE_POSTAL, REGION, IDCATEGORIE_PAIE, IDQUALIFICATION, FORMATION, DISCIPLINE, ANNEEEXPERIENCE, PERSONNEL_ETAT, PERIODE_ESSAI, MONTANT) AS
SELECT pip.id,
       pip.datesaisie,
       pip.matricule,
       pip.lieu_naissance_commune,
       pip.lieu_delivrance_cin,
       pip.situation_matrimonial,
       pip.initiale,
       pip.cturgence_nom_prenom,
       pip.cturgence_telephone1,
       pip.cturgence_telephone2,
       pip.cturgence_telephone3,
       pip.idconjoint,
       pip.code_agence_banque,
       pip.banque_numero_compte,
       pip.banque_compte_cle,
       pip.dateembauche,
       pip.idfonction,
       pip.idcategorie,
       pip.mode_paiement,
       pip.classee,
       pip.indicegrade,
       pip.indice_fonctionnel,
       pip.matricule_patron,
       pip.statut,
       pip.droit_hs,
       pip.vehiculee,
       pip.echelon,
       pip.etat,
       pip.ctg,
       pip.iduser,
       pip.indice_ct,
       pip.datepromotion,
       pip.numero_cnaps,
       pip.numero_ostie,
       pip.temporaire,
       pip.n_embauche,
       pip.date_depart,
       pip.n_depart,
       pip.nbenfant,
       pip.heurejournalier,
       pip.heurehebdomadaire,
       pip.heuremensuel,
       pip.indesirable,
       pip.duree,
       pip.telephone,
       pip.mail,
       pip.adresse_ligne1,
       pip.adresse_ligne2,
       pip.code_postal,
       pip.region,
       pip.idcategorie_paie,
       pip.idqualification,
       pip.formation,
       pip.discipline,
       pip.anneeexperience,
       pip.personnel_etat,
       pip.periode_essai,
       cq.montant
FROM paie_info_personnel pip,
     categorie_qualification cq
WHERE pip.idcategorie_paie = cq.idcategorie AND pip.idqualification = cq.idqualification AND cq.etat = 1 AND pip.id = cq.remarque AND cq.remarque IS NOT NULL;

CREATE OR REPLACE  VIEW PAIE_INFO_PERSONNEL_GROUPE (ID, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, VEHICULEE, ECHELON, ETAT, CTG, IDUSER, INDICE_CT, DATEPROMOTION, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, N_EMBAUCHE, DATE_DEPART, N_DEPART, NBENFANT, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, INDESIRABLE, DUREE, TELEPHONE, MAIL, ADRESSE_LIGNE1, ADRESSE_LIGNE2, CODE_POSTAL, REGION, IDCATEGORIE_PAIE, IDQUALIFICATION, FORMATION, DISCIPLINE, ANNEEEXPERIENCE, PERSONNEL_ETAT, PERIODE_ESSAI, MONTANT) AS
SELECT p.id,
       p.datesaisie,
       p.matricule,
       p.lieu_naissance_commune,
       p.lieu_delivrance_cin,
       p.situation_matrimonial,
       p.initiale,
       p.cturgence_nom_prenom,
       p.cturgence_telephone1,
       p.cturgence_telephone2,
       p.cturgence_telephone3,
       p.idconjoint,
       p.code_agence_banque,
       p.banque_numero_compte,
       p.banque_compte_cle,
       p.dateembauche,
       p.idfonction,
       p.idcategorie,
       p.mode_paiement,
       p.classee,
       p.indicegrade,
       p.indice_fonctionnel,
       p.matricule_patron,
       p.statut,
       p.droit_hs,
       p.vehiculee,
       p.echelon,
       p.etat,
       p.ctg,
       p.iduser,
       p.indice_ct,
       p.datepromotion,
       p.numero_cnaps,
       p.numero_ostie,
       p.temporaire,
       p.n_embauche,
       p.date_depart,
       p.n_depart,
       p.nbenfant,
       p.heurejournalier,
       p.heurehebdomadaire,
       p.heuremensuel,
       p.indesirable,
       p.duree,
       p.telephone,
       p.mail,
       p.adresse_ligne1,
       p.adresse_ligne2,
       p.code_postal,
       p.region,
       p.idcategorie_paie,
       p.idqualification,
       p.formation,
       p.discipline,
       p.anneeexperience,
       p.personnel_etat,
       p.periode_essai,
       cq.montant
FROM paie_info_personnel p,
     categorie_qualification cq
WHERE p.idcategorie_paie = cq.idcategorie AND p.idqualification = cq.idqualification AND cq.etat = 1 AND (cq.remarque = '''' OR cq.remarque IS NULL) AND NOT (p.id IN ( SELECT paie_info_personnel_spec.id
                                                                                                                                                                        FROM paie_info_personnel_spec));

create or replace view PAIE_INFO_PERSONNEL_SB as
SELECT paie_info_personnel_groupe.id,
       paie_info_personnel_groupe.datesaisie,
       paie_info_personnel_groupe.matricule,
       paie_info_personnel_groupe.lieu_naissance_commune,
       paie_info_personnel_groupe.lieu_delivrance_cin,
       paie_info_personnel_groupe.situation_matrimonial,
       paie_info_personnel_groupe.initiale,
       paie_info_personnel_groupe.cturgence_nom_prenom,
       paie_info_personnel_groupe.cturgence_telephone1,
       paie_info_personnel_groupe.cturgence_telephone2,
       paie_info_personnel_groupe.cturgence_telephone3,
       paie_info_personnel_groupe.idconjoint,
       paie_info_personnel_groupe.code_agence_banque,
       paie_info_personnel_groupe.banque_numero_compte,
       paie_info_personnel_groupe.banque_compte_cle,
       paie_info_personnel_groupe.dateembauche,
       paie_info_personnel_groupe.idfonction,
       paie_info_personnel_groupe.idcategorie,
       paie_info_personnel_groupe.mode_paiement,
       paie_info_personnel_groupe.classee,
       paie_info_personnel_groupe.indicegrade,
       paie_info_personnel_groupe.indice_fonctionnel,
       paie_info_personnel_groupe.matricule_patron,
       paie_info_personnel_groupe.statut,
       paie_info_personnel_groupe.droit_hs,
       paie_info_personnel_groupe.vehiculee,
       paie_info_personnel_groupe.echelon,
       paie_info_personnel_groupe.etat,
       paie_info_personnel_groupe.ctg,
       paie_info_personnel_groupe.iduser,
       paie_info_personnel_groupe.indice_ct,
       paie_info_personnel_groupe.datepromotion,
       paie_info_personnel_groupe.numero_cnaps,
       paie_info_personnel_groupe.numero_ostie,
       paie_info_personnel_groupe.temporaire,
       paie_info_personnel_groupe.n_embauche,
       paie_info_personnel_groupe.date_depart,
       paie_info_personnel_groupe.n_depart,
       paie_info_personnel_groupe.nbenfant,
       paie_info_personnel_groupe.heurejournalier,
       paie_info_personnel_groupe.heurehebdomadaire,
       paie_info_personnel_groupe.heuremensuel,
       paie_info_personnel_groupe.indesirable,
       paie_info_personnel_groupe.duree,
       paie_info_personnel_groupe.telephone,
       paie_info_personnel_groupe.mail,
       paie_info_personnel_groupe.adresse_ligne1,
       paie_info_personnel_groupe.adresse_ligne2,
       paie_info_personnel_groupe.code_postal,
       paie_info_personnel_groupe.region,
       paie_info_personnel_groupe.idcategorie_paie,
       paie_info_personnel_groupe.idqualification,
       paie_info_personnel_groupe.formation,
       paie_info_personnel_groupe.discipline,
       paie_info_personnel_groupe.anneeexperience,
       paie_info_personnel_groupe.personnel_etat,
       paie_info_personnel_groupe.periode_essai,
       paie_info_personnel_groupe.montant
FROM paie_info_personnel_groupe
UNION
SELECT paie_info_personnel_spec.id,
       paie_info_personnel_spec.datesaisie,
       paie_info_personnel_spec.matricule,
       paie_info_personnel_spec.lieu_naissance_commune,
       paie_info_personnel_spec.lieu_delivrance_cin,
       paie_info_personnel_spec.situation_matrimonial,
       paie_info_personnel_spec.initiale,
       paie_info_personnel_spec.cturgence_nom_prenom,
       paie_info_personnel_spec.cturgence_telephone1,
       paie_info_personnel_spec.cturgence_telephone2,
       paie_info_personnel_spec.cturgence_telephone3,
       paie_info_personnel_spec.idconjoint,
       paie_info_personnel_spec.code_agence_banque,
       paie_info_personnel_spec.banque_numero_compte,
       paie_info_personnel_spec.banque_compte_cle,
       paie_info_personnel_spec.dateembauche,
       paie_info_personnel_spec.idfonction,
       paie_info_personnel_spec.idcategorie,
       paie_info_personnel_spec.mode_paiement,
       paie_info_personnel_spec.classee,
       paie_info_personnel_spec.indicegrade,
       paie_info_personnel_spec.indice_fonctionnel,
       paie_info_personnel_spec.matricule_patron,
       paie_info_personnel_spec.statut,
       paie_info_personnel_spec.droit_hs,
       paie_info_personnel_spec.vehiculee,
       paie_info_personnel_spec.echelon,
       paie_info_personnel_spec.etat,
       paie_info_personnel_spec.ctg,
       paie_info_personnel_spec.iduser,
       paie_info_personnel_spec.indice_ct,
       paie_info_personnel_spec.datepromotion,
       paie_info_personnel_spec.numero_cnaps,
       paie_info_personnel_spec.numero_ostie,
       paie_info_personnel_spec.temporaire,
       paie_info_personnel_spec.n_embauche,
       paie_info_personnel_spec.date_depart,
       paie_info_personnel_spec.n_depart,
       paie_info_personnel_spec.nbenfant,
       paie_info_personnel_spec.heurejournalier,
       paie_info_personnel_spec.heurehebdomadaire,
       paie_info_personnel_spec.heuremensuel,
       paie_info_personnel_spec.indesirable,
       paie_info_personnel_spec.duree,
       paie_info_personnel_spec.telephone,
       paie_info_personnel_spec.mail,
       paie_info_personnel_spec.adresse_ligne1,
       paie_info_personnel_spec.adresse_ligne2,
       paie_info_personnel_spec.code_postal,
       paie_info_personnel_spec.region,
       paie_info_personnel_spec.idcategorie_paie,
       paie_info_personnel_spec.idqualification,
       paie_info_personnel_spec.formation,
       paie_info_personnel_spec.discipline,
       paie_info_personnel_spec.anneeexperience,
       paie_info_personnel_spec.personnel_etat,
       paie_info_personnel_spec.periode_essai,
       paie_info_personnel_spec.montant
FROM paie_info_personnel_spec;


CREATE OR REPLACE  VIEW PAIE_INFO_PERSONNELDIRECT (ID, NATIONALITE, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, VEHICULEE, ECHELON, ETAT, CTG, IDUSER, INDICE_CT, DATEPROMOTION, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, N_EMBAUCHE, DATE_DEPART, N_DEPART, NBENFANT, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, DIRECTION, SERVICE, PERIODE_ESSAI, SEXE, DATE_NAISSANCE, IDCATEGORIE_PAIE, IDQUALIFICATION, SALAIRE_BASE) AS
SELECT p.id,
       l.nationalite,
       p.datesaisie,
       p.matricule,
       p.lieu_naissance_commune,
       p.lieu_delivrance_cin,
       p.situation_matrimonial,
       p.initiale,
       p.cturgence_nom_prenom,
       p.cturgence_telephone1,
       p.cturgence_telephone2,
       p.cturgence_telephone3,
       p.idconjoint,
       p.code_agence_banque,
       p.banque_numero_compte,
       p.banque_compte_cle,
       p.dateembauche,
       p.idfonction,
       p.idcategorie,
       p.mode_paiement,
       p.classee,
       p.indicegrade,
       p.indice_fonctionnel,
       p.matricule_patron,
       p.statut,
       p.droit_hs,
       p.vehiculee,
       p.echelon,
       p.etat,
       p.ctg,
       p.iduser,
       p.indice_ct,
       p.datepromotion,
       p.numero_cnaps,
       p.numero_ostie,
       p.temporaire,
       p.n_embauche,
       p.date_depart,
       p.n_depart,
       p.nbenfant,
       p.heurejournalier,
       p.heurehebdomadaire,
       p.heuremensuel,
       l.direction,
       l.service,
       p.periode_essai,
       l.sexe,
       l.date_naissance,
       p.idcategorie_paie,
       p.idqualification,
       CAST(COALESCE(pips.montant, 0) AS NUMBER(30,2)) AS salaire_base
FROM paie_info_personnel p,
     log_personnel l,
     paie_info_personnel_sb pips
WHERE l.id = p.id AND p.id = pips.id;

CREATE OR REPLACE  VIEW DERNIER_DEBAUCHE_BY_EMPLOYE (IDLOGPERS, DATEAPPLICATION, IDTYPEDEBAUCHE, DATE_DECISION, DATE_REINTEGRATION, RK, DATEFIN) AS
WITH summary AS (
    SELECT
        p.idlogpers,
        p.dateapplication,
        p.idtypedebauche,
        p.date_decision,
        p.date_reintegration,
        ROW_NUMBER() OVER (PARTITION BY p.idlogpers ORDER BY p.date_decision DESC) AS rk,
        p.datefin
    FROM log_personnel_non_valide p
    WHERE p.idtypedebauche IN (
                               'TYD000013', 'TYD000002', 'TYD000003', 'TYD000004',
                               'TYD000012', 'TYD000014', 'TYD000001'
        )
      AND p.etat >= 11
)
SELECT
    s.idlogpers,
    s.dateapplication,
    s.idtypedebauche,
    s.date_decision,
    s.date_reintegration,
    s.rk,
    s.datefin
FROM summary s
WHERE s.rk = 1;



CREATE OR REPLACE  VIEW PAIEINFOPERSELTPAIECOMPLET2 (ID, CODE_RUBRIQUE, DATE_DEBUT, DATE_FIN, MOISREGULARISATION, ANNEEREGULARISATION, GAIN, RETENUE, QUANTITE, UNITE, REMARQUE, IDPERSONNEL, VAL, DESCE, RANG, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, ISRAPPEL, ISCONFELTFIXE, MOIS, ANNEE, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDGROUPEFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, ETAT_ELEMENT, NATIONALITE, SERVICE, DIRECTION, DATEAPPLICATION, DATEFININVALID, DATE_DECISION, IDTYPEDEBAUCHE, NBENFANT, ID_OBJET, ETAT, TEMPORAIRE, PERIODE_ESSAI, POINTINDICE, REMARQUE_ELEMENT, FORMU, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, IDCATEGORIE_PAIE, IDQUALIFICATION) AS
SELECT elt.id,
       elt.code_rubrique,
       elt.date_debut,
       elt.date_fin,
       elt.moisregularisation,
       elt.anneeregularisation,
       elt.gain,
       elt.retenue,
       elt.quantite,
       elt.unite,
       r.isinfini AS remarque,
       elt.idpersonnel,
       r.val,
       r.desce,
       r.rang,
       r.comptepcg,
       r.code,
       r.typerubrique,
       r.bcs,
       r.bg,
       r.imposable,
       r.nature,
       r.avantage,
       r.cpt_gen_db,
       r.cpt_gen_cr,
       r.cpt_ana_db,
       r.cpt_ana_cr,
       0 AS israppel,
       1 AS isconfeltfixe,
       EXTRACT(MONTH FROM elt.date_debut) AS mois,
       EXTRACT(YEAR FROM elt.date_debut) AS annee,
       info.datesaisie,
       info.matricule,
       info.lieu_naissance_commune,
       info.lieu_delivrance_cin,
       info.situation_matrimonial,
       info.initiale,
       info.cturgence_nom_prenom,
       info.cturgence_telephone1,
       info.cturgence_telephone2,
       info.cturgence_telephone3,
       info.idconjoint,
       info.code_agence_banque,
       info.banque_numero_compte,
       info.banque_compte_cle,
       info.dateembauche,
       info.idfonction,
       fonc.idgroupefonction,
       info.idcategorie,
       info.mode_paiement,
       info.classee,
       info.indicegrade,
       info.indice_fonctionnel,
       info.matricule_patron,
       info.statut,
       info.droit_hs,
       elt.etat AS etat_element,
       info.nationalite,
       info.service,
       info.direction,
       invalid.dateapplication,
       invalid.datefin AS datefininvalid,
       invalid.date_decision,
       invalid.idtypedebauche,
       info.nbenfant,
       elt.id_objet,
       info.etat,
       info.temporaire,
       info.periode_essai,
       c.valmin AS pointindice,
       elt.remarque AS remarque_element,
       formu.id AS formu,
       r.regroupement,
       r.arrondi,
       r.inserted,
       r.sommable,
       r.beneficiaire,
       r.remarque AS remarqueformule,
       r.uniteformule,
       r.qteformule,
       info.idcategorie_paie,
       info.idqualification
FROM paie_personnel_elementpaie elt
         JOIN paie_rubrique r ON elt.code_rubrique = r.id
         LEFT JOIN paie_info_personneldirect info ON elt.idpersonnel = info.id
         LEFT JOIN paie_fonction fonc ON info.idfonction = fonc.id AND info.id <> '1002067'
         LEFT JOIN dernier_debauche_by_employe invalid ON invalid.idlogpers = info.id
         LEFT JOIN configuration c ON c.id = 'CONF000250'
         LEFT JOIN detformu formu ON elt.id = formu.mere;

CREATE OR REPLACE  VIEW DETAILS_PAIE_EDITION_PDF (IDPERSONNEL, IDELEMENTPAIE, GAIN, RETENUE, SALAIRE_DE_BASE, TAUX, JUILLET, INDEMNITE_DE_TRANSPORT, INDEMNITEDEPRESENTATIONBRUT, AVANTAGES_EN_NATURE, MONTANT_BRUT, CNAPS_TRAVAILLEUR, BRUTCNAPS, REDUCTIONPOURPERSONNESACHARGE, IRSA, NETAPRESCALCUL, IRSANET, NET_A_PAYER, MOIS, ANNEE, IDEDITION) AS
SELECT paie_edition.idpersonnel,
       paie_edition.idelementpaie,
       paie_edition.gain,
       paie_edition.retenue,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000041' AND cq2.montant IS NOT NULL THEN cq2.montant
           WHEN paie_edition.idelementpaie = 'PR000041' AND cq2.montant IS NULL THEN cq.montant
           ELSE 0
           END AS salaire_de_base,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000041' AND cq2.montant IS NOT NULL THEN cq2.montant
           WHEN paie_edition.idelementpaie = 'PR000041' AND cq2.montant IS NULL THEN cq.montant
           ELSE 0
           END / 30 AS taux,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000041' THEN paie_edition.gain
           ELSE 0
           END AS juillet,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000001' THEN paie_edition.gain
           ELSE 0
           END AS indemnite_de_transport,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000021' THEN paie_edition.gain
           ELSE 0
           END AS indemnitedepresentationbrut,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000201' THEN paie_edition.gain
           ELSE 0
           END AS avantages_en_nature,
       0 AS montant_brut,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000101' THEN paie_edition.retenue
           ELSE 0
           END AS cnaps_travailleur,
       0 AS brutcnaps,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000181' THEN paie_edition.gain
           ELSE 0
           END AS reductionpourpersonnesacharge,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000141' THEN GREATEST(paie_edition.retenue, 3000)
           ELSE 0
           END AS irsa,
       0 AS netaprescalcul,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000141NET' THEN paie_edition.retenue
           ELSE 0
           END AS irsanet,
       CASE
           WHEN paie_edition.idelementpaie = 'PR000210A' THEN paie_edition.gain
           ELSE 0
           END AS net_a_payer,
       paie_edition.mois,
       paie_edition.annee,
       paie_edition.idedition
FROM paie_edition
         JOIN paie_info_personnel pip ON pip.id = paie_edition.idpersonnel
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = pip.idcategorie_paie AND cq.idqualification = pip.idqualification AND cq.remarque = '''' AND cq.etat = 1
         LEFT JOIN categorie_qualification cq2 ON cq2.idcategorie = pip.idcategorie_paie AND cq2.idqualification = pip.idqualification AND cq2.remarque = paie_edition.idpersonnel AND cq2.remarque = pip.id AND cq2.etat = 1;

CREATE OR REPLACE  VIEW DETAILS_PAIE_EDITION_FINALPDF (ID, NOM, POSTE, SALAIRE_DE_BASE, TAUX, JUILLET, INDEMNITEDEPRESENTATIONBRUT, INDEMNITE_DE_TRANSPORT, AVANTAGES_EN_NATURE, MONTANT_BRUT, CNAPS, BRUTCNAPS, IMPOSABLE, IRSA, NETAPRESCALCUL, REDUCTIONPOURPERSONNESACHARGE, IRSANET, NET_A_PAYER, MOIS, ANNEE, DATEEMBAUCHE, NUMERO_CNAPS, MATRICULE, IDEDITION, MOISLIB) AS
SELECT d.idpersonnel AS id,
       o.cturgence_nom_prenom AS nom,
       pf.desce AS poste,
       sum(d.salaire_de_base) AS salaire_de_base,
       sum(d.taux) AS taux,
       sum(d.juillet) AS juillet,
       sum(d.indemnitedepresentationbrut) AS indemnitedepresentationbrut,
       sum(d.indemnite_de_transport) AS indemnite_de_transport,
       sum(d.avantages_en_nature) AS avantages_en_nature,
       sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) AS montant_brut,
       sum(d.cnaps_travailleur) AS cnaps,
       sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur) AS brutcnaps,
       100 * trunc((sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur)) / 100) AS imposable,
       sum(d.irsa) AS irsa,
       round((sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur) - sum(d.irsa)), 1) AS netaprescalcul,
       sum(d.reductionpourpersonnesacharge) AS reductionpourpersonnesacharge,
       sum(d.irsanet) AS irsanet,
       sum(d.net_a_payer) AS net_a_payer,
       d.mois,
       d.annee,
       o.dateembauche,
       o.numero_cnaps,
       o.matricule,
       d.idedition,
       TO_CHAR(
               TO_DATE(TO_CHAR(d.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM details_paie_edition_pdf d
         LEFT JOIN paie_info_personnel_libcomplet o ON o.id = d.idpersonnel
         LEFT JOIN paie_info_personnel pip ON pip.id = d.idpersonnel
         LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction
GROUP BY d.idpersonnel, o.cturgence_nom_prenom, pf.desce, d.mois, d.annee, o.dateembauche, o.numero_cnaps, o.matricule, d.idedition;

CREATE OR REPLACE VIEW NB_PERS_VALIDE (NBPERSONNELVALIDE) AS
SELECT COUNT(*) AS NBPERSONNELVALIDE FROM LOG_PERSONNEL_V;

CREATE OR REPLACE VIEW TAUXABSENTEISME (HEURETHEORIQUE, HEUREABSENCE, MOIS, ANNEE, TAUXABSENCE, MOISLIB, IDDIRECTION) AS
SELECT
    CAST(nb.NBPERSONNELVALIDE * 173.33 AS NUMBER(30, 2)) AS heuretheorique,
    CAST(NVL(SUM(p.ABSENCE), 0) AS NUMBER(30, 2)) AS heureabsence,
    p.mois,
    p.ANNEE,
    CAST(
            ROUND(
                    (NVL(SUM(p.ABSENCE), 0) / (nb.NBPERSONNELVALIDE * 173.33)) * 100,
                    2
            ) AS NUMBER(30, 2)
    ) AS tauxAbsence,
    TO_CHAR(
            TO_DATE(TO_CHAR(p.mois, 'FM00'), 'MM'),
            'FMMonth',
            'NLS_DATE_LANGUAGE=FRENCH'
    ) AS moisLib,
    p.DIRECTION AS iddirection
FROM
    POINTAGE p,
    NB_PERS_VALIDE nb
GROUP BY
    nb.NBPERSONNELVALIDE, p.mois, p.ANNEE, p.DIRECTION;

CREATE OR REPLACE VIEW V_MOYENNE_SALAIRE_PAR_FONCTION (IDFONCTION, FONCTION_LIBELLE, MOYENNE_SALAIRE) AS
SELECT
    sb.idfonction,
    pf.desce AS fonction_libelle,
    AVG(sb.montant) AS moyenne_salaire
FROM PAIE_INFO_PERSONNEL_SB sb
         LEFT JOIN PAIE_FONCTION pf ON pf.id = sb.idfonction
GROUP BY sb.idfonction, pf.desce;

CREATE OR REPLACE VIEW NET_MOISANNEE (MOIS, ANNEE, MONTANT) AS
SELECT pe.mois,
       pe.annee,
       CAST(sum(pe.gain) AS NUMBER(15,2)) AS montant
FROM paie_edition pe
WHERE pe.idelementpaie = 'PR000210A'
GROUP BY pe.mois, pe.annee;

CREATE OR REPLACE VIEW PAIE_EDITIONMOISANNEE_LIB (ID, IDPERSONNEL, MOIS, ANNEE, GAIN, RETENUE, IDUSER, IDDIRECTION, DATY, MOIS_STRING, ETAT, MONTANT) AS
SELECT pae.id,
       (log.nom || ' ') || log.prenom AS idpersonnel,
       pae.mois,
       pae.annee,
       pae.gain,
       pae.retenue,
       u.nomuser AS iduser,
       dir.val AS iddirection,
       pae.daty,
       CASE
           WHEN pae.mois = 1 THEN 'Janvier'
           WHEN pae.mois = 2 THEN 'Fevrier'
           WHEN pae.mois = 3 THEN 'Mars'
           WHEN pae.mois = 4 THEN 'Avril'
           WHEN pae.mois = 5 THEN 'Mai'
           WHEN pae.mois = 6 THEN 'Juin'
           WHEN pae.mois = 7 THEN 'Juillet'
           WHEN pae.mois = 8 THEN 'Aout'
           WHEN pae.mois = 9 THEN 'Septembre'
           WHEN pae.mois = 10 THEN 'Octobre'
           WHEN pae.mois = 11 THEN 'Novembre'
           WHEN pae.mois = 12 THEN 'Decembre'
           WHEN pae.mois = 13 THEN '13eme MOIS'
           WHEN pae.mois = 14 THEN '13eme MOIS BIS'
           ELSE NULL
           END AS mois_string,
       pae.etat,
       CAST(round(net.montant, 2) AS NUMBER(15,2)) AS montant
FROM paie_editionmoisannee pae
         LEFT JOIN log_personnel log ON log.id_pers = pae.idpersonnel
         LEFT JOIN log_direction dir ON dir.id = pae.iddirection
         LEFT JOIN utilisateur u ON u.refuser = pae.iduser
         LEFT JOIN net_moisannee net ON pae.mois = net.mois AND pae.annee = net.annee
ORDER BY pae.annee DESC, pae.mois DESC;

CREATE OR REPLACE VIEW PAIE_EDITIONMOISANNEE_LIB_2 (ID, IDPERSONNEL, MOIS, ANNEE, GAIN, RETENUE, IDUSER, IDDIRECTION, DATY, MOIS_STRING, ETAT, MONTANT) AS
SELECT pae.id,
       (log.nom || ' ') || log.prenom AS idpersonnel,
       pae.mois,
       pae.annee,
       pae.gain,
       pae.retenue,
       u.nomuser AS iduser,
       dir.val AS iddirection,
       pae.daty,
       CASE
           WHEN pae.mois = 1 THEN 'Janvier'
           WHEN pae.mois = 2 THEN 'Fevrier'
           WHEN pae.mois = 3 THEN 'Mars'
           WHEN pae.mois = 4 THEN 'Avril'
           WHEN pae.mois = 5 THEN 'Mai'
           WHEN pae.mois = 6 THEN 'Juin'
           WHEN pae.mois = 7 THEN 'Juillet'
           WHEN pae.mois = 8 THEN 'Aout'
           WHEN pae.mois = 9 THEN 'Septembre'
           WHEN pae.mois = 10 THEN 'Octobre'
           WHEN pae.mois = 11 THEN 'Novembre'
           WHEN pae.mois = 12 THEN 'Decembre'
           WHEN pae.mois = 13 THEN '13eme MOIS'
           WHEN pae.mois = 14 THEN '13eme MOIS BIS'
           ELSE NULL
           END AS mois_string,
       pae.etat,
       CAST(ROUND(net.montant, 0) AS NUMBER(15, 0)) AS montant
FROM paie_editionmoisannee pae
         LEFT JOIN log_personnel log ON log.id_pers = pae.idpersonnel
         LEFT JOIN log_direction dir ON dir.id = pae.iddirection
         LEFT JOIN utilisateur u ON u.refuser = pae.iduser
         LEFT JOIN net_moisannee net ON pae.mois = net.mois AND pae.annee = net.annee
ORDER BY pae.annee DESC, pae.mois DESC;

CREATE OR REPLACE VIEW MVTCONGEBYMOISANNEE (IDPERSONNEL, PLUS, MOIS, ANNEE) AS
SELECT
    m.IDPERSONNEL,
    SUM(m.PLUS) AS plus,
    m.MOIS,
    m.ANNEE
FROM MOUVEMENTABSENCE m
GROUP BY m.IDPERSONNEL, m.MOIS, m.ANNEE;

CREATE OR REPLACE VIEW PAIE_EDITION_ECRITURE_LIGNE (IDPERSONNEL, IDELEMENTPAIE, MOIS, ANNEE, GAIN, RETENUE, DATEDEBUT, IDEDITION, COMPTEGEN_DB, COMPTEGEN_CR, COMPTEANA_DB, COMPTEANA_CR, TYPERUBRIQUE, RUBRIQUE_LIBELLE, IDDIRECTION, CODE, IMPOSABLE) AS
SELECT pe.idpersonnel,
       pe.idelementpaie,
       pema.mois,
       pema.annee,
       pe.gain,
       pe.retenue,
       pe.datedebut,
       pe.idedition,
       pe.comptegen_db,
       pe.comptegen_cr,
       pe.compteana_db,
       pe.compteana_cr,
       pr.typerubrique,
       pr.val AS rubrique_libelle,
       pema.iddirection,
       pr.code,
       pr.imposable
FROM paie_edition pe
         JOIN paie_rubrique pr ON pr.id = pe.idelementpaie
         JOIN paie_info_personnel pip ON pip.id = pe.idpersonnel
         JOIN paie_editionmoisannee pema ON pema.id = pe.idedition;

CREATE OR REPLACE VIEW ECRITURE_DELA_PAIE (IDELEMENTPAIE, MOIS, ANNEE, GAIN, RETENUE, IDEDITION, COMPTEGEN_DB, COMPTEGEN_CR, COMPTEANA_DB, COMPTEANA_CR, TYPERUBRIQUE, RUBRIQUE_LIBELLE, IDDIRECTION, IMPOSABLE) AS
SELECT peel.idelementpaie,
       peel.mois,
       peel.annee,
       sum(peel.gain) AS gain,
       sum(peel.retenue) AS retenue,
       peel.idedition,
       peel.comptegen_db,
       peel.comptegen_cr,
       peel.compteana_db,
       peel.compteana_cr,
       peel.typerubrique,
       peel.rubrique_libelle,
       peel.iddirection,
       peel.imposable
FROM paie_edition_ecriture_ligne peel
GROUP BY peel.idelementpaie, peel.mois, peel.annee, peel.idedition, peel.comptegen_db, peel.comptegen_cr, peel.compteana_db, peel.compteana_cr, peel.typerubrique, peel.rubrique_libelle, peel.iddirection, peel.code, peel.imposable
ORDER BY peel.typerubrique DESC, peel.code;

CREATE OR REPLACE VIEW ECRITURE_DELA_PAIE_CREDIT (MOIS, ANNEE, GAIN, RETENUE, IDEDITION, COMPTEGEN_DEBIT, COMPTEGEN_CREDIT, TYPERUBRIQUE, IDDIRECTION) AS
SELECT e.mois,
       e.annee,
       sum(e.gain) AS gain,
       sum(e.retenue) AS retenue,
       e.idedition,
       CAST('''' AS varchar(250)) AS comptegen_debit,
       e.comptegen_cr AS comptegen_credit,
       e.typerubrique,
       e.iddirection
FROM ecriture_dela_paie e
WHERE e.comptegen_cr IS NOT NULL
GROUP BY e.mois, e.annee, e.idedition, e.comptegen_cr, e.typerubrique, e.iddirection;

CREATE OR REPLACE VIEW ECRITURE_DELA_PAIE_DEBIT (MOIS, ANNEE, GAIN, RETENUE, IDEDITION, COMPTEGEN_DEBIT, COMPTEGEN_CREDIT, TYPERUBRIQUE, IDDIRECTION) AS
SELECT e.mois,
       e.annee,
       sum(e.gain) AS gain,
       sum(e.retenue) AS retenue,
       e.idedition,
       e.comptegen_db AS comptegen_debit,
       CAST('''' AS varchar(250)) AS comptegen_credit,
       e.typerubrique,
       e.iddirection
FROM ecriture_dela_paie e
WHERE e.comptegen_db IS NOT NULL
GROUP BY e.mois, e.annee, e.idedition, e.comptegen_db, e.typerubrique, e.iddirection;

CREATE OR REPLACE VIEW ECRITURE_DELA_PAIE_REGR (MOIS, ANNEE, GAIN, RETENUE, IDEDITION, COMPTEGEN_DEBIT, COMPTEGEN_CREDIT, TYPERUBRIQUE, IDDIRECTION) AS
SELECT ed.mois,
       ed.annee,
       ed.gain,
       ed.retenue,
       ed.idedition,
       ed.comptegen_debit,
       ed.comptegen_credit,
       ed.typerubrique,
       ed.iddirection
FROM ecriture_dela_paie_debit ed
UNION
SELECT ec.mois,
       ec.annee,
       ec.gain,
       ec.retenue,
       ec.idedition,
       ec.comptegen_debit,
       ec.comptegen_credit,
       ec.typerubrique,
       ec.iddirection
FROM ecriture_dela_paie_credit ec;

CREATE OR REPLACE VIEW ECRITURE_DELA_PAIE_REGR_COMPTE (MOIS, ANNEE, GAIN, RETENUE, IDEDITION, COMPTEGEN_DEBIT, COMPTEGEN_CREDIT, TYPERUBRIQUE, IDDIRECTION, COMPTELIBELLE) AS
SELECT edpr.mois,
       edpr.annee,
       edpr.gain,
       edpr.retenue,
       edpr.idedition,
       edpr.comptegen_debit,
       edpr.comptegen_credit,
       edpr.typerubrique,
       edpr.iddirection,
       cc.libelle AS comptelibelle
FROM ecriture_dela_paie_regr edpr
         LEFT JOIN compta_compte cc ON cc.compte = COALESCE(edpr.comptegen_debit, edpr.comptegen_credit);


CREATE OR REPLACE VIEW TRAITEMENT_PAIE_LIB (IDPERSONNEL, NOMPERSONNEL, MATRICULE, NETAPAYER, IDEDITION, MODEPAIEMENT, NUMEROCOMPTE) AS
SELECT
    ec.id AS idpersonnel ,
    ec.nom || ' ' || ec.PRENOM AS nomPersonnel,
    ec.MATRICULE ,
    pe.GAIN AS netapayer,
    pe.IDEDITION ,
    ec.MODE_PAIEMENT AS modepaiement,
    ec.BANQUE_NUMERO_COMPTE AS numeroCompte
FROM PAIE_EDITION pe
         LEFT JOIN EMPLOYE_COMPLET ec ON ec.id = pe.IDPERSONNEL
WHERE pe.IDELEMENTPAIE ='PR000210A' AND pe.etat >= 11;

CREATE OR REPLACE VIEW PAIE_EDITION_ELTPAIE (ID, IDPERSONNEL, IDELEMENTPAIE, IDEDITION, MOIS, ANNEE, DROITS, RETENUES, DATEDEBUT, DATEFIN, REMARQUE, ELEMENT, CODE, RANG, RUBRIQUEDESCE, IMPOSABLE, RANGBULLETIN, AFFICHER, HEURENORMAL, HEURESUPNORMAL, HEURESUPNUIT, HEURESUPFERIE, HEURESUPWEEKEND, ABSENCE, SALAIREBASE) AS
SELECT
    ed.id,
    ed.idpersonnel,
    ed.idelementpaie,
    ed.idedition,
    ed.mois,
    ed.annee,
    ed.gain AS droits,
    ed.retenue AS retenues,
    ed.datedebut,
    ed.datefin,
    ed.remarque,
    r.val AS element,
    r.code,
    r.rang,
    r.desce AS rubriquedesce,
    r.imposable,
    r.rangbulletin,
    r.afficher,
    p.HEURENORMAL,
    p.HEURESUPNORMAL,
    p.HEURESUPNUIT,
    p.HEURESUPFERIE,
    p.HEURESUPWEEKEND,
    p.ABSENCE,
    c.montant AS salairebase
FROM paie_edition ed
         LEFT JOIN paie_rubrique r
                   ON ed.idelementpaie = r.id
         LEFT JOIN pointage p
                   ON p.idpersonnel = ed.idpersonnel
                       AND p.mois = ed.mois
                       AND p.annee = ed.annee
                       AND p.etat = 11
         LEFT JOIN categorie_qualification c
                   ON c.remarque = ed.idpersonnel ;


CREATE OR REPLACE VIEW PAIE_EDITION_LIBCOMPLET (ID, IDPERSONNEL, IDELEMENTPAIE, MOIS, ANNEE, GAIN, RETENUE, DATEDEBUT, DATEFIN, IDEDITION, REMARQUE, IDPERSONNELLIB, IDELEMENTPAIELIB, MATRICULE, CODERUBRIQUE, MOISLIB) AS
SELECT pe.id,
       pe.idpersonnel,
       pe.idelementpaie,
       pe.mois,
       pe.annee,
       pe.gain,
       pe.retenue,
       pe.datedebut,
       pe.datefin,
       pe.idedition,
       pe.remarque,
       (lp.nom || ' ') || lp.prenom AS idpersonnellib,
       (pr.code || ' ') || pr.val AS idelementpaielib,
       lp.matricule,
       pr.code AS coderubrique,
       TO_CHAR(
               TO_DATE(TO_CHAR(pe.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM paie_edition pe
         LEFT JOIN log_personnel_infocomplet lp ON lp.id = pe.idpersonnel
         LEFT JOIN paie_rubrique pr ON pr.id = pe.idelementpaie
         LEFT JOIN paie_editionmoisannee p ON pe.idedition = p.id;


CREATE OR REPLACE VIEW PAIEINFOPERSELTPAIECOMPLET2 (ID, CODE_RUBRIQUE, DATE_DEBUT, DATE_FIN, MOISREGULARISATION, ANNEEREGULARISATION, GAIN, RETENUE, QUANTITE, UNITE, REMARQUE, IDPERSONNEL, VAL, DESCE, RANG, COMPTEPCG, CODE, TYPERUBRIQUE, BCS, BG, IMPOSABLE, NATURE, AVANTAGE, CPT_GEN_DB, CPT_GEN_CR, CPT_ANA_DB, CPT_ANA_CR, ISRAPPEL, ISCONFELTFIXE, MOIS, ANNEE, DATESAISIE, MATRICULE, LIEU_NAISSANCE_COMMUNE, LIEU_DELIVRANCE_CIN, SITUATION_MATRIMONIAL, INITIALE, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, IDCONJOINT, CODE_AGENCE_BANQUE, BANQUE_NUMERO_COMPTE, BANQUE_COMPTE_CLE, DATEEMBAUCHE, IDFONCTION, IDGROUPEFONCTION, IDCATEGORIE, MODE_PAIEMENT, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, DROIT_HS, ETAT_ELEMENT, NATIONALITE, SERVICE, DIRECTION, DATEAPPLICATION, DATEFININVALID, DATE_DECISION, IDTYPEDEBAUCHE, NBENFANT, ID_OBJET, ETAT, TEMPORAIRE, PERIODE_ESSAI, POINTINDICE, REMARQUE_ELEMENT, FORMU, REGROUPEMENT, ARRONDI, INSERTED, SOMMABLE, BENEFICIAIRE, REMARQUEFORMULE, UNITEFORMULE, QTEFORMULE, IDCATEGORIE_PAIE, IDQUALIFICATION) AS
SELECT elt.id,
       elt.code_rubrique,
       elt.date_debut,
       elt.date_fin,
       elt.moisregularisation,
       elt.anneeregularisation,
       elt.gain,
       elt.retenue,
       elt.quantite,
       elt.unite,
       r.isinfini AS remarque,
       elt.idpersonnel,
       r.val,
       r.desce,
       r.rang,
       r.comptepcg,
       r.code,
       r.typerubrique,
       r.bcs,
       r.bg,
       r.imposable,
       r.nature,
       r.avantage,
       r.cpt_gen_db,
       r.cpt_gen_cr,
       r.cpt_ana_db,
       r.cpt_ana_cr,
       0 AS israppel,
       1 AS isconfeltfixe,
       EXTRACT(MONTH FROM elt.date_debut) AS mois,
       EXTRACT(YEAR FROM elt.date_debut) AS annee,
       info.datesaisie,
       info.matricule,
       info.lieu_naissance_commune,
       info.lieu_delivrance_cin,
       info.situation_matrimonial,
       info.initiale,
       info.cturgence_nom_prenom,
       info.cturgence_telephone1,
       info.cturgence_telephone2,
       info.cturgence_telephone3,
       info.idconjoint,
       info.code_agence_banque,
       info.banque_numero_compte,
       info.banque_compte_cle,
       info.dateembauche,
       info.idfonction,
       fonc.idgroupefonction,
       info.idcategorie,
       info.mode_paiement,
       info.classee,
       info.indicegrade,
       info.indice_fonctionnel,
       info.matricule_patron,
       info.statut,
       info.droit_hs,
       elt.etat AS etat_element,
       info.nationalite,
       info.service,
       info.direction,
       invalid.dateapplication,
       invalid.datefin AS datefininvalid,
       invalid.date_decision,
       invalid.idtypedebauche,
       info.nbenfant,
       elt.id_objet,
       info.etat,
       info.temporaire,
       info.periode_essai,
       c.valmin AS pointindice,
       elt.remarque AS remarque_element,
       formu.id AS formu,
       r.regroupement,
       r.arrondi,
       r.inserted,
       r.sommable,
       r.beneficiaire,
       r.remarque AS remarqueformule,
       r.uniteformule,
       r.qteformule,
       info.idcategorie_paie,
       info.idqualification
FROM paie_personnel_elementpaie elt
         JOIN paie_rubrique r ON elt.code_rubrique = r.id
         LEFT JOIN paie_info_personneldirect info ON elt.idpersonnel = info.id
         LEFT JOIN paie_fonction fonc ON info.idfonction = fonc.id AND info.id <> '1002067'
         LEFT JOIN dernier_debauche_by_employe invalid ON invalid.idlogpers = info.id
         LEFT JOIN configuration c ON c.id = 'CONF000250'
         LEFT JOIN detformu formu ON elt.id = formu.mere;

CREATE OR REPLACE  VIEW DETAILS_PAIE_EDITION_FINALPDF (ID, NOM, POSTE, SALAIRE_DE_BASE, TAUX, JUILLET, INDEMNITEDEPRESENTATIONBRUT, INDEMNITE_DE_TRANSPORT, AVANTAGES_EN_NATURE, MONTANT_BRUT, CNAPS, BRUTCNAPS, IMPOSABLE, IRSA, NETAPRESCALCUL, REDUCTIONPOURPERSONNESACHARGE, IRSANET, NET_A_PAYER, MOIS, ANNEE, DATEEMBAUCHE, NUMERO_CNAPS, MATRICULE, IDEDITION, MOISLIB) AS
SELECT d.idpersonnel AS id,
       o.cturgence_nom_prenom AS nom,
       pf.desce AS poste,
       sum(d.salaire_de_base) AS salaire_de_base,
       sum(d.taux) AS taux,
       sum(d.juillet) AS juillet,
       sum(d.indemnitedepresentationbrut) AS indemnitedepresentationbrut,
       sum(d.indemnite_de_transport) AS indemnite_de_transport,
       sum(d.avantages_en_nature) AS avantages_en_nature,
       sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) AS montant_brut,
       sum(d.cnaps_travailleur) AS cnaps,
       sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur) AS brutcnaps,
       100 * trunc((sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur)) / 100) AS imposable,
       sum(d.irsa) AS irsa,
       round((sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur) - sum(d.irsa)), 1) AS netaprescalcul,
       sum(d.reductionpourpersonnesacharge) AS reductionpourpersonnesacharge,
       sum(d.irsanet) AS irsanet,
       sum(d.net_a_payer) AS net_a_payer,
       d.mois,
       d.annee,
       o.dateembauche,
       o.numero_cnaps,
       o.matricule,
       d.idedition,
       TO_CHAR(
               TO_DATE(TO_CHAR(d.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM details_paie_edition_pdf d
         LEFT JOIN paie_info_personnel_libcomplet o ON o.id = d.idpersonnel
         LEFT JOIN paie_info_personnel pip ON pip.id = d.idpersonnel
         LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction
GROUP BY d.idpersonnel, o.cturgence_nom_prenom, pf.desce, d.mois, d.annee, o.dateembauche, o.numero_cnaps, o.matricule, d.idedition;

CREATE OR REPLACE VIEW EMPLOYE_COMPLET_LIBELLE2 (ID, NOM, PRENOM, ID_PERS, INITIALE, MATRICULE, DATE_NAISSANCE, LIEU_NAISSANCE_COMMUNE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, LIEU_DELIVRANCE_CIN, ADRESSE, FOKOTANY, NATIONALITE, ACTE_NAISSANCE, SITUATION_MATRIMONIAL, IDCONJOINT, DIRECTION, SERVICE, IDFONCTION, CTG, IDCATEGORIE, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, MODE_PAIEMENT, CODE_AGENCE_BANQUE, BANQUE_COMPTE_CLE, BANQUE_NUMERO_COMPTE, PERMIS_CONDUIRE, REMARQUE, CHEMIN_PERMIS, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, DATEEMBAUCHE, DATESAISIE, CODE_DR, BANQUE_CODE, ECHELON, VEHICULEE, VEHICULEE_STR, DATE_DERNIERPROMO, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, TEMPORAIRE_LIB, NBENFANT, MOTIF_DEBAUCHE, TYPE_DEBAUCHE, ADRESSE_LIGNE1, ADRESSE_LIGNE2, MAIL, TELEPHONE, CODE_POSTAL, REGION, ANNEEEXPERIENCE, FORMATION, DISCIPLINE, ETAT, CATEGORIEPAIELIB) AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule AS matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       s.desce AS sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       sf.val AS fokotany,
       p.val AS nationalite,
       logp.acte_naissance,
       sitmat.desce AS situation_matrimonial,
       paie.idconjoint,
       ld.val AS direction,
       serv.libelle AS service,
       pf.desce AS idfonction,
       paie.ctg,
       pc.val AS idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       pm.val AS mode_paiement,
       paie.code_agence_banque,
       paie.banque_compte_cle,
       paie.banque_numero_compte,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.vehiculee,
       CASE paie.vehiculee
           WHEN 0 THEN 'non'
           WHEN 1 THEN 'oui'
           ELSE NULL
           END AS vehiculee_str,
       tab.date_dernierpromo,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       CASE
           WHEN paie.temporaire = '-1' THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire_lib,
       paie.nbenfant,
       lpnv.motif AS motif_debauche,
       ddt.val AS type_debauche,
       paie.adresse_ligne1,
       paie.adresse_ligne2,
       paie.mail,
       paie.telephone,
       paie.code_postal,
       reg.val AS region,
       paie.anneeexperience,
       fd.val AS formation,
       paie.discipline,
       paie.etat,
       cp.DESCE AS categoriePaieLib
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN sexe s ON logp.sexe = s.id
         LEFT JOIN sig_fokontany sf ON logp.fokotany = sf.id
         LEFT JOIN pays p ON logp.nationalite = p.id
         LEFT JOIN log_direction ld ON logp.direction = ld.id
         LEFT JOIN paie_fonction pf ON paie.idfonction = pf.id
         LEFT JOIN paie_categorie pc ON paie.idcategorie = pc.id
         LEFT JOIN modepaiement pm ON paie.mode_paiement = pm.id
         LEFT JOIN situation_matrimoniale sitmat ON paie.situation_matrimonial = sitmat.id
         LEFT JOIN log_personnel_non_valide lpnv ON logp.id = lpnv.idlogpers
         LEFT JOIN dec_decision_type ddt ON lpnv.idtypedebauche = ddt.id
         LEFT JOIN region reg ON reg.id = paie.region
         LEFT JOIN formation_diplome fd ON fd.id = paie.formation
         LEFT JOIN categorie_paie cp ON paie.IDCATEGORIE_PAIE = cp.id
WHERE logp.id <> '1002067';


CREATE OR REPLACE  VIEW EMPLOYE_COMPLET_LIBELLE3 (ID, NOM, PRENOM, ID_PERS, INITIALE, MATRICULE, DATE_NAISSANCE, LIEU_NAISSANCE_COMMUNE, SEXE, NUMERO_CIN, DATE_CIN, DATE_DUPL_CIN, LIEU_DELIVRANCE_CIN, ADRESSE, FOKOTANY, NATIONALITE, ACTE_NAISSANCE, SITUATION_MATRIMONIAL, IDCONJOINT, DIRECTION, SERVICE, IDFONCTION, CTG, IDCATEGORIE, CLASSEE, INDICEGRADE, INDICE_FONCTIONNEL, MATRICULE_PATRON, STATUT, MODE_PAIEMENT, CODE_AGENCE_BANQUE, BANQUE_COMPTE_CLE, BANQUE_NUMERO_COMPTE, PERMIS_CONDUIRE, REMARQUE, CHEMIN_PERMIS, CTURGENCE_NOM_PRENOM, CTURGENCE_TELEPHONE1, CTURGENCE_TELEPHONE2, CTURGENCE_TELEPHONE3, DATEEMBAUCHE, DATESAISIE, SALAIREBASE, CODE_DR, BANQUE_CODE, ECHELON, VEHICULEE, VEHICULEE_STR, DATE_DERNIERPROMO, HEUREJOURNALIER, HEUREHEBDOMADAIRE, HEUREMENSUEL, NUMERO_CNAPS, NUMERO_OSTIE, TEMPORAIRE, TEMPORAIRE_LIB, NBENFANT, MOTIF_DEBAUCHE, TYPE_DEBAUCHE, ADRESSE_LIGNE1, ADRESSE_LIGNE2, MAIL, TELEPHONE, CODE_POSTAL, REGION, ANNEEEXPERIENCE, FORMATION, DISCIPLINE, ETAT) AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule AS matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       s.desce AS sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       sf.val AS fokotany,
       p.val AS nationalite,
       logp.acte_naissance,
       sitmat.desce AS situation_matrimonial,
       paie.idconjoint,
       ld.val AS direction,
       serv.libelle AS service,
       pf.desce AS idfonction,
       paie.ctg,
       pc.val AS idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       pm.val AS mode_paiement,
       paie.code_agence_banque,
       paie.banque_compte_cle,
       paie.banque_numero_compte,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       cq.montant AS salairebase,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.vehiculee,
       CASE paie.vehiculee
           WHEN 0 THEN 'non'
           WHEN 1 THEN 'oui'
           ELSE NULL
           END AS vehiculee_str,
       tab.date_dernierpromo,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       CASE
           WHEN paie.temporaire = '-1' THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire_lib,
       paie.nbenfant,
       lpnv.motif AS motif_debauche,
       ddt.val AS type_debauche,
       paie.adresse_ligne1,
       paie.adresse_ligne2,
       paie.mail,
       paie.telephone,
       paie.code_postal,
       reg.val AS region,
       paie.anneeexperience,
       fd.val AS formation,
       paie.discipline,
       paie.etat
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = paie.idcategorie_paie AND cq.idqualification = paie.idqualification
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN sexe s ON logp.sexe = s.id
         LEFT JOIN sig_fokontany sf ON logp.fokotany = sf.id
         LEFT JOIN pays p ON logp.nationalite = p.id
         LEFT JOIN log_direction ld ON logp.direction = ld.id
         LEFT JOIN paie_fonction pf ON paie.idfonction = pf.id
         LEFT JOIN paie_categorie pc ON paie.idcategorie = pc.id
         LEFT JOIN modepaiement pm ON paie.mode_paiement = pm.id
         LEFT JOIN situation_matrimoniale sitmat ON paie.situation_matrimonial = sitmat.id
         LEFT JOIN log_personnel_non_valide lpnv ON logp.id = lpnv.idlogpers
         LEFT JOIN dec_decision_type ddt ON lpnv.idtypedebauche = ddt.id
         LEFT JOIN region reg ON reg.id = paie.region
         LEFT JOIN formation_diplome fd ON fd.id = paie.formation
WHERE logp.id <> '1002067';


CREATE OR REPLACE VIEW AVANCE_LIB (ID, IDPERSONNEL, MONTANT, NBREMBOURSEMENT, REMARQUE, DATY, DATEAVANCE, ETAT, IDTYPEAVANCE, MATRICULE) AS
SELECT av.id,
       (log.nom || ' ') || log.prenom AS idpersonnel,
       av.montant,
       av.nbremboursement,
       av.remarque,
       av.daty,
       av.dateavance,
       av.etat,
       ty.val AS idtypeavance,
       p.matricule
FROM avance av
         LEFT JOIN log_personnel log ON av.idpersonnel = log.id
         LEFT JOIN paie_info_personnel p ON p.id = log.id
         LEFT JOIN typeavance ty ON ty.id = av.idtypeavance;


CREATE OR REPLACE VIEW AVANCE_LIB2 (ID, IDPERSONNEL, MONTANT, NBREMBOURSEMENT, REMARQUE, DATY, DATEAVANCE, ETAT, ETATLIB, IDTYPEAVANCE, IDTYPEAVANCELIB, MATRICULE) AS
SELECT av.id,
       (log.nom || ' ') || log.prenom AS idpersonnel,
       av.montant,
       av.nbremboursement,
       av.remarque,
       av.daty,
       av.dateavance,
       av.etat,
       CASE
           WHEN av.etat = 1 THEN 'CREE'
           WHEN av.etat = 11 THEN 'VALIDE'
           ELSE NULL
           END AS etatlib,
       av.idtypeavance,
       ty.val AS idtypeavancelib,
       p.matricule
FROM avance av
         LEFT JOIN log_personnel log ON av.idpersonnel = log.id
         LEFT JOIN paie_info_personnel p ON p.id = log.id
         LEFT JOIN typeavance ty ON ty.id = av.idtypeavance;

CREATE OR REPLACE VIEW REMBOURSEMENTLIB (ID, IDAVANCE, MOIS, ANNEE, MONTANT, REMARQUE, DATY, ETAT, PERSONNEL, TYPEAVANCELIB, ETATLIB, MATRICULE, MOISLIB) AS
SELECT pr.id,
       pr.idavance,
       pr.mois,
       pr.annee,
       pr.montant,
       pr.remarque,
       pr.daty,
       pr.etat,
       pip.cturgence_nom_prenom AS personnel,
       t.val AS typeavancelib,
       CASE
           WHEN pr.etat = 1 THEN 'CREE'
           WHEN pr.etat = 11 THEN 'VALIDE'
           ELSE NULL
           END AS etatlib,
       pip.matricule,
       TO_CHAR(
               TO_DATE(TO_CHAR(pr.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM remboursement pr
         LEFT JOIN avance a ON a.id = pr.idavance
         LEFT JOIN typeavance t ON t.id = a.idtypeavance
         LEFT JOIN paie_info_personnel pip ON pip.id = a.idpersonnel;


CREATE OR REPLACE  VIEW PAIE_EDITION_GAIN_IMP (IDPERSONNEL, MOIS, ANNEE, IMPOSABLE) AS
SELECT paie_edition.idpersonnel,
       paie_edition.mois,
       paie_edition.annee,
       CAST(sum(paie_edition.gain) AS NUMBER(15,2)) AS imposable
FROM paie_edition
WHERE (paie_edition.idelementpaie IN ( SELECT paie_rubrique.id
                                       FROM paie_rubrique
                                       WHERE paie_rubrique.typerubrique = 'G' AND paie_rubrique.imposable = 'I' AND paie_rubrique.id NOT LIKE  '%AV%'))
GROUP BY paie_edition.idpersonnel, paie_edition.mois, paie_edition.annee;

CREATE OR REPLACE VIEW RECAP_SAL_ALL (MOIS, ANNEE, SALAIRE, INDEMNITE, AVANTAGE_EN_NATURE, SALAIRE_BRUT, IRSA, CNAPS_TRAVAILLEUR, MONTANT_NET_PAYER, CNAPS_EMPLOYEUR, CNAPS_A_PAYER, ID) AS
SELECT
    pe.mois,
    pe.annee,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PR000041' THEN NVL(pe.gain, 0)
                  ELSE 0
        END), 2) AS salaire,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie IN ('PR000021', 'PR000061', 'PR000081', 'PR000001') THEN NVL(pe.gain, 0)
                  ELSE 0
        END), 2) AS indemnite,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PR000201' THEN NVL(pe.gain, 0)
                  ELSE 0
        END), 2) AS avantage_en_nature,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PRUNI' THEN NVL(pegi.imposable, 0)
                  ELSE 0
        END), 2) AS salaire_brut,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PR000141' THEN NVL(pe.retenue, 0)
                  ELSE 0
        END), 2) AS irsa,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PR000101' THEN NVL(pe.retenue, 0)
                  ELSE 0
        END), 2) AS cnaps_travailleur,

    CAST(ROUND(SUM(CASE
                       WHEN pe.idelementpaie = 'PR000210A' THEN NVL(pe.gain, 0)
                       ELSE 0
        END), 2) AS NUMBER(30, 2))  AS montant_net_payer,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PR000101' THEN NVL(pe.retenue, 0)
                  ELSE 0
        END) * 13, 2) AS cnaps_employeur,

    ROUND(SUM(CASE
                  WHEN pe.idelementpaie = 'PR000101' THEN NVL(pe.retenue, 0)
                  ELSE 0
        END) * 14, 2) AS cnaps_a_payer,
    pe.idedition AS id

FROM paie_edition pe
         LEFT JOIN paie_edition_gain_imp pegi
                   ON pe.idpersonnel = pegi.idpersonnel
                       AND pe.mois = pegi.mois
                       AND pe.annee = pegi.annee
                       AND pe.idelementpaie IN (
                                                'PR000041', 'PR000021', 'PR000061', 'PR000081', 'PR000001',
                                                'PR000201', 'PRUNI', 'PR000141', 'PR000101', 'PR000210A'
                           )
GROUP BY pe.annee, pe.mois, pe.IDEDITION;


CREATE OR REPLACE VIEW RECAPITULATIF_SALAIRE_ALL (MOIS, ANNEE, SALAIRE, INDEMNITE, AVANTAGE_EN_NATURE, SALAIRE_BRUT, IRSA, CNAPS_TRAVAILLEUR, MONTANT_NET_PAYER, CNAPS_EMPLOYEUR, CNAPS_A_PAYER, ID) AS
SELECT recap_sal_all.mois,
       recap_sal_all.annee,
       recap_sal_all.salaire AS salaire,
       recap_sal_all.indemnite AS indemnite,
       recap_sal_all.avantage_en_nature AS avantage_en_nature,
       recap_sal_all.salaire_brut AS salaire_brut,
       recap_sal_all.irsa AS irsa,
       recap_sal_all.cnaps_travailleur AS cnaps_travailleur,
       CAST(recap_sal_all.montant_net_payer AS NUMBER(30, 2)) AS montant_net_payer,
       recap_sal_all.cnaps_employeur AS cnaps_employeur,
       recap_sal_all.cnaps_a_payer AS cnaps_a_payer,
       recap_sal_all.id
FROM recap_sal_all;

CREATE OR REPLACE VIEW FRAIS_MEDICAUXMOIS (IDPERSONNEL, MOIS, ANNEE, TOTAL_BRUT, FRAIS_MEDICAUX) AS
SELECT pe.idpersonnel,
       pe.mois,
       pe.annee,
       sum(pe.gain) AS total_brut,
       COALESCE(prfrm.gain, 0) AS frais_medicaux
FROM paie_edition pe
         LEFT JOIN paie_edition prfrm ON pe.idpersonnel = prfrm.idpersonnel AND pe.mois = prfrm.mois AND pe.annee = prfrm.annee AND prfrm.idelementpaie = 'PR000FRM'
WHERE (pe.idelementpaie IN ( SELECT pr.id
                             FROM paie_rubrique pr
                             WHERE pr.typerubrique = 'G' AND (pr.id NOT IN ('PR000210A', 'PR000FRM', 'PR000181'))))
GROUP BY pe.idpersonnel, pe.mois, pe.annee, prfrm.gain;

CREATE OR REPLACE VIEW FRAIS_MEDICAUX_ALL (ID, MATRICULE, NOM, POSTE, DATEEMBAUCHE, NUMERO_CNAPS, TOTAL_BRUT, FRAIS_MEDICAUX, MOIS, ANNEE, TEST, MOISLIB) AS
SELECT pip.id,
       pip.matricule,
       lp.nom || lp.prenom AS nom,
       pf.desce AS poste,
       pip.dateembauche,
       pip.numero_cnaps,
       frm.total_brut,
       frm.frais_medicaux,
       frm.mois,
       frm.annee AS annee,
       (frm.total_brut * 0.06) AS test,
       mo.val AS moislib
FROM paie_info_personnel pip
         LEFT JOIN paie_fonction pf ON pip.idfonction = pf.id
         LEFT JOIN log_personnel lp ON lp.id = pip.id
         LEFT JOIN frais_medicauxmois frm ON frm.idpersonnel = pip.id
         LEFT JOIN moiscp mo ON mo.id = frm.mois;

CREATE OR REPLACE FORCE VIEW FRM_MOIS_ANNEE (MOIS, ANNEE, TOTAL_FRM) AS
SELECT fma.mois,
       fma.annee AS annee,
       CAST(sum(fma.frais_medicaux) AS NUMBER(15,2)) AS total_frm
FROM frais_medicaux_all fma
GROUP BY fma.mois, fma.annee;

CREATE OR REPLACE VIEW RECAPITULATIF_ALL_FINAL (MOIS, ANNEE, SALAIRE, INDEMNITE, AVANTAGE_EN_NATURE, SALAIRE_BRUT, IRSA, CNAPS_TRAVAILLEUR, MONTANT_NET_PAYER, CNAPS_EMPLOYEUR, CNAPS_A_PAYER, TOTAL_FRM, ID) AS
SELECT rs.mois,
       rs.annee,
       rs.salaire,
       rs.indemnite,
       rs.avantage_en_nature,
       rs.salaire_brut,
       rs.irsa,
       rs.cnaps_travailleur,
       CAST(rs.montant_net_payer AS NUMBER(30, 2)) AS MONTANT_NET_PAYER,
       rs.cnaps_employeur,
       rs.cnaps_a_payer,
       frm.total_frm,
       rs.id
FROM recapitulatif_salaire_all rs
         LEFT JOIN frm_mois_annee frm ON rs.mois = frm.mois AND rs.annee = frm.annee;


CREATE OR REPLACE VIEW DET_PAIE_EDIT_FINAL_PDF_CONID (ID, NOM, POSTE, SALAIRE_DE_BASE, TAUX, JUILLET, INDEMNITEDEPRESENTATIONBRUT, INDEMNITE_DE_TRANSPORT, AVANTAGES_EN_NATURE, MONTANT_BRUT, CNAPS, BRUTCNAPS, IMPOSABLE, IRSA, NETAPRESCALCUL, REDUCTIONPOURPERSONNESACHARGE, IRSANET, NET_A_PAYER, MOIS, ANNEE, DATEEMBAUCHE, NUMERO_CNAPS, MATRICULE, IDEDITION, MOISLIB) AS
SELECT (d.idpersonnel || '//') || d.idedition AS id,
       o.cturgence_nom_prenom AS nom,
       pf.desce AS poste,
       sum(d.salaire_de_base) AS salaire_de_base,
       sum(d.taux) AS taux,
       sum(d.juillet) AS juillet,
       sum(d.indemnitedepresentationbrut) AS indemnitedepresentationbrut,
       sum(d.indemnite_de_transport) AS indemnite_de_transport,
       sum(d.avantages_en_nature) AS avantages_en_nature,
       sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) AS montant_brut,
       sum(d.cnaps_travailleur) AS cnaps,
       sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur) AS brutcnaps,
       100 * trunc((sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur)) / 100) AS imposable,
       sum(d.irsa) AS irsa,
       round((sum(d.juillet) + sum(d.indemnitedepresentationbrut) + sum(d.indemnite_de_transport) + sum(d.avantages_en_nature) - sum(d.cnaps_travailleur) - sum(d.irsa)), 1) AS netaprescalcul,
       sum(d.reductionpourpersonnesacharge) AS reductionpourpersonnesacharge,
       sum(d.irsanet) AS irsanet,
       sum(d.net_a_payer) AS net_a_payer,
       d.mois,
       d.annee,
       o.dateembauche,
       o.numero_cnaps,
       o.matricule,
       d.idedition,
       TO_CHAR(
               TO_DATE(TO_CHAR(d.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM details_paie_edition_pdf d
         LEFT JOIN paie_info_personnel_libcomplet o ON o.id = d.idpersonnel
         LEFT JOIN paie_info_personnel pip ON pip.id = d.idpersonnel
         LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction
GROUP BY d.idpersonnel, o.cturgence_nom_prenom, pf.desce, d.mois, d.annee, o.dateembauche, o.numero_cnaps, o.matricule, d.idedition;

CREATE OR REPLACE VIEW ETAT_IRSA (ID, MOIS, MOIS_LIB, ANNEE, MATRICULE, NUMERO_CNAPS, NOM, POSTE, SALAIRE_DE_BASE, INDEMNITE, AVANTAGES_EN_NATURE, MONTANT_BRUT, CNAPS, NET_A_PAYER, IMPOSABLE, IRSA, REDUCTIONPOURPERSONNESACHARGE, IRSANET) AS
SELECT dp.id,
       dp.mois,
       mcp.desce AS mois_lib,
       dp.annee,
       dp.matricule,
       COALESCE(dp.numero_cnaps, '''') AS numero_cnaps,
       dp.nom,
       dp.poste,
       dp.salaire_de_base AS salaire_de_base,
       dp.indemnitedepresentationbrut + dp.indemnite_de_transport AS indemnite,
       dp.avantages_en_nature AS avantages_en_nature,
       dp.montant_brut AS montant_brut,
       dp.cnaps,
       dp.net_a_payer,
       dp.imposable,
       dp.irsa,
       dp.reductionpourpersonnesacharge,
       dp.irsanet
FROM details_paie_edition_finalpdf dp
         LEFT JOIN moiscp mcp ON dp.mois = mcp.id;


CREATE OR REPLACE VIEW SALAIREBASEMOIS (IDPERSONNEL, MOIS, ANNEE, SALAIREBASE) AS
SELECT IDPERSONNEL,mois,annee,round(sum(gain),0) AS salairebase FROM paie_edition WHERE IDELEMENTPAIE IN (
    SELECT id FROM PAIE_RUBRIQUE pr WHERE TYPERUBRIQUE='G' AND IMPOSABLE = 'I'
) GROUP BY IDPERSONNEL,mois,annee;


CREATE OR REPLACE VIEW V1_OSTIE_AFFICHE_T1 (NUMERO, MATRICULE, NOM, PRENOMS, SEXE, DATE_NAISSANCE, DATEEMBAUCHE, DATE_DEPART, FONCTION, CNAPS, CIN, MOIS1, MOIS2, MOIS3, SALAIRES_NON_PLAFONNES, SALAIRES_PLAFONNES, EMPLOYEUR, TRAVAILLEUR, TOTAL, ANNEE, DIRECTION) AS
SELECT
    rownum as numero,
    lpad(pip.matricule,5,'0') as matricule,
    Upper(trim(trailing ' ' from lp.NOM)) as nom,
    Upper(trim(trailing ' ' from lp.prenom)) as prenoms,
    sexe.val as sexe,
    lp.date_naissance,
    pip.dateembauche,
    case
        when extract(year from pip.date_depart)=nvl(s3.annee,nvl(s2.annee,nvl(s1.annee,0)))
            and (
                 extract(month from pip.date_depart) = 1
                     or
                 extract(month from pip.date_depart) = 2
                     or
                 extract(month from pip.date_depart) = 3
                 ) then pip.date_depart
        else
            null
        end as date_depart,
    upper(paf.desce) as fonction,
    upper(pip.NUMERO_CNAPS) as cnaps,
    lp.numero_cin as cin,
    nvl(s1.salairebase,0) as mois1,
    nvl(s2.salairebase,0) as mois2,
    nvl(s3.salairebase,0) as mois3,
    (nvl(s1.salairebase, 0)+nvl(s2.salairebase, 0)+nvl(s3.salairebase, 0)) as salaires_non_plafonnes,
    (
        case
            when nvl(s1.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s1.salairebase,0)
            end
        )+
    (
        case
            when nvl(s2.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s2.salairebase,0)
            end
        )+
    (
        case
            when nvl(s3.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s3.salairebase,0)
            end
        ) as salaires_plafonnes,
    nvl(ostie.retenue,0)*5 as employeur,
    nvl(ostie.retenue,0) as travailleur,
    (nvl(ostie.retenue,0)*5)+nvl(ostie.retenue,0) as total,
    ostie.annee,
    ostie.direction
FROM log_personnel lp
         JOIN paie_info_personnel pip ON pip.id=lp.id
         JOIN log_direction ld ON ld.id=lp.direction
         JOIN paie_fonction paf ON paf.id = pip.idfonction
         JOIN sexe ON sexe.id = lp.sexe
         LEFT JOIN
     (SELECT sum(round(retenue,0)) as retenue,idpersonnel,annee,direction FROM paie_edition WHERE
         (mois = 1 or mois=2 or mois =3) AND etat=11 AND IDELEMENTPAIE ='PRU000I710'
      group by idpersonnel,annee,direction) ostie
     ON ostie.idpersonnel = lp.id
         LEFT JOIN
     (select * from salairebasemois where mois = 1) s1
     ON lp.id = s1.idpersonnel and ostie.annee= s1.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 2) s2
     ON lp.id = s2.idpersonnel and ostie.annee = s2.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 3) s3
     ON lp.id = s3.idpersonnel and ostie.annee=s3.annee
WHERE nvl(ostie.retenue,0)!=0
ORDER BY annee,pip.matricule;


CREATE OR REPLACE VIEW V1_OSTIE_AFFICHE_T2 (NUMERO, MATRICULE, NOM, PRENOMS, SEXE, DATE_NAISSANCE, DATEEMBAUCHE, DATE_DEPART, FONCTION, CNAPS, CIN, MOIS1, MOIS2, MOIS3, SALAIRES_NON_PLAFONNES, SALAIRES_PLAFONNES, EMPLOYEUR, TRAVAILLEUR, TOTAL, ANNEE, DIRECTION) AS
SELECT
    rownum as numero,
    lpad(pip.matricule,5,'0') as matricule,
    Upper(trim(trailing ' ' from lp.NOM)) as nom,
    Upper(trim(trailing ' ' from lp.prenom)) as prenoms,
    sexe.val as sexe,
    lp.date_naissance,
    pip.dateembauche,
    case
        when extract(year from pip.date_depart)=nvl(s3.annee,nvl(s2.annee,nvl(s1.annee,0)))
            and (
                 extract(month from pip.date_depart) = 4
                     or
                 extract(month from pip.date_depart) = 5
                     or
                 extract(month from pip.date_depart) = 6
                 ) then pip.date_depart
        else
            null
        end as date_depart,
    upper(paf.desce) as fonction,
    upper(pip.NUMERO_CNAPS) as cnaps,
    lp.numero_cin as cin,
    nvl(s1.salairebase,0) as mois1,
    nvl(s2.salairebase,0) as mois2,
    nvl(s3.salairebase,0) as mois3,
    (nvl(s1.salairebase, 0)+nvl(s2.salairebase, 0)+nvl(s3.salairebase, 0)) as salaires_non_plafonnes,
    (
        case
            when nvl(s1.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s1.salairebase,0)
            end
        )+
    (
        case
            when nvl(s2.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s2.salairebase,0)
            end
        )+
    (
        case
            when nvl(s3.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s3.salairebase,0)
            end
        ) as salaires_plafonnes,
    nvl(ostie.retenue,0)*5 as employeur,
    nvl(ostie.retenue,0) as travailleur,
    (nvl(ostie.retenue,0)*5)+nvl(ostie.retenue,0) as total,
    ostie.annee,
    ostie.direction
FROM log_personnel lp
         JOIN paie_info_personnel pip ON pip.id=lp.id
         JOIN log_direction ld ON ld.id=lp.direction
         JOIN paie_fonction paf ON paf.id = pip.idfonction
         JOIN sexe ON sexe.id = lp.sexe
         LEFT JOIN
     (SELECT sum(round(retenue,0)) as retenue,idpersonnel,annee,direction FROM paie_edition WHERE
         (mois = 4 or mois=5 or mois =6) AND etat=11 AND IDELEMENTPAIE ='PRU000I710'
      group by idpersonnel,annee,direction) ostie
     ON ostie.idpersonnel = lp.id
         LEFT JOIN
     (select * from salairebasemois where mois = 4) s1
     ON lp.id = s1.idpersonnel and ostie.annee= s1.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 5) s2
     ON lp.id = s2.idpersonnel and ostie.annee = s2.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 6) s3
     ON lp.id = s3.idpersonnel and ostie.annee=s3.annee
WHERE nvl(ostie.retenue,0)!=0
ORDER BY annee,pip.matricule;

CREATE OR REPLACE FORCE VIEW V1_OSTIE_AFFICHE_T3 (NUMERO, MATRICULE, NOM, PRENOMS, SEXE, DATE_NAISSANCE, DATEEMBAUCHE, DATE_DEPART, FONCTION, CNAPS, CIN, MOIS1, MOIS2, MOIS3, SALAIRES_NON_PLAFONNES, SALAIRES_PLAFONNES, EMPLOYEUR, TRAVAILLEUR, TOTAL, ANNEE, DIRECTION) AS
SELECT
    rownum as numero,
    lpad(pip.matricule,5,'0') as matricule,
    Upper(trim(trailing ' ' from lp.NOM)) as nom,
    Upper(trim(trailing ' ' from lp.prenom)) as prenoms,
    sexe.val as sexe,
    lp.date_naissance,
    pip.dateembauche,
    case
        when extract(year from pip.date_depart)=nvl(s3.annee,nvl(s2.annee,nvl(s1.annee,0)))
            and (
                 extract(month from pip.date_depart) = 7
                     or
                 extract(month from pip.date_depart) = 8
                     or
                 extract(month from pip.date_depart) = 9
                 ) then pip.date_depart
        else
            null
        end as date_depart,
    upper(paf.desce) as fonction,
    upper(pip.NUMERO_CNAPS) as cnaps,
    lp.numero_cin as cin,
    nvl(s1.salairebase,0) as mois1,
    nvl(s2.salairebase,0) as mois2,
    nvl(s3.salairebase,0) as mois3,
    (nvl(s1.salairebase, 0)+nvl(s2.salairebase, 0)+nvl(s3.salairebase, 0)) as salaires_non_plafonnes,
    (
        case
            when nvl(s1.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s1.salairebase,0)
            end
        )+
    (
        case
            when nvl(s2.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s2.salairebase,0)
            end
        )+
    (
        case
            when nvl(s3.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s3.salairebase,0)
            end
        ) as salaires_plafonnes,
    nvl(ostie.retenue,0)*5 as employeur,
    nvl(ostie.retenue,0) as travailleur,
    (nvl(ostie.retenue,0)*5)+nvl(ostie.retenue,0) as total,
    ostie.annee,
    ostie.direction
FROM log_personnel lp
         JOIN paie_info_personnel pip ON pip.id=lp.id
         JOIN log_direction ld ON ld.id=lp.direction
         JOIN paie_fonction paf ON paf.id = pip.idfonction
         JOIN sexe ON sexe.id = lp.sexe
         LEFT JOIN
     (SELECT sum(round(retenue,0)) as retenue,idpersonnel,annee,direction FROM paie_edition WHERE
         (mois = 7 or mois=8 or mois =9) AND etat=11 AND IDELEMENTPAIE ='PRU000I710'
      group by idpersonnel,annee,direction) ostie
     ON ostie.idpersonnel = lp.id
         LEFT JOIN
     (select * from salairebasemois where mois = 7) s1
     ON lp.id = s1.idpersonnel and ostie.annee= s1.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 8) s2
     ON lp.id = s2.idpersonnel and ostie.annee = s2.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 9) s3
     ON lp.id = s3.idpersonnel and ostie.annee=s3.annee
WHERE nvl(ostie.retenue,0)!=0
ORDER BY annee,pip.matricule;


CREATE OR REPLACE  VIEW V1_OSTIE_AFFICHE_T4 (NUMERO, MATRICULE, NOM, PRENOMS, SEXE, DATE_NAISSANCE, DATEEMBAUCHE, DATE_DEPART, FONCTION, CNAPS, CIN, MOIS1, MOIS2, MOIS3, SALAIRES_NON_PLAFONNES, SALAIRES_PLAFONNES, EMPLOYEUR, TRAVAILLEUR, TOTAL, ANNEE, DIRECTION) AS
SELECT
    rownum as numero,
    lpad(pip.matricule,5,'0') as matricule,
    Upper(trim(trailing ' ' from lp.NOM)) as nom,
    Upper(trim(trailing ' ' from lp.prenom)) as prenoms,
    sexe.val as sexe,
    lp.date_naissance,
    pip.dateembauche,
    case
        when extract(year from pip.date_depart)=nvl(s3.annee,nvl(s2.annee,nvl(s1.annee,0)))
            and (
                 extract(month from pip.date_depart) = 10
                     or
                 extract(month from pip.date_depart) = 11
                     or
                 extract(month from pip.date_depart) = 12
                 ) then pip.date_depart
        else
            null
        end as date_depart,
    upper(paf.desce) as fonction,
    upper(pip.NUMERO_CNAPS) as cnaps,
    lp.numero_cin as cin,
    nvl(s1.salairebase,0) as mois1,
    nvl(s2.salairebase,0) as mois2,
    nvl(s3.salairebase,0) as mois3,
    (nvl(s1.salairebase, 0)+nvl(s2.salairebase, 0)+nvl(s3.salairebase, 0)) as salaires_non_plafonnes,
    (
        case
            when nvl(s1.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s1.salairebase,0)
            end
        )+
    (
        case
            when nvl(s2.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s2.salairebase,0)
            end
        )+
    (
        case
            when nvl(s3.salairebase,0) >= (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
                then (select cast(valmin as number) as maximum from configuration where id = 'CONF000140')
            else
                nvl(s3.salairebase,0)
            end
        ) as salaires_plafonnes,
    nvl(ostie.retenue,0)*5 as employeur,
    nvl(ostie.retenue,0) as travailleur,
    (nvl(ostie.retenue,0)*5)+nvl(ostie.retenue,0) as total,
    ostie.annee,
    ostie.direction
FROM log_personnel lp
         JOIN paie_info_personnel pip ON pip.id=lp.id
         JOIN log_direction ld ON ld.id=lp.direction
         JOIN paie_fonction paf ON paf.id = pip.idfonction
         JOIN sexe ON sexe.id = lp.sexe
         LEFT JOIN
     (SELECT sum(round(retenue,0)) as retenue,idpersonnel,annee,direction FROM paie_edition WHERE
         (mois = 10 or mois=11 or mois =12) AND etat=11 AND IDELEMENTPAIE ='PRU000I710'
      group by idpersonnel,annee,direction) ostie
     ON ostie.idpersonnel = lp.id
         LEFT JOIN
     (select * from salairebasemois where mois = 10) s1
     ON lp.id = s1.idpersonnel and ostie.annee= s1.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 11) s2
     ON lp.id = s2.idpersonnel and ostie.annee = s2.annee
         LEFT JOIN
     (select * from salairebasemois where mois = 12) s3
     ON lp.id = s3.idpersonnel and ostie.annee=s3.annee
WHERE nvl(ostie.retenue,0)!=0
ORDER BY annee,pip.matricule;


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_5 AS
SELECT lpnv.id,
       lp.id AS idlogpers,
       lpnv.dateapplication,
       lpnv.date_decision,
       lpnv.idtypedebauche,
       ddt.val AS typedebauche,
       lpnv.refdecision,
       lpnv.idavancement,
       lpnv.motif,
       lp.sexe,
       lpnv.etat,
       (lp.nom || ' ') || lp.prenom AS personnelid,
       (lp2.nom || ' ') || lp2.prenom AS passationib,
       pif.matricule,
       lpnv.idpassation
FROM log_personnel_non_valide lpnv
         JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
         JOIN log_personnel lp ON lpnv.idlogpers = lp.id
         LEFT JOIN log_personnel lp2 ON lpnv.idpassation = lp2.id
         JOIN type_depart ddt ON ddt.id = lpnv.idtypedebauche
WHERE lpnv.date_reintegration IS NULL;



CREATE OR REPLACE VIEW LOG_PERS_STC AS
SELECT lpnv.id,
       lp.id AS idlogpers,
       lpnv.dateapplication,
       lpnv.date_decision,
       lpnv.idtypedebauche,
       lpnv.refdecision,
       lpnv.idavancement,
       lpnv.motif,
       lp.sexe,
       lpnv.etat,
       lpnv.iduser,
       pif.matricule
FROM log_personnel_non_valide lpnv
         JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
         JOIN log_personnel lp ON lpnv.idlogpers = lp.id
WHERE lpnv.date_reintegration IS NULL;

CREATE OR REPLACE VIEW SOLDECONGE_PERS AS
SELECT
    CAST(sum(nvl(m.PLUS,0)) AS NUMBER(30, 2)) AS plus ,
    CAST(sum(nvl(m.MOINS ,0)) AS NUMBER(30, 2)) AS moins ,
    CAST(sum(nvl(m.PLUS,0)) - sum(nvl(m.MOINS ,0)) AS NUMBER(30, 2)) AS solde ,
    lp.NOM ,
    lp.PRENOM ,
    lp.ID AS IDPERSONNEL
FROM MOUVEMENTABSENCE m
         LEFT JOIN LOG_PERSONNEL lp ON lp.ID = m.IDPERSONNEL
GROUP BY lp.NOM ,
         lp.PRENOM , lp.ID
;


CREATE OR REPLACE VIEW SOLDECONGEPRIS_PERS AS
SELECT
    lp.ID AS ID,
    CAST(sum(nvl(m.PLUS,0)) AS NUMBER(30, 2)) AS plus ,
    CAST(sum(nvl(m.MOINS ,0)) AS NUMBER(30, 2)) AS congepris ,
    lp.nom || ' ' || lp.prenom AS nomPersonnel,
    lp.matricule AS matricule,
    lp.iddirection AS idDirection
FROM MOUVEMENTABSENCE m
         LEFT JOIN LOG_PERSONNEL_V2 lp ON lp.ID = m.IDPERSONNEL
GROUP BY lp.NOM ,
         lp.PRENOM , lp.ID, lp.matricule, lp.IDDIRECTION
;


CREATE OR REPLACE VIEW LOG_PERSONNEL_AVECCONGE AS
SELECT l.id,
       l.permis_conduire,
       l.chemin_permis,
       l.remarque,
       l.id_pers,
       l.nom,
       l.prenom,
       l.date_naissance,
       sex.desce AS sexe,
       l.numero_cin,
       l.date_cin,
       l.date_dupl_cin,
       l.nationalite,
       l.adresse,
       l.fokotany,
       l.acte_naissance,
       d.val AS direction,
       s.libelle AS service,
       s.code_dr,
       TO_CHAR(paie.matricule) AS matricule,
       paie.idcategorie,
       paie.ctg,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.statut,
       c.taux AS categorieval,
       '' AS ctgval,
       paie.numero_cnaps,
       paie.numero_ostie,
       CASE
           WHEN paie.temporaire = -1 THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire,
       CAST(NVL(sc.PLUS , 0) AS NUMBER(30, 2)) AS droit ,
       CAST(NVL(sp.CONGEPRIS , 0) AS NUMBER(30, 2)) AS prie,
       CAST(NVL(sc.SOLDE, 0) AS NUMBER(30, 2)) AS resteconge,
       paie.etat,
       l.id AS idpersonnel,
       l.direction AS iddirection
FROM log_personnel l
         LEFT JOIN log_service s ON l.service = s.id
         LEFT JOIN paie_info_personnel paie ON paie.id = l.id
         LEFT JOIN sexe sex ON l.sexe = sex.id
         LEFT JOIN log_direction d ON d.id = l.direction
         LEFT JOIN paie_categorie c ON c.id = paie.idcategorie
         LEFT JOIN SOLDECONGEPRIS_PERS sp ON l.id = sp.id
         LEFT JOIN SOLDECONGE_PERS sc ON l.id = sc.idPersonnel
;




CREATE OR REPLACE VIEW LOG_PERSONNEL_FIN_CONGE  AS
SELECT l.id,
       l.permis_conduire,
       l.chemin_permis,
       l.remarque,
       l.id_pers,
       l.nom,
       l.prenom,
       l.date_naissance,
       sex.desce AS sexe,
       l.numero_cin,
       l.date_cin,
       l.date_dupl_cin,
       l.nationalite,
       l.adresse,
       l.fokotany,
       l.acte_naissance,
       d.val AS direction,
       s.libelle AS service,
       s.code_dr,
       TO_CHAR(paie.matricule) AS matricule,
       paie.idcategorie,
       paie.ctg,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.statut,
       c.taux AS categorieval,
       '' AS ctgval,
       paie.numero_cnaps,
       paie.numero_ostie,
       CASE
           WHEN paie.temporaire = -1 THEN 'Temporaire'
           WHEN paie.temporaire = 0 THEN 'Permanent'
           WHEN paie.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS temporaire,
       CAST(NVL(sc.PLUS , 0) AS NUMBER(30, 2)) AS droit ,
       CAST(NVL(sp.CONGEPRIS , 0) AS NUMBER(30, 2)) AS prie,
       CAST(NVL(sc.SOLDE, 0) AS NUMBER(30, 2)) AS resteconge,
       paie.etat,
       l.id AS idpersonnel,
       l.direction AS iddirection
FROM log_personnel l
         LEFT JOIN log_service s ON l.service = s.id
         LEFT JOIN paie_info_personnel paie ON paie.id = l.id
         LEFT JOIN sexe sex ON l.sexe = sex.id
         LEFT JOIN log_direction d ON d.id = l.direction
         LEFT JOIN paie_categorie c ON c.id = paie.idcategorie
         LEFT JOIN SOLDECONGEPRIS_PERS sp ON l.id = sp.id
         LEFT JOIN SOLDECONGE_PERS sc ON l.id = sc.idPersonnel;


CREATE OR REPLACE VIEW LOG_PERSONNEL_FIN_VALIDE AS
SELECT lpf.id,
       lpf.permis_conduire,
       lpf.chemin_permis,
       lpf.remarque,
       lpf.id_pers,
       lpf.nom,
       lpf.prenom,
       lpf.date_naissance,
       lpf.sexe,
       lpf.numero_cin,
       lpf.date_cin,
       lpf.date_dupl_cin,
       lpf.nationalite,
       lpf.adresse,
       lpf.fokotany,
       lpf.acte_naissance,
       lpf.direction,
       lpf.service,
       lpf.code_dr,
       lpf.matricule,
       lpf.idcategorie,
       lpf.ctg,
       lpf.indicegrade,
       lpf.indice_fonctionnel,
       lpf.statut,
       lpf.categorieval,
       lpf.ctgval,
       lpf.numero_cnaps,
       lpf.numero_ostie,
       lpf.temporaire,
       lpf.droit,
       lpf.prie,
       lpf.resteconge,
       lpf.etat
FROM LOG_PERSONNEL_FIN_CONGE lpf
WHERE lpf.etat >= 11;



CREATE OR REPLACE VIEW LOG_PERSONNEL_FIN_A_VALIDER AS
SELECT lpf.id,
       lpf.permis_conduire,
       lpf.chemin_permis,
       lpf.remarque,
       lpf.id_pers,
       lpf.nom,
       lpf.prenom,
       lpf.date_naissance,
       lpf.sexe,
       lpf.numero_cin,
       lpf.date_cin,
       lpf.date_dupl_cin,
       lpf.nationalite,
       lpf.adresse,
       lpf.fokotany,
       lpf.acte_naissance,
       lpf.direction,
       lpf.service,
       lpf.code_dr,
       lpf.matricule,
       lpf.idcategorie,
       lpf.ctg,
       lpf.indicegrade,
       lpf.indice_fonctionnel,
       lpf.statut,
       lpf.categorieval,
       lpf.ctgval,
       lpf.numero_cnaps,
       lpf.numero_ostie,
       lpf.temporaire,
       lpf.droit,
       lpf.prie,
       lpf.resteconge,
       lpf.etat
FROM LOG_PERSONNEL_FIN_CONGE lpf
WHERE lpf.etat = 1;

CREATE OR REPLACE VIEW LOG_PERSONNE_NON_VALIDE_VUE AS
SELECT lpf.id,
       lpf.permis_conduire,
       lpf.chemin_permis,
       lpf.remarque,
       lpf.id_pers,
       lpf.nom,
       lpf.prenom,
       lpf.date_naissance,
       lpf.sexe,
       lpf.numero_cin,
       lpf.date_cin,
       lpf.date_dupl_cin,
       lpf.nationalite,
       lpf.adresse,
       lpf.fokotany,
       lpf.acte_naissance,
       lpf.direction,
       lpf.service,
       lpf.code_dr,
       lpf.matricule,
       lpf.idcategorie,
       lpf.ctg,
       lpf.indicegrade,
       lpf.indice_fonctionnel,
       lpf.statut,
       lpf.categorieval,
       lpf.ctgval,
       lpf.numero_cnaps,
       lpf.numero_ostie,
       lpf.temporaire,
       lpf.droit,
       lpf.prie,
       lpf.resteconge,
       lpf.etat
FROM LOG_PERSONNEL_FIN_CONGE lpf
WHERE lpf.etat < 1;


CREATE OR REPLACE VIEW PAIE_AVANCEMENT_LIBELLE2  AS
SELECT pav.id,
       dt.val AS motif,
       dt.id AS idmotif,
       (lp.nom || ' ') || lp.prenom AS id_logpers,
       lpad(pip.matricule, 5, '0') AS matricule,
       pip.id AS idpers,
       pav.datedecision,
       pav.refdecision,
       pav.date_application,
       ld.val AS direction,
       ls.code_service AS service,
       pf.val AS idfonction,
       pav.ctg,
       pg.val AS idcategorie,
       pav.echelon,
       pav.classee,
       pav.indicegrade,
       pav.indice_fonctionnel,
       CASE
           WHEN pip.temporaire = -1 THEN 'Temporaire'
           WHEN pip.temporaire = 0 THEN 'Permanent'
           WHEN pip.temporaire = 1 THEN 'Cadre'
           ELSE NULL
           END AS statut,
       pav.vehiculee,
       pav.remarque,
       lp.sexe,
       pav.etat,
       pav.matricule_patron,
       pav.droit_hs,
       pav.indice_ct,
       pav.code_banque,
       pf.desce AS fonctionLib
FROM paie_avancement pav
         LEFT JOIN dec_decision_type dt ON dt.id = pav.motif
         JOIN log_personnel lp ON lp.id = pav.id_logpers
         LEFT JOIN paie_info_personnel pip ON pip.id = pav.id_logpers
         LEFT JOIN log_direction ld ON ld.id = pav.direction
         LEFT JOIN log_service ls ON ls.id = pav.service
         LEFT JOIN paie_fonction pf ON pf.id = pav.idfonction
         LEFT JOIN paie_categorie pg ON pg.id = pav.idcategorie
;



CREATE OR REPLACE VIEW CONF_CNAPS  AS
SELECT
    ROUND(configuration.valmin * 1000, 2) AS plafond,
    NVL(configuration.daty, SYSDATE) AS daty
FROM configcnaps_plafond configuration
WHERE configuration.remarque = 'cnaps_plafond'
ORDER BY NVL(configuration.daty, SYSDATE);



CREATE OR REPLACE VIEW PAIE_EDITION_CNAPS AS
SELECT
    pe.idpersonnel,
    pe.mois,
    pe.annee,
    ROUND(SUM(pe.gain), 2) AS brut,
    NVL(edc.cnaps_travailleur, 0) AS cnaps_travailleur,
    CASE
        WHEN NVL(edc.cnaps_travailleur, 0) = 0 THEN 0
        ELSE
            CASE
                WHEN (
                         SELECT plafond
                         FROM conf_cnaps
                         WHERE conf_cnaps.daty >= pe.datefin
                           AND ROWNUM = 1
                     ) < (SUM(pe.gain) * 0.13) THEN (
                    SELECT plafond
                    FROM conf_cnaps
                    WHERE conf_cnaps.daty >= pe.datefin
                      AND ROWNUM = 1
                )
                ELSE ROUND(LEAST(NVL(edc.cnaps_travailleur, 0) * 13, SUM(pe.gain) * 0.13), 2)
                END
        END AS cnaps_employeur
FROM paie_edition pe
         JOIN paie_rubrique pr
              ON pe.idelementpaie = pr.id
                  AND pr.typerubrique = 'G'
                  AND pr.imposable = 'I'
         LEFT JOIN (
    SELECT
        pe_1.idpersonnel,
        pe_1.mois,
        pe_1.annee,
        pe_1.retenue AS cnaps_travailleur
    FROM paie_edition pe_1
    WHERE pe_1.idelementpaie = 'PR000101'
) edc
                   ON pe.idpersonnel = edc.idpersonnel
                       AND pe.mois = edc.mois
                       AND pe.annee = edc.annee
GROUP BY
    pe.idpersonnel, pe.mois, pe.annee, edc.cnaps_travailleur,  pe.datefin;



CREATE OR REPLACE VIEW CNAPS_T1 AS
SELECT
    pec.idpersonnel,
    pipl.matricule,
    pipl.nom AS personnel,
    pipl.numero_cnaps,
    pipl.direction,
    pec.annee,

    NVL(s1.brut, 0) AS mois1,
    NVL(s1.cnaps_travailleur, 0) AS cnaps_travailleur1,
    NVL(s1.cnaps_employeur, 0) AS cnaps_employeur1,

    NVL(s2.brut, 0) AS mois2,
    NVL(s2.cnaps_travailleur, 0) AS cnaps_travailleur2,
    NVL(s2.cnaps_employeur, 0) AS cnaps_employeur2,

    NVL(s3.brut, 0) AS mois3,
    NVL(s3.cnaps_travailleur, 0) AS cnaps_travailleur3,
    NVL(s3.cnaps_employeur, 0) AS cnaps_employeur3,

    (NVL(s1.cnaps_travailleur, 0) + NVL(s2.cnaps_travailleur, 0) + NVL(s3.cnaps_travailleur, 0)) AS cotisation_travailleur,
    (NVL(s1.cnaps_employeur, 0) + NVL(s2.cnaps_employeur, 0) + NVL(s3.cnaps_employeur, 0)) AS cotisation_employeur

FROM
    paie_edition_cnaps pec
        JOIN paie_info_personnel_libcomplet pipl
             ON TO_CHAR(pipl.id) = TO_CHAR(pec.idpersonnel)
                 AND pec.mois IN (1, 2, 3)

        LEFT JOIN (
        SELECT idpersonnel, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 1
    ) s1 ON TO_CHAR(pec.idpersonnel) = TO_CHAR(s1.idpersonnel) AND pec.annee = s1.annee

        LEFT JOIN (
        SELECT idpersonnel, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 2
    ) s2 ON TO_CHAR(pec.idpersonnel) = TO_CHAR(s2.idpersonnel) AND pec.annee = s2.annee

        LEFT JOIN (
        SELECT idpersonnel, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 3
    ) s3 ON TO_CHAR(pec.idpersonnel) = TO_CHAR(s3.idpersonnel) AND pec.annee = s3.annee

GROUP BY
    pec.idpersonnel, pipl.matricule, pipl.nom, pipl.numero_cnaps, pipl.direction, pec.annee,
    s1.brut, s1.cnaps_travailleur, s1.cnaps_employeur,
    s2.brut, s2.cnaps_travailleur, s2.cnaps_employeur,
    s3.brut, s3.cnaps_travailleur, s3.cnaps_employeur;




CREATE OR REPLACE VIEW CNAPS_T2 AS
SELECT
    pec.idpersonnel,
    pipl.matricule,
    pipl.nom AS personnel,
    pipl.numero_cnaps,
    pipl.direction,
    pec.annee,

    NVL(s1.brut, 0) AS mois1,
    NVL(s1.cnaps_travailleur, 0) AS cnaps_travailleur1,
    NVL(s1.cnaps_employeur, 0) AS cnaps_employeur1,

    NVL(s2.brut, 0) AS mois2,
    NVL(s2.cnaps_travailleur, 0) AS cnaps_travailleur2,
    NVL(s2.cnaps_employeur, 0) AS cnaps_employeur2,

    NVL(s3.brut, 0) AS mois3,
    NVL(s3.cnaps_travailleur, 0) AS cnaps_travailleur3,
    NVL(s3.cnaps_employeur, 0) AS cnaps_employeur3,

    ROUND(NVL(s1.cnaps_travailleur, 0) + NVL(s2.cnaps_travailleur, 0) + NVL(s3.cnaps_travailleur, 0), 2) AS cotisation_travailleur,
    ROUND(NVL(s1.cnaps_employeur, 0) + NVL(s2.cnaps_employeur, 0) + NVL(s3.cnaps_employeur, 0), 2) AS cotisation_employeur

FROM paie_edition_cnaps pec
         JOIN paie_info_personnel_libcomplet pipl
              ON pipl.id = pec.idpersonnel
                  AND pec.mois IN (4, 5, 6)

         LEFT JOIN (
    SELECT idpersonnel, mois, annee, brut, cnaps_travailleur, cnaps_employeur
    FROM paie_edition_cnaps
    WHERE mois = 4
) s1 ON pec.idpersonnel = s1.idpersonnel AND pec.annee = s1.annee

         LEFT JOIN (
    SELECT idpersonnel, mois, annee, brut, cnaps_travailleur, cnaps_employeur
    FROM paie_edition_cnaps
    WHERE mois = 5
) s2 ON pec.idpersonnel = s2.idpersonnel AND pec.annee = s2.annee

         LEFT JOIN (
    SELECT idpersonnel, mois, annee, brut, cnaps_travailleur, cnaps_employeur
    FROM paie_edition_cnaps
    WHERE mois = 6
) s3 ON pec.idpersonnel = s3.idpersonnel AND pec.annee = s3.annee

GROUP BY
    pec.idpersonnel, pipl.matricule, pipl.nom, pipl.numero_cnaps,
    pipl.direction, pec.annee,
    s1.brut, s1.cnaps_travailleur, s1.cnaps_employeur,
    s2.brut, s2.cnaps_travailleur, s2.cnaps_employeur,
    s3.brut, s3.cnaps_travailleur, s3.cnaps_employeur;



CREATE OR REPLACE VIEW CNAPS_T3 AS
SELECT
    pec.idpersonnel,
    pipl.matricule,
    pipl.nom AS personnel,
    pipl.numero_cnaps,
    pipl.direction,
    pec.annee,
    ROUND(NVL(s1.brut, 0), 2) AS mois1,
    ROUND(NVL(s1.cnaps_travailleur, 0), 2) AS cnaps_travailleur1,
    ROUND(NVL(s1.cnaps_employeur, 0), 2) AS cnaps_employeur1,
    ROUND(NVL(s2.brut, 0), 2) AS mois2,
    ROUND(NVL(s2.cnaps_travailleur, 0), 2) AS cnaps_travailleur2,
    ROUND(NVL(s2.cnaps_employeur, 0), 2) AS cnaps_employeur2,
    ROUND(NVL(s3.brut, 0), 2) AS mois3,
    ROUND(NVL(s3.cnaps_travailleur, 0), 2) AS cnaps_travailleur3,
    ROUND(NVL(s3.cnaps_employeur, 0), 2) AS cnaps_employeur3,
    ROUND(NVL(s1.cnaps_travailleur, 0) + NVL(s2.cnaps_travailleur, 0) + NVL(s3.cnaps_travailleur, 0), 2) AS cotisation_travailleur,
    ROUND(NVL(s1.cnaps_employeur, 0) + NVL(s2.cnaps_employeur, 0) + NVL(s3.cnaps_employeur, 0), 2) AS cotisation_employeur
FROM
    paie_edition_cnaps pec
        JOIN paie_info_personnel_libcomplet pipl ON pipl.id = pec.idpersonnel
        LEFT JOIN (
        SELECT idpersonnel, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 7
    ) s1 ON pec.idpersonnel = s1.idpersonnel AND pec.annee = s1.annee
        LEFT JOIN (
        SELECT idpersonnel, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 8
    ) s2 ON pec.idpersonnel = s2.idpersonnel AND pec.annee = s2.annee
        LEFT JOIN (
        SELECT idpersonnel, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 9
    ) s3 ON pec.idpersonnel = s3.idpersonnel AND pec.annee = s3.annee
WHERE
    pec.mois IN (7, 8, 9)
GROUP BY
    pec.idpersonnel,
    pipl.matricule,
    pipl.nom,
    pipl.numero_cnaps,
    pipl.direction,
    pec.annee,
    s1.brut, s1.cnaps_travailleur, s1.cnaps_employeur,
    s2.brut, s2.cnaps_travailleur, s2.cnaps_employeur,
    s3.brut, s3.cnaps_travailleur, s3.cnaps_employeur;



CREATE OR REPLACE VIEW CNAPS_T4 AS
SELECT
    pec.idpersonnel,
    pipl.matricule,
    pipl.nom AS personnel,
    pipl.numero_cnaps,
    pipl.direction,
    pec.annee,

    ROUND(NVL(s1.brut, 0), 2) AS mois1,
    ROUND(NVL(s1.cnaps_travailleur, 0), 2) AS cnaps_travailleur1,
    ROUND(NVL(s1.cnaps_employeur, 0), 2) AS cnaps_employeur1,

    ROUND(NVL(s2.brut, 0), 2) AS mois2,
    ROUND(NVL(s2.cnaps_travailleur, 0), 2) AS cnaps_travailleur2,
    ROUND(NVL(s2.cnaps_employeur, 0), 2) AS cnaps_employeur2,

    ROUND(NVL(s3.brut, 0), 2) AS mois3,
    ROUND(NVL(s3.cnaps_travailleur, 0), 2) AS cnaps_travailleur3,
    ROUND(NVL(s3.cnaps_employeur, 0), 2) AS cnaps_employeur3,

    ROUND(NVL(s1.cnaps_travailleur, 0) + NVL(s2.cnaps_travailleur, 0) + NVL(s3.cnaps_travailleur, 0), 2) AS cotisation_travailleur,
    ROUND(NVL(s1.cnaps_employeur, 0) + NVL(s2.cnaps_employeur, 0) + NVL(s3.cnaps_employeur, 0), 2) AS cotisation_employeur

FROM
    paie_edition_cnaps pec
        JOIN paie_info_personnel_libcomplet pipl
             ON pipl.id = pec.idpersonnel
                 AND pec.mois IN (10, 11, 12)

        LEFT JOIN (
        SELECT
            idpersonnel, mois, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 10
    ) s1 ON pec.idpersonnel = s1.idpersonnel AND pec.annee = s1.annee

        LEFT JOIN (
        SELECT
            idpersonnel, mois, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 11
    ) s2 ON pec.idpersonnel = s2.idpersonnel AND pec.annee = s2.annee

        LEFT JOIN (
        SELECT
            idpersonnel, mois, annee, brut, cnaps_travailleur, cnaps_employeur
        FROM paie_edition_cnaps
        WHERE mois = 12
    ) s3 ON pec.idpersonnel = s3.idpersonnel AND pec.annee = s3.annee;




-- getSeqPaie_avancement
-- seqpaie_avancement
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqpaie_avancement';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqpaie_avancement
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getSeqPaie_avancement
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqpaie_avancement.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQPOSTE
-- seqposte
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqposte';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqposte
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQPOSTE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqposte.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- getSeqPaie_prs_eltpaie
-- SeqPaie_prs_eltpaie
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SeqPaie_prs_eltpaie';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SeqPaie_prs_eltpaie
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getSeqPaie_prs_eltpaie
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SeqPaie_prs_eltpaie.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- #########################
-- GET_SEQ_PAIE_FONCTION
-- seq_Paie_fonction
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_Paie_fonction';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_Paie_fonction
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_PAIE_FONCTION
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_Paie_fonction.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_LOGPERSONNEL
-- SEQ_LOGPERSONNEL
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SEQ_LOGPERSONNEL';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SEQ_LOGPERSONNEL
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_LOGPERSONNEL
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SEQ_LOGPERSONNEL.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- getseq_traitementpaie
-- SEQ_TRAITEMENTPAIE
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SEQ_TRAITEMENTPAIE';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SEQ_TRAITEMENTPAIE
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getseq_traitementpaie
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SEQ_TRAITEMENTPAIE.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- get_seq_categorie_qualif
-- seq_categorie_qualif
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_categorie_qualif';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_categorie_qualif
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION get_seq_categorie_qualif
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_categorie_qualif.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETavancement
-- SEQavancement
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SEQavancement';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SEQavancement
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETavancement
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SEQavancement.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- getseqpaieedition
-- seqpaieedition
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqpaieedition';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqpaieedition
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getseqpaieedition
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqpaieedition.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETSEQLOGPERSONNELNONVALIDE
-- seqlogpersonnelnonvalide
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqlogpersonnelnonvalide';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqlogpersonnelnonvalide
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETSEQLOGPERSONNELNONVALIDE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqlogpersonnelnonvalide.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_SANCTION
-- seq_Sanction
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_Sanction';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_Sanction
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_SANCTION
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_Sanction.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_REMBOURSEMENT
-- seq_Remboursement
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_Remboursement';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_Remboursement
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_REMBOURSEMENT
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_Remboursement.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;




-- GET_SEQ_AVANCE
-- seq_avance
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_avance';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_avance
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_AVANCE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_avance.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- seq_type_contrat
-- GET_SEQ_TYPE_CONTRAT
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_type_contrat';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_type_contrat
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_TYPE_CONTRAT
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_type_contrat.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_TYPEABSENCE
-- seq_typeabsence
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_typeabsence';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_typeabsence
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_TYPEABSENCE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_typeabsence.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_DEMANDE
-- seq_demande
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_demande';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

CREATE OR REPLACE FUNCTION GET_SEQ_DEMANDE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_demande.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQPOSTE
-- seqposte
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqposte';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqposte
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQPOSTE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqposte.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETSEQMODEPAIEMENT
-- seqmodepaiement
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqmodepaiement';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqmodepaiement
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETSEQMODEPAIEMENT
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqmodepaiement.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_POINTAGE
-- seq_POINTAGE
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_POINTAGE';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_POINTAGE
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_POINTAGE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_POINTAGE.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- get_seq_Paie_fonction
-- seq_Paie_fonction
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_Paie_fonction';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_Paie_fonction
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION get_seq_Paie_fonction
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_Paie_fonction.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- getseqPaie_rubrique
-- SeqPaie_rubrique
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SeqPaie_rubrique';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SeqPaie_rubrique
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getseqPaie_rubrique
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SeqPaie_rubrique.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- getSeqPaie_prs_eltpaie
-- SeqPaie_prs_eltpaie
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SeqPaie_prs_eltpaie';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SeqPaie_prs_eltpaie
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getSeqPaie_prs_eltpaie
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SeqPaie_prs_eltpaie.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETSEQFORMATIONDIPLOME
-- seqformation_diplome
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqformation_diplome';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqformation_diplome
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETSEQFORMATIONDIPLOME
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqformation_diplome.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETSEQPAIE_GROUPEFONCTION
-- seqpaie_groupefonction
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqpaie_groupefonction';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqpaie_groupefonction
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETSEQPAIE_GROUPEFONCTION
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqpaie_groupefonction.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETSEQLOGSERVICE
-- seq_logservice
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seq_logservice';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seq_logservice
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETSEQLOGSERVICE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seq_logservice.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQ_MVTABSENCE
-- SEQ_MVTABSENCE
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SEQ_MVTABSENCE';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SEQ_MVTABSENCE
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQ_MVTABSENCE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SEQ_MVTABSENCE.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GET_SEQRUBRIQUEMANUEL
-- seqrubriquemanuel
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqrubriquemanuel';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqrubriquemanuel
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GET_SEQRUBRIQUEMANUEL
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqrubriquemanuel.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- getseqpaieeditionmoisannee
-- seqpaieeditionmoisannee
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE seqpaieeditionmoisannee';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence seqpaieeditionmoisannee
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION getseqpaieeditionmoisannee
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT seqpaieeditionmoisannee.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;


-- GETSEQ_TRAITEMENTPAIE
-- SEQ_TRAITEMENTPAIE
BEGIN
EXECUTE IMMEDIATE 'DROP SEQUENCE SEQ_TRAITEMENTPAIE';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -2289 THEN RAISE; END IF;
END;

create sequence SEQ_TRAITEMENTPAIE
    minvalue 1
    maxvalue 999999999999
    start with 1
    increment by 1
    cache 20;

CREATE OR REPLACE FUNCTION GETSEQ_TRAITEMENTPAIE
   RETURN NUMBER
IS
   retour   NUMBER;
BEGIN
SELECT SEQ_TRAITEMENTPAIE.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;



CREATE OR REPLACE VIEW UTILISATEUR_ACTIONROLE AS
SELECT
    u.refuser AS id,
    u.LOGINUSER,
    u.PWDUSER,
    u.NOMUSER,
    d.LIBELLEDIR AS adruser,
    u.TELUSER,
    u.IDROLE,
    r.RANG
FROM utilisateur u
         JOIN direction d ON u.ADRUSER = d.IDDIR
         LEFT JOIN roles r ON r.IDROLE = u.IDROLE;



CREATE OR REPLACE VIEW UTILISATEURCPL  AS
SELECT
    u.REFUSER,
    u.IDROLE,
    u.ADRUSER,
    u.NOMUSER,
    u.LOGINUSER,
    u.PWDUSER,
    u.TELUSER,
    dir.DESCDIR AS directionLib,
    log.id AS idPersonnel,
    log.nom || ' ' || log.prenom AS nomPersonnel
FROM UTILISATEUR u
         LEFT JOIN direction dir ON dir.iddir = u.ADRUSER
         JOIN LOG_PERSONNEL log ON log.refuser = u.REFUSER
;


CREATE OR REPLACE VIEW UTILISATEURROLE AS
select u.refuser,u.LOGINUSER,u.PWDUSER,u.NOMUSER,d.ID as adruser,u.TELUSER,u.IDROLE,
       s.ID, r.rang
from utilisateur u, log_direction d, roles r, log_service s, log_personnel p, annulationutilisateur a
where u.TELUSER = p.ID
  and p.DIRECTION = d.id
  and p.SERVICE = s.id
  and u.IDROLE = r.IDROLE and
    u.refuser = a.REFUSER(+) and a.REFUSER is null;


CREATE OR REPLACE VIEW UTILISATEURVALIDE AS
SELECT u.REFUSER, u.LOGINUSER, u.PWDUSER, u.NOMUSER, u.ADRUSER, u.TELUSER,
       u.IDROLE,r.RANG
FROM utilisateur u ,ROLES r , annulationutilisateur a
WHERE u.IDROLE = r.IDROLE and
    u.refuser = a.REFUSER(+) and a.REFUSER is null;


CREATE OR REPLACE VIEW UTILISATEURVUE AS
SELECT
    u.refuser,
    u.LOGINUSER,
    u.PWDUSER,
    u.NOMUSER,
    d.LIBELLEDIR AS adruser,
    u.TELUSER,
    u.IDROLE,
    r.RANG
FROM utilisateur u
         JOIN direction d ON u.ADRUSER = d.IDDIR
         LEFT JOIN roles r ON r.IDROLE = u.IDROLE
;


CREATE OR REPLACE VIEW UTILISATEURVUEFICHE_ID AS
SELECT u.refuser AS refuser,
       u.loginuser,
       u.pwduser,
       u.nomuser,
       d.DESCDIR AS adruser,
       u.teluser,
       u.idrole
FROM utilisateur u,
     direction d
WHERE u.adruser = d.IDDIR;


CREATE OR REPLACE VIEW UTILISATEUR_ACTIONROLE AS
SELECT
    u.refuser AS id,
    u.LOGINUSER,
    u.PWDUSER,
    u.NOMUSER,
    d.LIBELLEDIR AS adruser,
    u.TELUSER,
    u.IDROLE,
    r.RANG
FROM utilisateur u
         JOIN direction d ON u.ADRUSER = d.IDDIR
         LEFT JOIN roles r ON r.IDROLE = u.IDROLE;


/* =================================================================== */



INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000010','GRH et Paie','fa fa-group','',9,1,'');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000633','Gestion du personnel','fa fa-street-view','',1,2,'ELM000010');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM00063377','Sanction','fa fa-list-alt','',5,3,'ELM000633');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM0006587','Saisie sanction','fa fa-plus','module.jsp?but=paie/employe/sanction/sanction-saisie.jsp',1,4,'ELM00063377');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM00065877','Liste sanction','fa fa-list','module.jsp?but=paie/employe/sanction/sanction-liste.jsp',1,4,'ELM00063377');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000650','Liste employés','fa fa-list-alt','module.jsp?but=paie/employe/infopersonnel-liste.jsp',3,3,'ELM000633');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000651','Embauche','fa fa-plus','module.jsp?but=paie/employe/infopersonnel-saisie.jsp',1,3,'ELM000633');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000652','Départ','fa fa-minus','',2,3,'ELM000633');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000658','Saisie départ','fa fa-plus','module.jsp?but=paie/employe/personnelnonvalide-saisie.jsp',1,4,'ELM000652');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000659','Liste Non Valide','fa fa-list-alt','module.jsp?but=paie/employe/personnelnonvalide-liste.jsp',2,4,'ELM000652');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM0006534','Mouvement','fa fa-line-chart','',4,3,'ELM000633');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000668','Liste','fa fa-list-alt','module.jsp?but=paie/avancement/avancement-liste.jsp',1,4,'ELM0006534');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('ELM000669','Saisie ','fa fa-plus','module.jsp?but=paie/avancement/avancement-saisie.jsp',1,4,'ELM0006534');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('JUIN002','Gestion des absences','fa fa-cc-mastercard','',3,2,'ELM000010');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('JUIK003','Saisie','fa fa-plus','module.jsp?but=paie/demande/mademande.jsp',12,3,'JUIN002');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('JUIN003','Saisie','fa fa-plus','module.jsp?but=paie/demande/demande-absence-saisie.jsp',12,4,'JUIN002');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('JUIN004','Liste','fa fa-list','module.jsp?but=paie/demande/demande-absence-liste.jsp',11,3,'JUIN002');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000001_2','Solde congé Droit','fa fa-list','module.jsp?but=paie/conge/solde-conge.jsp',1,3,'JUIN002');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003004','Configurations','fa fa-cog','',6,2,'ELM000010');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MC0000001','Modif nb enfant','fa fa-list-alt','module.jsp?but=paie/employe/infopersonnel-modif-multiple.jsp',3,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003001','Type contrat','fa fa-list','module.jsp?but=paie/configuration/idvaldesce.jsp&ciblename=type_contrat',1,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003001V','CNAPS','fa fa-list','module.jsp?but=paie/cnaps/cnaps_affiche.jsp',2,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003002','Fonction','fa fa-home','',4,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000030012','Saisie','fa fa-plus','module.jsp?but=paie/fonction/paiefonction-saisie.jsp',1,4,'MD00000003002');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000030013','Liste','fa fa-list','module.jsp?but=paie/fonction/paiefonction-liste.jsp',2,4,'MD00000003002');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003003','Paie rubrique liste','fa fa-plus','module.jsp?but=paie/rubrique/paierubrique-liste.jsp',5,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003007','Saisie','fa fa-plus','module.jsp?but=paie/rubrique/socobisrubrique-saisie.jsp',1,5,'MD00000003003');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003008','Liste','fa fa-list','module.jsp?but=paie/rubrique/socobisrubrique-liste.jsp',2,5,'MD00000003003');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000003009','Element paie','fa fa-home','',8,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000030010','Saisie','fa fa-plus','module.jsp?but=paie/fonction/paiepersonnelelementpaie-saisie.jsp',1,4,'MD00000003009');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000030011','Liste','fa fa-list','module.jsp?but=paie/fonction/paiepersonnelelementpaie-liste.jsp',2,4,'MD00000003009');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD0000000300112','Visa Mutliple','fa fa-list','module.jsp?but=paie/fonction/paiepersonnelelementpaie-listemu.jsp',2,4,'MD00000003009');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000004001','Poste','fa fa-home','module.jsp?but=paie/configuration/idvaldesce.jsp&ciblename=poste',9,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040010','Groupe fonction','fa fa-home','module.jsp?but=paie/configuration/idvaldesce.jsp&ciblename=paie_groupefonction',13,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000004002','Formation diplome','fa fa-home','module.jsp?but=paie/configuration/idvaldesce.jsp&ciblename=formation_diplome',10,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040021','Mode de paiement','fa fa-home','module.jsp?but=paie/configuration/idvaldesce.jsp&ciblename=modepaiement',11,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040022','Categorie qualification','fa fa-home','',14,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040023','Saisie','fa fa-plus','module.jsp?but=paie/categorie/categoriequalification-saisie.jsp',1,4,'MD000000040022');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040024','Liste','fa fa-list','module.jsp?but=paie/categorie/categoriequalification-liste.jsp',1,4,'MD000000040022');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040025','Categorie paie','fa fa-home','',15,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040026','Saisie','fa fa-plus','module.jsp?but=paie/categorie/categoriepaie-saisie.jsp',1,4,'MD000000040025');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040027','Liste','fa fa-list','module.jsp?but=paie/categorie/categoriepaie-liste.jsp',2,4,'MD000000040025');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040025V','Contrat Travail','fa fa-home','module.jsp?but=paie/contrat/contrat_travail.jsp',16,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040025V2','Avenant Salaire','fa fa-home','module.jsp?but=paie/contrat/contrat_travail_avenant.jsp',18,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000007007','Rattachement','fa fa-home','',17,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD0000000400211','Saisie','fa fa-plus','module.jsp?but=paie/service/service-saisie.jsp',1,4,'MD00000007007');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD0000000400212','Liste','fa fa-list','module.jsp?but=paie/service/service-liste.jsp',2,4,'MD00000007007');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000993003','Saisie Paie rubrique','fa fa-plus','module.jsp?but=paie/rubrique/paierubrique-saisie.jsp',6,3,'MD00000003004');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040030','Gestion de la paie','fa fa-street-view','',2,2,'ELM000010');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('AMS006','Avance','fa fa-table','',3,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('AMS007','Saisie','fa fa-plus','module.jsp?but=paie/avance/avance-saisie.jsp',1,4,'AMS006');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('AMS008','Liste','fa fa-list','module.jsp?but=paie/avance/avance-liste.jsp',2,4,'AMS006');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('AMS009','Remboursement','fa fa-list','module.jsp?but=paie/avance/remboursement-liste.jsp',3,4,'AMS006');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD00000000101','Analyse','fa fa-table','',3,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN00120','Graphe salaire','fa fa-line-chart','module.jsp?but=paie/editions/graphe-salaire.jsp',3,4,'MD00000000101');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN002','Analyse paie édition','fa fa-list','module.jsp?but=paie/editions/socobisedition-analyse2.jsp',2,4,'MD00000000101');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN003','Analyse édition','fa fa-list','module.jsp?but=paie/editions/socobisedition-analyse3.jsp',1,4,'MD00000000101');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040031','Edition Mois Année','fa fa-street-view','module.jsp?but=paie/editionmoisannee/editionmoisannee-liste.jsp',1,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040032','Générer Salaire','fa fa-street-view','module.jsp?but=paie/editionmoisannee/salaire-saisie.jsp',2,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040032Z_01','Récapitulatif Salaire','fa fa-street-view','module.jsp?but=paie/editions/recapsalaire.jsp',4,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040032Z_02','Etat Irsa ','fa fa-street-view','module.jsp?but=paie/editions/etatirsa.jsp',7,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040032Z_03','Etat Ostie ','fa fa-street-view','module.jsp?but=paie/ostie/ostieaffiche.jsp',8,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000000040032Z_04','Etat Cnaps','fa fa-street-view','module.jsp?but=paie/cnaps/cnaps_affiche.jsp',9,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN001','Paie édition','fa fa-list','module.jsp?but=paie/editions/paieedition-liste.jsp',6,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN0010','Liste contrat','fa fa-list','module.jsp?but=paie/contrat/contrat-liste.jsp',10,3,'MD000000040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MD000020040030','Gestion Pointage','fa fa-street-view','',5,2,'ELM000010');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN00001','Saisie Pointage','fa fa-plus','module.jsp?but=paie/pointage/pointage-saisie.jsp',1,3,'MD000020040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN00891','Liste Pointage','fa fa-list-alt','module.jsp?but=paie/pointage/pointage-liste.jsp',2,3,'MD000020040030');
INSERT INTO menudynamique (id, libelle, icone, href, rang, niveau, id_pere) VALUES ('MENDYN00981','Visa Pointage','fa fa-plus','module.jsp?but=paie/pointage/pointage-visa.jsp',3,3,'MD000020040030');


INSERT INTO usermenu
(id, refuser, idmenu, idrole, codeservice, codedir, interdit)
VALUES('USRM007', '*', 'ELM000010', 'dg', NULL, NULL, NULL);


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB AS
SELECT lpnv.id,
       (lp.nom || ' ') || lp.prenom AS idlogpers,
       lp.sexe,
       lpnv.dateapplication,
       td.val AS idtypedebauche,
       lpnv.etat,
       lpnv.iduser,
       pif.matricule,
       lpnv.date_decision,
       lpnv.refdecision,
       CASE
           WHEN lpnv.ETAT = 1 THEN 'CREE'
           WHEN lpnv.ETAT = 11 THEN 'VALIDEE'
           WHEN lpnv.ETAT = 0 THEN 'ANNULEE'
           END AS etatLib
FROM log_personnel_non_valide lpnv
         LEFT JOIN type_depart td ON td.id = lpnv.idtypedebauche
         LEFT JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
         LEFT JOIN log_personnel lp ON pif.id = lp.id
WHERE lpnv.date_reintegration IS NULL;



CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_3 AS
SELECT lpnv.id,
       lp.id AS idlogpers,
       lpnv.dateapplication,
       lpnv.date_decision,
       lpnv.idtypedebauche,
       ddt.val AS typedebauche,
       lpnv.refdecision,
       lpnv.idavancement,
       lpnv.motif,
       lp.sexe,
       lpnv.etat,
       lpnv.idlogpers AS personnelid,
       pif.matricule
FROM log_personnel_non_valide lpnv
         JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
         JOIN log_personnel lp ON lpnv.idlogpers = lp.id
         JOIN dec_decision_type ddt ON ddt.id = lpnv.idtypedebauche
WHERE lpnv.date_reintegration IS NULL;


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_4 AS
SELECT lpnv.id,
       lp.id AS idlogpers,
       lpnv.dateapplication,
       lpnv.date_decision,
       lpnv.idtypedebauche,
       ddt.val AS typedebauche,
       lpnv.refdecision,
       lpnv.idavancement,
       lpnv.motif,
       lp.sexe,
       lpnv.etat,
       (lp.nom || ' ') || lp.prenom AS personnelid,
       pif.matricule
FROM log_personnel_non_valide lpnv
         JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
         JOIN log_personnel lp ON lpnv.idlogpers = lp.id
         JOIN type_depart ddt ON ddt.id = lpnv.idtypedebauche
WHERE lpnv.date_reintegration IS NULL;


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_5 AS
SELECT lpnv.id,
       lp.id AS idlogpers,
       lpnv.dateapplication,
       lpnv.date_decision,
       lpnv.idtypedebauche,
       ddt.val AS typedebauche,
       lpnv.refdecision,
       lpnv.idavancement,
       lpnv.motif,
       lp.sexe,
       lpnv.etat,
       (lp.nom || ' ') || lp.prenom AS personnelid,
       (lp2.nom || ' ') || lp2.prenom AS passationib,
       pif.matricule,
       lpnv.idpassation
FROM log_personnel_non_valide lpnv
         JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
         JOIN log_personnel lp ON lpnv.idlogpers = lp.id
         LEFT JOIN log_personnel lp2 ON lpnv.idpassation = lp2.id
         JOIN type_depart ddt ON ddt.id = lpnv.idtypedebauche
WHERE lpnv.date_reintegration IS NULL;


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_5_TEST AS
  (
SELECT lpnv.id,
    lp.id AS idlogpers,
    lpnv.dateapplication,
    lpnv.date_decision,
    lpnv.idtypedebauche,
    ddt.val AS typedebauche,
    lpnv.refdecision,
    lpnv.idavancement,
    lpnv.motif,
    lp.sexe,
    lpnv.etat,
    (lp.nom || ' ') || lp.prenom AS personnelid,
    (lp2.nom || ' ') || lp2.prenom AS passationib,
    pif.matricule,
    lpnv.idpassation
   FROM log_personnel_non_valide lpnv
     LEFT JOIN paie_info_personnel pif ON pif.id = lpnv.idlogpers
     LEFT JOIN log_personnel lp ON lpnv.idlogpers = lp.id
     LEFT JOIN log_personnel lp2 ON lpnv.idpassation = lp2.id
     LEFT JOIN type_depart ddt ON ddt.id = lpnv.idtypedebauche
);


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_CREE AS
SELECT log_pers_non_valide_lib.id,
       log_pers_non_valide_lib.idlogpers,
       log_pers_non_valide_lib.sexe,
       log_pers_non_valide_lib.dateapplication,
       log_pers_non_valide_lib.idtypedebauche,
       log_pers_non_valide_lib.etat,
       log_pers_non_valide_lib.iduser,
       log_pers_non_valide_lib.matricule,
       log_pers_non_valide_lib.date_decision,
       log_pers_non_valide_lib.refdecision
FROM log_pers_non_valide_lib
WHERE log_pers_non_valide_lib.etat = 1;

CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_STC AS
SELECT log_pers_non_valide_lib.id,
       log_pers_non_valide_lib.idlogpers,
       log_pers_non_valide_lib.sexe,
       log_pers_non_valide_lib.dateapplication,
       log_pers_non_valide_lib.idtypedebauche,
       log_pers_non_valide_lib.etat,
       log_pers_non_valide_lib.iduser,
       log_pers_non_valide_lib.matricule,
       log_pers_non_valide_lib.date_decision,
       log_pers_non_valide_lib.refdecision
FROM log_pers_non_valide_lib
WHERE log_pers_non_valide_lib.etat = 24;


CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_TOUS AS
SELECT log_pers_non_valide_lib.id,
       log_pers_non_valide_lib.idlogpers,
       log_pers_non_valide_lib.sexe,
       log_pers_non_valide_lib.dateapplication,
       log_pers_non_valide_lib.idtypedebauche,
       log_pers_non_valide_lib.etat,
       log_pers_non_valide_lib.iduser,
       log_pers_non_valide_lib.matricule,
       log_pers_non_valide_lib.date_decision,
       log_pers_non_valide_lib.refdecision
FROM log_pers_non_valide_lib;

CREATE OR REPLACE VIEW LOG_PERS_NON_VALIDE_LIB_VISE AS
SELECT log_pers_non_valide_lib.id,
       log_pers_non_valide_lib.idlogpers,
       log_pers_non_valide_lib.sexe,
       log_pers_non_valide_lib.dateapplication,
       log_pers_non_valide_lib.idtypedebauche,
       log_pers_non_valide_lib.etat,
       log_pers_non_valide_lib.iduser,
       log_pers_non_valide_lib.matricule,
       log_pers_non_valide_lib.date_decision,
       log_pers_non_valide_lib.refdecision
FROM log_pers_non_valide_lib
WHERE log_pers_non_valide_lib.etat = 11;



CREATE OR REPLACE VIEW VUE_CONTRAT_LIB AS
SELECT
    lpf.idpersonnel AS id,
    lpf.matricule,
    lpf.nom,
    lpf.prenom,
    lpf.sexe,
    pip.dateembauche,
    pip.indesirable AS periode,
    CASE
        WHEN pip.indesirable > 0 THEN pip.dateembauche + INTERVAL '1' MONTH * pip.indesirable
        ELSE NULL
        END AS date_fin_contrat,
    lpf.etat,
    tc.val AS type_contrat
FROM
    log_personnel_fin lpf
        JOIN paie_info_personnel pip ON pip.id = lpf.idpersonnel
        JOIN type_contrat tc ON tc.id = pip.typecontrat;


CREATE OR REPLACE VIEW DROITCONGE_PERS AS
SELECT
    sp.IDPERSONNEL AS id ,
    CAST(sp.PLUS AS NUMBER(30, 2)) AS droit,
    sp.NOM || ' ' || sp.PRENOM AS nomPersonnel,
    log.matricule ,
    log.iddirection
FROM SOLDECONGE_PERS sp
         LEFT JOIN LOG_PERSONNEL_V2 log ON log.id = sp.IDPERSONNEL
;




CREATE OR REPLACE VIEW RETRAIT_FRAIS_MEDICAUX_ANALYSE AS
SELECT
    ld.id AS direction,
    ld.val AS directionlib,
    pe.mois,
    pe.annee,
    CASE
        WHEN pe.mois = 13 THEN TO_DATE('01-12-' || pe.annee, 'DD-MM-YYYY')
        ELSE TO_DATE('01-' || LPAD(pe.mois, 2, '0') || '-' || pe.annee, 'DD-MM-YYYY')
        END AS dateval,
    pe.annee || '-' || LPAD(pe.mois, 2, '0') AS datedesc,
    CASE
        WHEN pe.mois = 1 THEN 'Janvier'
        WHEN pe.mois = 2 THEN 'Fevrier'
        WHEN pe.mois = 3 THEN 'Mars'
        WHEN pe.mois = 4 THEN 'Avril'
        WHEN pe.mois = 5 THEN 'Mai'
        WHEN pe.mois = 6 THEN 'Juin'
        WHEN pe.mois = 7 THEN 'Juillet'
        WHEN pe.mois = 8 THEN 'Aout'
        WHEN pe.mois = 9 THEN 'Septembre'
        WHEN pe.mois = 10 THEN 'Octobre'
        WHEN pe.mois = 11 THEN 'Novembre'
        WHEN pe.mois = 12 THEN 'Decembre'
        WHEN pe.mois = 13 THEN '13 eme'
        ELSE NULL
        END || '-' || pe.annee AS datelib,
    SUM(pe.gain) AS gain,
    NVL(SUM(rf.montant), 0) AS depense
FROM paie_edition pe
         LEFT JOIN paie_info_personnel_libcomplet pf ON pf.id = pe.idpersonnel
         LEFT JOIN log_direction ld ON ld.id = pf.direction
         LEFT JOIN retrait_frais_medicaux rf
                   ON pe.mois = EXTRACT(MONTH FROM rf.daty)
                       AND pe.annee = EXTRACT(YEAR FROM rf.daty)
                       AND rf.etat >= 11
WHERE pe.idelementpaie NOT LIKE '%PR000FRM%'
GROUP BY
    pe.mois,
    pe.annee,
    ld.id,
    ld.val;

CREATE OR REPLACE VIEW RETRAIT_FRAIS_MEDICAUX_LIB AS
SELECT rfm.id,
       rfm.daty,
       pipl.id AS idpersonnel,
       rfm.description,
       rfm.montant,
       rfm.etat,
       (pipl.nom || ' ') || pipl.prenom AS idpersonnellib,
       CASE
           WHEN rfm.etat = 1 THEN 'CREE(E)'
           WHEN rfm.etat = 10 THEN 'VALIDE(E)'
           WHEN rfm.etat >= 11 THEN 'VISE(E)'
           ELSE NULL
           END AS etatlib,
       pipl.matricule
FROM retrait_frais_medicaux rfm
         LEFT JOIN paie_info_personnel_libcomplet pipl ON rfm.idpersonnel = pipl.id;

CREATE OR REPLACE VIEW RETRAIT_FRAIS_MEDIC_GRPPERS AS
SELECT sum(retrait_frais_medicaux.montant) AS montant,
       retrait_frais_medicaux.idpersonnel
FROM retrait_frais_medicaux
WHERE retrait_frais_medicaux.etat >= 9
GROUP BY retrait_frais_medicaux.idpersonnel;


CREATE OR REPLACE VIEW PAIE_EDITION_GRP_PERSONNE2 AS
SELECT (grp2.gain + sfrm.montant) AS gain,
       grp2.idpersonnel
FROM ( SELECT CAST(sum(paie_edition.gain) AS NUMBER(15,2)) AS gain,
              paie_edition.idpersonnel
       FROM paie_edition
       WHERE paie_edition.idelementpaie NOT LIKE  '%PR000FRM%' AND paie_edition.annee > 2023
       GROUP BY paie_edition.idpersonnel) grp2
         LEFT JOIN solde_frm_2023 sfrm ON grp2.idpersonnel = sfrm.idpersonnel;

CREATE OR REPLACE VIEW PERSONNE_GAIN_SORTIE_RESTE AS
SELECT pip.id,
       pip.datesaisie,
       pip.matricule,
       pip.lieu_naissance_commune,
       pip.lieu_delivrance_cin,
       pip.situation_matrimonial,
       pip.initiale,
       pip.cturgence_nom_prenom,
       pip.cturgence_telephone1,
       pip.cturgence_telephone2,
       pip.cturgence_telephone3,
       pip.idconjoint,
       pip.code_agence_banque,
       pip.banque_numero_compte,
       pip.banque_compte_cle,
       pip.dateembauche,
       pip.idfonction,
       pip.idcategorie,
       pip.mode_paiement,
       pip.classee,
       pip.indicegrade,
       pip.indice_fonctionnel,
       pip.matricule_patron,
       pip.statut,
       pip.droit_hs,
       pip.vehiculee,
       pip.echelon,
       pip.etat,
       pip.ctg,
       pip.iduser,
       pip.indice_ct,
       pip.datepromotion,
       pip.numero_cnaps,
       pip.numero_ostie,
       pip.temporaire,
       pip.n_embauche,
       pip.date_depart,
       pip.n_depart,
       pip.nbenfant,
       pip.heurejournalier,
       pip.heurehebdomadaire,
       pip.heuremensuel,
       pip.indesirable,
       pip.duree,
       pip.telephone,
       pip.mail,
       pip.adresse_ligne1,
       pip.adresse_ligne2,
       pip.code_postal,
       pip.region,
       pip.idcategorie_paie,
       pip.idqualification,
       pip.formation,
       pip.discipline,
       pip.anneeexperience,
       pip.personnel_etat,
       pip.periode_essai,
       pip.permis_conduire,
       pip.chemin_permis,
       pip.remarque,
       pip.id_pers,
       pip.nom,
       pip.prenom,
       pip.date_naissance,
       pip.sexe,
       pip.numero_cin,
       pip.date_cin,
       pip.date_dupl_cin,
       pip.nationalite,
       pip.adresse,
       pip.fokotany,
       pip.acte_naissance,
       pip.direction,
       pip.service,
       COALESCE(pep.gain, 0) AS gain,
       COALESCE(pe.montant, 0) AS montant,
       COALESCE(pep.gain, 0) - COALESCE(pe.montant, 0) AS reste
FROM paie_info_personnel_libcomplet pip
         LEFT JOIN paie_edition_grp_personne2 pep ON pip.id = pep.idpersonnel
         LEFT JOIN retrait_frais_medic_grppers pe ON pe.idpersonnel = pip.id;

CREATE OR REPLACE VIEW RETRAIT_FRAIS_MEDICAUX_RESTE AS
SELECT rfm.id,
       rfm.daty,
       rfm.idpersonnel,
       rfm.description,
       rfm.montant,
       rfm.etat,
       p.reste
FROM retrait_frais_medicaux rfm
         LEFT JOIN personne_gain_sortie_reste p ON rfm.idpersonnel = p.id;


CREATE OR REPLACE VIEW RETRAIT_FRAIS_MEDICAUX_RESTE AS
SELECT rfm.id,
       rfm.daty,
       rfm.idpersonnel,
       rfm.description,
       rfm.montant,
       rfm.etat,
       p.reste
FROM retrait_frais_medicaux rfm
         LEFT JOIN personne_gain_sortie_reste p ON rfm.idpersonnel = p.id;


CREATE OR REPLACE VIEW LOG_PERSONNEL_V_FRAIS_MEDICAUX  AS
SELECT lp.id,
       lp.permis_conduire,
       lp.chemin_permis,
       lp.remarque,
       lp.id_pers,
       lp.nom,
       lp.prenom,
       lp.date_naissance,
       lp.sexe,
       lp.numero_cin,
       lp.date_cin,
       lp.date_dupl_cin,
       lp.nationalite,
       lp.adresse,
       lp.fokotany,
       lp.acte_naissance,
       lp.direction,
       lp.service,
       lp.code_dr,
       lp.matricule,
       lp.idcategorie,
       lp.ctg,
       lp.indicegrade,
       lp.indice_fonctionnel,
       lp.statut,
       lp.categorieval,
       lp.ctgval,
       lp.numero_cnaps,
       lp.numero_ostie,
       lp.temporaire,
       lp.resteconge,
       COALESCE(p.reste, 0) AS reste_frais_medicaux
FROM log_personnel_v lp
         LEFT JOIN personne_gain_sortie_reste p ON lp.id = p.id;

CREATE OR REPLACE VIEW SANCTION_CPL AS
SELECT
    s.id,
    s.IDPERSONNE,
    lpr.nom || ' ' || lpr.prenom AS nomPersonnel,
    s.datedebut,
    s.daty,
    s.duree,
    s.niveausanction,
    tf.val AS libelleFaute,
    ts.val AS sanction,
    ri.DESCRIPTIONREGLE AS reglementLib,
    ri.NUMEROREGLE AS numeroRegle,
    s.etat AS etat,
    lpr.MATRICULE
FROM SANCTION s
         LEFT JOIN LOG_PERSONNEL_V2 lpr ON s.idpersonne = lpr.id
         LEFT JOIN TYPEFAUTE tf ON s.TYPEFAUTE = tf.ID
         LEFT JOIN typesanction ts ON s.typesanction = ts.id
         LEFT JOIN REGLEMENTINTERIEUR ri ON s.IDREGLEENFREINTE = ri.id
;




CREATE SEQUENCE SEQ_XC INCREMENT BY 1 MINVALUE 1 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE NOORDER;

CREATE OR REPLACE FUNCTION GET_SEQXC
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT SEQ_XC.NEXTVAL into retour from dual;
RETURN retour;
END;

INSERT INTO PAIE_FONCTION
(ID, VAL, DESCE, IDGROUPEFONCTION, GRATIFICATION)
VALUES('PFNC000241', 'TS', 'TECHNICIEN DE SURFACE', 'PAI000002', NULL);
INSERT INTO PAIE_FONCTION
(ID, VAL, DESCE, IDGROUPEFONCTION, GRATIFICATION)
VALUES('PFNC000021', 'CH', 'CHAUFFEUR', 'PAI000003', NULL);

CREATE OR REPLACE VIEW LOG_SERVICE_LIBELLE AS
SELECT ls.id,
       ls.libelle,
       sd.val AS code_dr,
       ls.dr_rattache,
       ls.code_service
FROM log_service ls
         LEFT JOIN sig_dr sd ON ls.code_dr = sd.id AND ls.id <> 'SERV00001';

INSERT INTO PAIE_GROUPEFONCTION
(ID, VAL, DESCE)
VALUES('PAI000007', 'HC', 'Hors categorie');
INSERT INTO PAIE_GROUPEFONCTION
(ID, VAL, DESCE)
VALUES('PAI000002', 'GROUPE 1', 'GROUPE 1');
INSERT INTO PAIE_GROUPEFONCTION
(ID, VAL, DESCE)
VALUES('PAI000003', 'GROUPE 2', 'GROUPE 2');
INSERT INTO PAIE_GROUPEFONCTION
(ID, VAL, DESCE)
VALUES('PAI000004', 'GROUPE 3', 'GROUPE 3');
INSERT INTO PAIE_GROUPEFONCTION
(ID, VAL, DESCE)
VALUES('PAI000005', 'GROUPE 4', 'GROUPE 4');
INSERT INTO PAIE_GROUPEFONCTION
(ID, VAL, DESCE)
VALUES('PAI000006', 'GROUPE 5', 'GROUPE 5');

--
INSERT INTO SITUATION_MATRIMONIALE
(ID, VAL, DESCE)
VALUES('SIT02', 'Marié', 'Marié');
INSERT INTO SITUATION_MATRIMONIALE
(ID, VAL, DESCE)
VALUES('SIT01', 'Célibataire', 'Célibataire');
INSERT INTO SITUATION_MATRIMONIALE
(ID, VAL, DESCE)
VALUES('SIT03', 'Divorcé(e)', 'Divorcé(e)');
INSERT INTO SITUATION_MATRIMONIALE
(ID, VAL, DESCE)
VALUES('SIT04', 'Veuf(ve)', 'Veuf(ve)');

INSERT INTO TYPE_CONTRAT
(ID, VAL, DESCE)
VALUES('TYP0000001', 'CDD', 'CDD');
INSERT INTO TYPE_CONTRAT
(ID, VAL, DESCE)
VALUES('TYP0000002', 'CDI', 'CDI');
INSERT INTO TYPE_CONTRAT
(ID, VAL, DESCE)
VALUES('TYP0000003', 'STAGIAIRE', 'STAGIAIRE');
INSERT INTO TYPE_CONTRAT
(ID, VAL, DESCE)
VALUES('TYP0000004', 'CONSULTANT', 'CONSULTANT');
INSERT INTO TYPE_CONTRAT
(ID, VAL, DESCE)
VALUES('TYP0000005', 'DETACHEMENT', 'DETACHEMENT');
INSERT INTO TYPE_CONTRAT
(ID, VAL, DESCE)
VALUES('TYP0000006', 'Essai', 'Contrat d''essai ');

-- XCPROD2907.PAIE_INFO_EMBAUCHE source

CREATE OR REPLACE VIEW PAIE_INFO_EMBAUCHE AS
SELECT pip.id,
       pip.datesaisie,
       pip.matricule,
       pip.lieu_naissance_commune,
       pip.lieu_delivrance_cin,
       pip.situation_matrimonial,
       pip.initiale,
       pip.cturgence_nom_prenom,
       pip.cturgence_telephone1,
       pip.cturgence_telephone2,
       pip.cturgence_telephone3,
       pip.idconjoint,
       pip.code_agence_banque,
       pip.banque_numero_compte,
       pip.banque_compte_cle,
       pip.dateembauche,
       pip.idfonction,
       pip.idcategorie,
       pip.mode_paiement,
       pip.classee,
       pip.indicegrade,
       pip.indice_fonctionnel,
       pip.matricule_patron,
       pip.statut,
       pip.droit_hs,
       pip.vehiculee,
       pip.echelon,
       pip.etat,
       pip.ctg,
       pip.iduser,
       pip.indice_ct,
       pip.datepromotion,
       pip.numero_cnaps,
       pip.numero_ostie,
       pip.temporaire,
       pip.n_embauche,
       pip.date_depart,
       pip.n_depart,
       pip.nbenfant,
       pip.heurejournalier,
       pip.heurehebdomadaire,
       pip.heuremensuel,
       lp.direction
FROM paie_info_personnel pip
         JOIN log_personnel lp ON lp.id = pip.id;


CREATE SEQUENCE SEQSIGPERSONNES INCREMENT BY 1 MINVALUE 1 MAXVALUE 999999999999 NOCYCLE CACHE 20 NOORDER;

CREATE OR REPLACE FUNCTION getseqsigpersonnes
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seqsigpersonnes.NEXTVAL into retour from dual;
RETURN retour;
END;

-- XCPROD2907.DERNIER_DEBAUCHE_LPNV source

CREATE OR REPLACE VIEW DERNIER_DEBAUCHE_LPNV  AS
SELECT lpnv.id,
       lpnv.idlogpers,
       lpnv.dateapplication,
       lpnv.idtypedebauche,
       lpnv.etat,
       lpnv.iduser,
       lpnv.motif,
       lpnv.date_reintegration,
       lpnv.date_decision,
       lpnv.refdecision,
       lpnv.idavancement
FROM dernier_debauche_by_employe debauche,
     log_personnel_non_valide lpnv
WHERE debauche.idlogpers = lpnv.idlogpers AND debauche.dateapplication = lpnv.dateapplication AND debauche.date_decision = lpnv.date_decision;


-- XCPROD2907.POINTAGEVISEE_VISA_MULTIPLE source

CREATE OR REPLACE VIEW POINTAGEVISEE_VISA_MULTIPLE AS
SELECT pp.id as id,pp.IDPERSONNEL,lpad(pif.matricule, 5, '0') as matricule, lg.nom || ' ' || lg.prenom as personnel,
       case
           when pp.mois=1 then
               'Janvier'
           when pp.mois=2
               then
               'Fevrier'
           when pp.mois=3
               then
               'Mars'
           when pp.mois=4
               then
               'Avril'
           when pp.mois=5
               then
               'Mai'
           when pp.mois=6
               then
               'Juin'
           when pp.mois=7
               then
               'Juillet'
           when pp.mois=8
               then
               'Aout'
           when pp.mois=9
               then
               'Septembre'
           when pp.mois=10
               then
               'Octobre'
           when pp.mois=11
               then
               'Novembre'
           when pp.mois=12
               then
               'Decembre'
           end as moisLib,
       pp.mois as mois,
       pp.annee,
       sum(nvl(pp.HEURENORMAL,0)) as HEURENORMAL,
       sum(nvl(pp.HEURESUPNORMAL,0)) as HEURESUPNORMAL,
       sum(nvl(pp.HEURESUPNUIT,0)) as HEURESUPNUIT,
       sum(nvl(pp.HEURESUPFERIE,0)) as HEURESUPFERIE,
       sum(nvl(pp.HEURESUPWEEKEND,0)) as HEURESUPWEEKEND,
       sum(nvl(pp.ABSENCE,0)) as ABSENCE,
       pp.etat,
       lg.direction,
       ld.VAL AS directionLib
FROM LOG_PERSONNEL lg
         JOIN Pointage pp ON lg.id = pp.idpersonnel
         JOIN paie_info_personnel pif ON pif.id = lg.id
         LEFT JOIN LOG_DIRECTION ld ON ld.id = pp.DIRECTION
GROUP BY lpad(pif.matricule, 5, '0'), lg.nom || ' ' || lg.prenom, pp.mois, pp.annee, pp.etat,pp.ID,pp.IDPERSONNEL,pp.mois,lg.direction, ld.val
;

-- XCPROD2907.POINTAGEVISEE_VISA_MULTIPLE_1 source

CREATE OR REPLACE VIEW POINTAGEVISEE_VISA_MULTIPLE_1 AS
SELECT
    pp.id AS id,
    pp.IDPERSONNEL,
    pif.matricule AS matricule,
    CAST(lg.nom || ' ' || lg.prenom AS VARCHAR2(4000)) AS personnel,
    CASE
        WHEN pp.mois = 1 THEN 'Janvier'
        WHEN pp.mois = 2 THEN 'Fevrier'
        WHEN pp.mois = 3 THEN 'Mars'
        WHEN pp.mois = 4 THEN 'Avril'
        WHEN pp.mois = 5 THEN 'Mai'
        WHEN pp.mois = 6 THEN 'Juin'
        WHEN pp.mois = 7 THEN 'Juillet'
        WHEN pp.mois = 8 THEN 'Aout'
        WHEN pp.mois = 9 THEN 'Septembre'
        WHEN pp.mois = 10 THEN 'Octobre'
        WHEN pp.mois = 11 THEN 'Novembre'
        WHEN pp.mois = 12 THEN 'Decembre'
        END AS moisLib,
    pp.mois AS mois,
    pp.annee,
    SUM(NVL(pp.HEURENORMAL, 0)) AS HEURENORMAL,
    SUM(NVL(pp.HEURESUPNORMAL, 0)) AS HEURESUPNORMAL,
    SUM(NVL(pp.HEURESUPNUIT, 0)) AS HEURESUPNUIT,
    SUM(NVL(pp.HEURESUPFERIE, 0)) AS HEURESUPFERIE,
    SUM(NVL(pp.HEURESUPWEEKEND, 0)) AS HEURESUPWEEKEND,
    SUM(NVL(pp.ABSENCE, 0)) AS ABSENCE,
    pp.etat,
    lg.direction
FROM
    LOG_PERSONNEL lg
        JOIN
    Pointage pp ON lg.id = pp.idpersonnel
        JOIN
    paie_info_personnel pif ON pif.id = lg.id
GROUP BY
    pif.matricule,
    CAST(lg.nom || ' ' || lg.prenom AS VARCHAR2(4000)),
    pp.mois,
    pp.annee,
    pp.etat,
    pp.ID,
    pp.IDPERSONNEL,
    lg.direction
;

-- XCPROD2907.PV_VISA_MULTIPLE_CREE source

CREATE OR REPLACE VIEW PV_VISA_MULTIPLE_CREE AS
SELECT
    ID,
    IDPERSONNEL,
    MATRICULE,
    PERSONNEL,
    MOIS,
    MOISLIB,
    ANNEE,
    CAST(HEURENORMAL AS NUMBER(20,2)) AS HEURENORMAL,
    CAST(HEURESUPNORMAL AS NUMBER(20,2)) AS HEURESUPNORMAL,
    CAST(HEURESUPNUIT AS NUMBER(20,2)) AS HEURESUPNUIT,
    CAST(HEURESUPFERIE AS NUMBER(20,2)) AS HEURESUPFERIE,
    CAST(HEURESUPWEEKEND AS NUMBER(20,2)) AS HEURESUPWEEKEND,
    CAST(ABSENCE AS NUMBER(20,2)) AS ABSENCE,
    ETAT,
    DIRECTION,
    DIRECTIONLIB
FROM
    POINTAGEVISEE_VISA_MULTIPLE
WHERE
    etat = 1;

-- XCPROD2907.PV_VISA_MULTIPLE_VISEE source

CREATE OR REPLACE VIEW PV_VISA_MULTIPLE_VISEE AS
SELECT
    ID,
    IDPERSONNEL,
    MATRICULE,
    PERSONNEL,
    MOIS,
    MOISLIB,
    ANNEE,
    CAST(HEURENORMAL AS NUMBER(20,2)) AS HEURENORMAL,
    CAST(HEURESUPNORMAL AS NUMBER(20,2)) AS HEURESUPNORMAL,
    CAST(HEURESUPNUIT AS NUMBER(20,2)) AS HEURESUPNUIT,
    CAST(HEURESUPFERIE AS NUMBER(20,2)) AS HEURESUPFERIE,
    CAST(HEURESUPWEEKEND AS NUMBER(20,2)) AS HEURESUPWEEKEND,
    CAST(ABSENCE AS NUMBER(20,2)) AS ABSENCE,
    ETAT,
    DIRECTION,
    DIRECTIONLIB
FROM
    POINTAGEVISEE_VISA_MULTIPLE
WHERE
    etat = 11;

INSERT INTO TYPEABSENCE
(ID, VAL, DESCE)
VALUES('TYP000006', '10', 'Permission');
INSERT INTO TYPEABSENCE
(ID, VAL, DESCE)
VALUES('TYP000003', '10', 'Autorisation d''absence');
INSERT INTO TYPEABSENCE
(ID, VAL, DESCE)
VALUES('TYP000004', '1000', 'Congé');

CREATE SEQUENCE SEQ_DEMANDE INCREMENT BY 1 MINVALUE 1 MAXVALUE 999999999999 NOCYCLE CACHE 20 NOORDER;

CREATE OR REPLACE FUNCTION get_seq_demande
RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seq_demande.NEXTVAL INTO retour FROM dual;
RETURN retour;
END;


CREATE OR REPLACE VIEW DEMANDE_LIBCOMPLET2 AS
SELECT d.id,
       d.idpersonnel,
       pip.matricule AS matricules,
       pip.idfonction,
       pf.val AS fonctionlib,
       d.idtypedemande,
       t.val AS typedemandelib,
       d.titre,
       d.horairenormal,
       d.heuredepart,
       d.heurearrive,
       d.idtypeabsence,
       t2.desce AS typeabsencelib,
       d.motif,
       d.numero,
       d.desce,
       d.etat,
       d.daty,
       d.duree,
       d.datedepart,
       d.datefin,
       d.dateretour,
       d.observation,
       d.remarque,
       lp.nom,
       lp.prenom,
       (lp.nom || ' ') || lp.prenom AS personnel,
       lp.direction AS iddirection,
       ld.val AS directionlib,
       CASE
           WHEN d.etat = 1 THEN 'cr?e'
           WHEN d.etat = 11 THEN 'vis?e'
           ELSE NULL
           END AS etatlib,
       u.refuser,
       r.rang AS ranguser,
       d.idremplacents,
       rmp.remplacents,
       d.avenant
FROM demande d
         LEFT JOIN paie_info_personnel pip ON d.idpersonnel = pip.id
         LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction
         LEFT JOIN typedemande t ON t.id = d.idtypedemande
         LEFT JOIN typeabsence t2 ON t2.id = d.idtypeabsence
         LEFT JOIN log_personnel lp ON lp.id = pip.id
         LEFT JOIN log_direction ld ON ld.id = lp.direction
         LEFT JOIN utilisateur u ON u.refuser = lp.refuser
         LEFT JOIN roles r ON r.idrole = u.idrole
         LEFT JOIN demande_remplacents rmp ON rmp.id = d.id;

/* ============================================== */
/* ============================================== */
/* ============================================== */
/* ============================================== */

CREATE SEQUENCE SEQ_XC INCREMENT BY 1 MINVALUE 1 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE NOORDER;

CREATE OR REPLACE FUNCTION GET_SEQXC
    RETURN NUMBER
    IS
    retour NUMBER;
BEGIN
SELECT SEQ_XC.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE OR REPLACE PROCEDURE DELETEEDITIONWITHDIR2(ms NUMBER,ane NUMBER,dir VARCHAR,idobj varchar) AS
BEGIN
DELETE FROM PAIE_EDITION WHERE MOIS = ms AND ANNEE = ane and IDPERSONNEL in(select p.id from LOG_PERSONNEL p where p.DIRECTION=dir);
DELETE FROM PAIE_EDITIONMOISANNEE WHERE MOIS = ms AND ANNEE = ane and IDDIRECTION=dir;
END;


CREATE OR REPLACE FUNCTION get_seq_paie_edition
    RETURN NUMBER
    IS
    retour NUMBER;
BEGIN
SELECT seq_paie_edition.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE OR REPLACE FUNCTION get_seq_paie_avancement
    RETURN NUMBER
    IS
    retour NUMBER;
BEGIN
SELECT SEQ_PAIE_AVANCEMENT.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE OR REPLACE FUNCTION get_seq_paie_fonction
    RETURN NUMBER
    IS
    retour NUMBER;
BEGIN
SELECT seq_Paie_fonction.NEXTVAL into retour from dual;
RETURN retour;
END;

CREATE OR REPLACE FUNCTION get_seq_paie_info_personnel
    RETURN NUMBER
    IS
    retour NUMBER;
BEGIN
SELECT SEQ_PAIE_INFO_PERSONNEL.NEXTVAL into retour from dual;
RETURN retour;
END;


CREATE OR REPLACE VIEW EMPLOYE_COMPLET_PDF AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       logp.sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       paie.adresse_ligne1 AS adresse,
       logp.fokotany,
       logp.nationalite,
       logp.acte_naissance,
       paie.situation_matrimonial,
       paie.idconjoint,
       logp.direction,
       logp.service,
       fonct.desce AS idfonction,
       paie.ctg,
       paie.idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       paie.mode_paiement,
       paie.code_agence_banque,
       paie.banque_numero_compte,
       paie.banque_compte_cle,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       ld.val AS code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.etat,
       paie.vehiculee,
       tab.date_dernierpromo,
       paie.droit_hs,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       paie.nbenfant,
       paie.indesirable,
       cp.essaie AS duree,
       paie.telephone,
       paie.mail,
       cp.val AS idcategorie_paie,
       qp.val AS idqualification,
       paie.discipline,
       paie.formation,
       paie.anneeexperience,
       cq.montant,
       cd.resteconge AS conger
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN paie_fonction fonct ON fonct.id = paie.idfonction
         LEFT JOIN categorie_paie cp ON cp.id = paie.idcategorie_paie
         LEFT JOIN qualification_paie qp ON qp.id = paie.idqualification
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = paie.idcategorie_paie AND cq.idqualification = paie.idqualification AND cq.remarque = logp.id AND cq.etat = 1
         LEFT JOIN log_direction ld ON ld.id = logp.direction
         LEFT JOIN log_personnel_fin cd ON cd.id = logp.id;


CREATE OR REPLACE VIEW SITUATION_SALAIRE_EDITION_dist AS
SELECT DISTINCT
    lp.ID,
    pe.idedition AS idedition,
    pip.nbenfant,
    pip.MATRICULE,
    trim(TRAILING ' ' FROM lp.NOM) AS nom,
    trim(TRAILING ' ' FROM lp.PRENOM) AS prenom,
    trim(TRAILING ' ' FROM lp.NOM)
        || ' '
        || trim(TRAILING ' ' FROM lp.PRENOM) AS personnel,
    pf.desce AS fonction,
    pf.id AS idfonction,
    pc.VAL AS classification,
    pc.id AS idcategorie,
    ld.ID AS iddirection,
    ld.VAL AS direction,
    ls.ID AS SECTION,
    ls.CODE_SERVICE AS section_numero,
    ls.libelle AS section_libelle,
    nvl(SALAIREDEBASE.salairedebase, 0) AS salaire,
    nvl(totalgain.gain,0) as salairebrute,
    173.33 as heuremois,
    nvl(poi.HEURENORMAL, 0) AS heurepresence,
    nvl(pe.tauxhoraire, 0) AS tauxhoraire,
    nvl(salaire.gain, 0) AS salairemois,
    nvl(heuresup.gain, 0) AS heuresup,
    nvl(rappel.gain, 0) AS rappel,
    nvl(retenuabsc.retenue, 0) AS retenuabsc,
    nvl(prime.gain, 0) AS prime,
    nvl(congepayer.gain, 0) AS congepayer,
    nvl(preavis.gain, 0) AS preavis,
    nvl(netpayer.gain, 0) AS netpayer,
    nvl(netpayerarr.gain, 0) AS netpayerarr,
    nvl(indamdivfixe.gain, 0) AS indamdivfixe,
    nvl(cnaps.retenue, 0) AS cnaps,
    nvl(ostie.retenue, 0) AS ostie,
    nvl(netimposable.retenue, 0) AS netimposable,
    nvl(netimposablearr.retenue, 0) AS netimposablearr,
    nvl(irsa.retenue, 0) AS irsa,
    nvl(irsanet.retenue, 0) AS irsanet,
    nvl(allocation.gain,0) as allocation,
    nvl(avancesalaire.retenue, 0) AS avancesalaire,
    nvl(avanceexcep.retenue, 0) AS avanceexcep,
    pe.annee,
    pe.mois
FROM -- select * from
    paie_edition pe
    INNER JOIN log_personnel lp ON
    lp.id = pe.idpersonnel
    INNER JOIN paie_info_personnel pip ON
    pip.id = pe.idpersonnel
    INNER JOIN log_direction ld ON
    pe.DIRECTION = ld.ID
    INNER JOIN log_service ls ON
    pe.SERVICE = ls.ID
    INNER JOIN CATEGORIE_PAIE pc ON
    pe.IDCATEGORIE = pc.ID
    INNER JOIN paie_fonction pf ON
    pe.IDFONCTION = pf.ID
    INNER JOIN POINTAGE poi ON
    pe.IDPERSONNEL = poi.IDPERSONNEL
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 1
    GROUP BY
    idpersonnel,
    mois,
    annee) salaire
    ON
    salaire.idpersonnel = lp.id
    AND salaire.annee = pe.annee
    AND salaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    max(SALAIREDEBASE) AS salairedebase,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 18
    GROUP BY
    idpersonnel,
    mois,
    annee) salairedebase
    ON
    salairedebase.idpersonnel = lp.id
    AND salairedebase.annee = pe.annee
    AND salairedebase.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 2
    GROUP BY
    idpersonnel,
    mois,
    annee) heuresup
    ON
    heuresup.idpersonnel = lp.id
    AND heuresup.annee = pe.annee
    AND heuresup.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 3
    GROUP BY
    idpersonnel,
    mois,
    annee) rappel
    ON
    rappel.idpersonnel = lp.id
    AND rappel.annee = pe.annee
    AND rappel.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(RETENUE) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 4
    GROUP BY
    idpersonnel,
    mois,
    annee) retenuabsc
    ON
    retenuabsc.idpersonnel = lp.id
    AND retenuabsc.annee = pe.annee
    AND retenuabsc.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 5
    GROUP BY
    idpersonnel,
    mois,
    annee) prime
    ON
    prime.idpersonnel = lp.id
    AND prime.annee = pe.annee
    AND prime.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('403', '4030')
    GROUP BY
    idpersonnel,
    mois,
    annee) hs30
    ON
    hs30.idpersonnel = lp.id
    AND hs30.annee = pe.annee
    AND hs30.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('405', '4050')
    GROUP BY
    idpersonnel,
    mois,
    annee) hs50
    ON
    hs50.idpersonnel = lp.id
    AND hs50.annee = pe.annee
    AND hs50.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 6
    GROUP BY
    idpersonnel,
    mois,
    annee) congepayer
    ON
    congepayer.idpersonnel = lp.id
    AND congepayer.annee = pe.annee
    AND congepayer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 7
    GROUP BY
    idpersonnel,
    mois,
    annee) preavis
    ON
    preavis.idpersonnel = lp.id
    AND preavis.annee = pe.annee
    AND preavis.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 8
    GROUP BY
    idpersonnel,
    mois,
    annee) indamdivfixe
    ON
    indamdivfixe.idpersonnel = lp.id
    AND indamdivfixe.annee = pe.annee
    AND indamdivfixe.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 9
    GROUP BY
    idpersonnel,
    mois,
    annee) totalgain
    ON
    totalgain.idpersonnel = lp.id
    AND totalgain.annee = pe.annee
    AND totalgain.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 10
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps
    ON
    cnaps.idpersonnel = lp.id
    AND cnaps.annee = pe.annee
    AND cnaps.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('700', '701')
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps_sans_complementaire
    ON
    cnaps_sans_complementaire.idpersonnel = lp.id
    AND cnaps_sans_complementaire.annee = pe.annee
    AND cnaps_sans_complementaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('705', '706')
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps_complementaire
    ON
    cnaps_complementaire.idpersonnel = lp.id
    AND cnaps_complementaire.annee = pe.annee
    AND cnaps_complementaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 11
    GROUP BY
    idpersonnel,
    mois,
    annee) ostie
    ON
    ostie.idpersonnel = lp.id
    AND ostie.annee = pe.annee
    AND ostie.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 12
    GROUP BY
    idpersonnel,
    mois,
    annee) netimposable
    ON
    netimposable.idpersonnel = lp.id
    AND netimposable.annee = pe.annee
    AND netimposable.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 13
    GROUP BY
    idpersonnel,
    mois,
    annee) netimposablearr
    ON
    netimposablearr.idpersonnel = lp.id
    AND netimposablearr.annee = pe.annee
    AND netimposablearr.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 14
    GROUP BY
    idpersonnel,
    mois,
    annee) irsa
    ON
    irsa.idpersonnel = lp.id
    AND irsa.annee = pe.annee
    AND irsa.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 15
    GROUP BY
    idpersonnel,
    mois,
    annee) irsanet
    ON
    irsanet.idpersonnel = lp.id
    AND irsanet.annee = pe.annee
    AND irsanet.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(RETENUE) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 16
    GROUP BY
    idpersonnel,
    mois,
    annee) avancesalaire
    ON
    avancesalaire.idpersonnel = lp.id
    AND avancesalaire.annee = pe.annee
    AND avancesalaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 17
    GROUP BY
    idpersonnel,
    mois,
    annee) avanceexcep
    ON
    avanceexcep.idpersonnel = lp.id
    AND avanceexcep.annee = pe.annee
    AND avanceexcep.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 18
    GROUP BY
    idpersonnel,
    mois,
    annee) netpayer
    ON
    netpayer.idpersonnel = lp.id
    AND netpayer.annee = pe.annee
    AND netpayer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 19
    GROUP BY
    idpersonnel,
    mois,
    annee) netpayerarr
    ON
    netpayerarr.idpersonnel = lp.id
    AND netpayerarr.annee = pe.annee
    AND netpayerarr.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 20
    GROUP BY
    idpersonnel,
    mois,
    annee) allocation
    ON
    allocation.idpersonnel = lp.id
    AND allocation.annee = pe.annee
    AND allocation.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 100
    GROUP BY
    idpersonnel,
    mois,
    annee) net_a_payer
    ON
    net_a_payer.idpersonnel = lp.id
    AND net_a_payer.annee = pe.annee
    AND net_a_payer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    (regroupement != 100
    OR regroupement IS NULL)
    GROUP BY
    idpersonnel,
    mois,
    annee) salaire_brute
    ON
    salaire_brute.idpersonnel = lp.id
    AND salaire_brute.annee = pe.annee
    AND salaire_brute.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    GROUP BY
    idpersonnel,
    mois,
    annee) total_retenue
    ON
    total_retenue.idpersonnel = lp.id
    AND total_retenue.annee = pe.annee
    AND total_retenue.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe,
    paie_rubrique pr
    WHERE
    pr.id = pe.idelementpaie
    AND pr.imposable = 'I'
    GROUP BY
    idpersonnel,
    mois,
    annee) montant_brute_imposable
    ON
    montant_brute_imposable.idpersonnel = lp.id
    AND montant_brute_imposable.annee = pe.annee
    AND montant_brute_imposable.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('205')
    GROUP BY
    idpersonnel,
    mois,
    annee) indemnite_logement
    ON
    indemnite_logement.idpersonnel = lp.id
    AND indemnite_logement.annee = pe.annee
    AND indemnite_logement.mois = pe.mois
GROUP BY
    lp.ID,
    lpad(pe.MATRICULE, 5, '0'),
    pc.id,
    trim(TRAILING ' ' FROM lp.NOM),
    trim(TRAILING ' ' FROM lp.PRENOM),
    lp.NOM || ' ' || lp.PRENOM ,
    pf.DESCE,
    pf.id,
    pc.VAL ,
    ld.ID,
    ld.VAL,
    ls.ID,
    ls.CODE_SERVICE,
    ls.LIBELLE,
    pe.temporaire,
    nvl(SALAIREDEBASE.salairedebase, 0),
    nvl(heuresup.gain, 0),
    nvl(rappel.gain, 0),
    nvl(retenuabsc.retenue, 0),
    nvl(prime.gain, 0),
    nvl(net_a_payer.gain, 0),
    nvl(montant_brute_imposable.gain, 0),
    nvl(congepayer.gain, 0),
    nvl(preavis.gain, 0),
    nvl(hs30.gain, 0),
    nvl(hs50.gain, 0),
    nvl(indamdivfixe.gain, 0),
    nvl(totalgain.gain, 0),
    nvl(cnaps.retenue, 0),
    nvl(ostie.retenue, 0),
    nvl(salaire_brute.gain, 0),
    nvl(cnaps.retenue, 0),
    nvl(ostie.retenue, 0),
    nvl(irsa.retenue, 0),
    nvl(irsanet.retenue, 0),
    nvl(netimposable.retenue, 0),
    nvl(netimposablearr.retenue, 0),
    nvl(total_retenue.retenue, 0),
    nvl(avancesalaire.retenue, 0),
    nvl(avanceexcep.retenue, 0),
    nvl(cnaps_sans_complementaire.retenue, 0),
    nvl(cnaps_complementaire.retenue, 0),
    nvl(rappel.gain, 0),
    nvl(netpayer.gain, 0),
    nvl(netpayerarr.gain, 0),
    nvl(indemnite_logement.gain, 0),
    nvl(pe.tauxhoraire, 0),
    pip.MATRICULE,
    nvl(totalgain.gain,0),
    nvl(allocation.gain,0),
    173.33,
    nvl(poi.HEURENORMAL, 0),
    nvl(salaire.gain, 0),
    0,
    pip.nbenfant,
    pe.annee,
    pe.mois,
    pe.idedition
;




CREATE OR REPLACE VIEW TEST_SITUATION_SALAIRE_EDITION AS
SELECT
    lp.ID,
    pe.idedition AS idedition,
    pip.nbenfant,
    pip.MATRICULE,
    trim(TRAILING ' ' FROM lp.NOM) AS nom,
    trim(TRAILING ' ' FROM lp.PRENOM) AS prenom,
    trim(TRAILING ' ' FROM lp.NOM)
        || ' '
        || trim(TRAILING ' ' FROM lp.PRENOM) AS personnel,
    pf.desce AS fonction,
    pf.id AS idfonction,
    pc.VAL AS classification,
    pc.id AS idcategorie,
    ld.ID AS iddirection,
    ld.VAL AS direction,
    ls.ID AS SECTION,
    ls.CODE_SERVICE AS section_numero,
    ls.libelle AS section_libelle,
    nvl(SALAIREDEBASE.salairedebase, 0) AS salaire,
    nvl(totalgain.gain,0) as salairebrute,
    173.33 as heuremois,
    nvl(poi.HEURENORMAL, 0) AS heurepresence,
    nvl(pe.tauxhoraire, 0) AS tauxhoraire,
    nvl(salaire.gain, 0) AS salairemois,
    nvl(heuresup.gain, 0) AS heuresup,
    nvl(rappel.gain, 0) AS rappel,
    nvl(retenuabsc.retenue, 0) AS retenuabsc,
    nvl(prime.gain, 0) AS prime,
    nvl(congepayer.gain, 0) AS congepayer,
    nvl(preavis.gain, 0) AS preavis,
    nvl(netpayer.gain, 0) AS netpayer,
    nvl(netpayerarr.gain, 0) AS netpayerarr,
    nvl(indamdivfixe.gain, 0) AS indamdivfixe,
    nvl(cnaps.retenue, 0) AS cnaps,
    nvl(ostie.retenue, 0) AS ostie,
    nvl(netimposable.retenue, 0) AS netimposable,
    nvl(netimposablearr.retenue, 0) AS netimposablearr,
    nvl(irsa.retenue, 0) AS irsa,
    nvl(irsanet.retenue, 0) AS irsanet,
    nvl(allocation.gain,0) as allocation,
    nvl(avancesalaire.retenue, 0) AS avancesalaire,
    nvl(avanceexcep.retenue, 0) AS avanceexcep,
    pe.annee,
    pe.mois
FROM -- select * from
    paie_edition pe
    INNER JOIN log_personnel lp ON
    lp.id = pe.idpersonnel
    INNER JOIN paie_info_personnel pip ON
    pip.id = pe.idpersonnel
    INNER JOIN log_direction ld ON
    pe.DIRECTION = ld.ID
    INNER JOIN log_service ls ON
    pe.SERVICE = ls.ID
    INNER JOIN CATEGORIE_PAIE pc ON
    pe.IDCATEGORIE = pc.ID
    INNER JOIN paie_fonction pf ON
    pe.IDFONCTION = pf.ID
    INNER JOIN POINTAGE poi ON
    pe.IDPERSONNEL = poi.IDPERSONNEL
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 1
    GROUP BY
    idpersonnel,
    mois,
    annee) salaire
    ON
    salaire.idpersonnel = lp.id
    AND salaire.annee = pe.annee
    AND salaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    max(SALAIREDEBASE) AS salairedebase,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 18
    GROUP BY
    idpersonnel,
    mois,
    annee) salairedebase
    ON
    salairedebase.idpersonnel = lp.id
    AND salairedebase.annee = pe.annee
    AND salairedebase.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 2
    GROUP BY
    idpersonnel,
    mois,
    annee) heuresup
    ON
    heuresup.idpersonnel = lp.id
    AND heuresup.annee = pe.annee
    AND heuresup.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 3
    GROUP BY
    idpersonnel,
    mois,
    annee) rappel
    ON
    rappel.idpersonnel = lp.id
    AND rappel.annee = pe.annee
    AND rappel.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(RETENUE) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 4
    GROUP BY
    idpersonnel,
    mois,
    annee) retenuabsc
    ON
    retenuabsc.idpersonnel = lp.id
    AND retenuabsc.annee = pe.annee
    AND retenuabsc.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 5
    GROUP BY
    idpersonnel,
    mois,
    annee) prime
    ON
    prime.idpersonnel = lp.id
    AND prime.annee = pe.annee
    AND prime.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('403', '4030')
    GROUP BY
    idpersonnel,
    mois,
    annee) hs30
    ON
    hs30.idpersonnel = lp.id
    AND hs30.annee = pe.annee
    AND hs30.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('405', '4050')
    GROUP BY
    idpersonnel,
    mois,
    annee) hs50
    ON
    hs50.idpersonnel = lp.id
    AND hs50.annee = pe.annee
    AND hs50.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 6
    GROUP BY
    idpersonnel,
    mois,
    annee) congepayer
    ON
    congepayer.idpersonnel = lp.id
    AND congepayer.annee = pe.annee
    AND congepayer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 7
    GROUP BY
    idpersonnel,
    mois,
    annee) preavis
    ON
    preavis.idpersonnel = lp.id
    AND preavis.annee = pe.annee
    AND preavis.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 8
    GROUP BY
    idpersonnel,
    mois,
    annee) indamdivfixe
    ON
    indamdivfixe.idpersonnel = lp.id
    AND indamdivfixe.annee = pe.annee
    AND indamdivfixe.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 9
    GROUP BY
    idpersonnel,
    mois,
    annee) totalgain
    ON
    totalgain.idpersonnel = lp.id
    AND totalgain.annee = pe.annee
    AND totalgain.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 10
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps
    ON
    cnaps.idpersonnel = lp.id
    AND cnaps.annee = pe.annee
    AND cnaps.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('700', '701')
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps_sans_complementaire
    ON
    cnaps_sans_complementaire.idpersonnel = lp.id
    AND cnaps_sans_complementaire.annee = pe.annee
    AND cnaps_sans_complementaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('705', '706')
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps_complementaire
    ON
    cnaps_complementaire.idpersonnel = lp.id
    AND cnaps_complementaire.annee = pe.annee
    AND cnaps_complementaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 11
    GROUP BY
    idpersonnel,
    mois,
    annee) ostie
    ON
    ostie.idpersonnel = lp.id
    AND ostie.annee = pe.annee
    AND ostie.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 12
    GROUP BY
    idpersonnel,
    mois,
    annee) netimposable
    ON
    netimposable.idpersonnel = lp.id
    AND netimposable.annee = pe.annee
    AND netimposable.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 13
    GROUP BY
    idpersonnel,
    mois,
    annee) netimposablearr
    ON
    netimposablearr.idpersonnel = lp.id
    AND netimposablearr.annee = pe.annee
    AND netimposablearr.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 14
    GROUP BY
    idpersonnel,
    mois,
    annee) irsa
    ON
    irsa.idpersonnel = lp.id
    AND irsa.annee = pe.annee
    AND irsa.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 15
    GROUP BY
    idpersonnel,
    mois,
    annee) irsanet
    ON
    irsanet.idpersonnel = lp.id
    AND irsanet.annee = pe.annee
    AND irsanet.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(RETENUE) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 16
    GROUP BY
    idpersonnel,
    mois,
    annee) avancesalaire
    ON
    avancesalaire.idpersonnel = lp.id
    AND avancesalaire.annee = pe.annee
    AND avancesalaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 17
    GROUP BY
    idpersonnel,
    mois,
    annee) avanceexcep
    ON
    avanceexcep.idpersonnel = lp.id
    AND avanceexcep.annee = pe.annee
    AND avanceexcep.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 18
    GROUP BY
    idpersonnel,
    mois,
    annee) netpayer
    ON
    netpayer.idpersonnel = lp.id
    AND netpayer.annee = pe.annee
    AND netpayer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 19
    GROUP BY
    idpersonnel,
    mois,
    annee) netpayerarr
    ON
    netpayerarr.idpersonnel = lp.id
    AND netpayerarr.annee = pe.annee
    AND netpayerarr.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 20
    GROUP BY
    idpersonnel,
    mois,
    annee) allocation
    ON
    allocation.idpersonnel = lp.id
    AND allocation.annee = pe.annee
    AND allocation.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 100
    GROUP BY
    idpersonnel,
    mois,
    annee) net_a_payer
    ON
    net_a_payer.idpersonnel = lp.id
    AND net_a_payer.annee = pe.annee
    AND net_a_payer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    (regroupement != 100
    OR regroupement IS NULL)
    GROUP BY
    idpersonnel,
    mois,
    annee) salaire_brute
    ON
    salaire_brute.idpersonnel = lp.id
    AND salaire_brute.annee = pe.annee
    AND salaire_brute.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    GROUP BY
    idpersonnel,
    mois,
    annee) total_retenue
    ON
    total_retenue.idpersonnel = lp.id
    AND total_retenue.annee = pe.annee
    AND total_retenue.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe,
    paie_rubrique pr
    WHERE
    pr.id = pe.idelementpaie
    AND pr.imposable = 'I'
    GROUP BY
    idpersonnel,
    mois,
    annee) montant_brute_imposable
    ON
    montant_brute_imposable.idpersonnel = lp.id
    AND montant_brute_imposable.annee = pe.annee
    AND montant_brute_imposable.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('205')
    GROUP BY
    idpersonnel,
    mois,
    annee) indemnite_logement
    ON
    indemnite_logement.idpersonnel = lp.id
    AND indemnite_logement.annee = pe.annee
    AND indemnite_logement.mois = pe.mois
GROUP BY
    lp.ID,
    lpad(pe.MATRICULE, 5, '0'),
    pc.id,
    trim(TRAILING ' ' FROM lp.NOM),
    trim(TRAILING ' ' FROM lp.PRENOM),
    lp.NOM || ' ' || lp.PRENOM ,
    pf.DESCE,
    pf.id,
    pc.VAL ,
    ld.ID,
    ld.VAL,
    ls.ID,
    ls.CODE_SERVICE,
    ls.LIBELLE,
    pe.temporaire,
    nvl(SALAIREDEBASE.salairedebase, 0),
    nvl(heuresup.gain, 0),
    nvl(rappel.gain, 0),
    nvl(retenuabsc.retenue, 0),
    nvl(prime.gain, 0),
    nvl(net_a_payer.gain, 0),
    nvl(montant_brute_imposable.gain, 0),
    nvl(congepayer.gain, 0),
    nvl(preavis.gain, 0),
    nvl(hs30.gain, 0),
    nvl(hs50.gain, 0),
    nvl(indamdivfixe.gain, 0),
    nvl(totalgain.gain, 0),
    nvl(cnaps.retenue, 0),
    nvl(ostie.retenue, 0),
    nvl(salaire_brute.gain, 0),
    nvl(cnaps.retenue, 0),
    nvl(ostie.retenue, 0),
    nvl(irsa.retenue, 0),
    nvl(irsanet.retenue, 0),
    nvl(netimposable.retenue, 0),
    nvl(netimposablearr.retenue, 0),
    nvl(total_retenue.retenue, 0),
    nvl(avancesalaire.retenue, 0),
    nvl(avanceexcep.retenue, 0),
    nvl(cnaps_sans_complementaire.retenue, 0),
    nvl(cnaps_complementaire.retenue, 0),
    nvl(rappel.gain, 0),
    nvl(netpayer.gain, 0),
    nvl(netpayerarr.gain, 0),
    nvl(indemnite_logement.gain, 0),
    nvl(pe.tauxhoraire, 0),
    pip.MATRICULE,
    nvl(totalgain.gain,0),
    nvl(allocation.gain,0),
    173.33,
    nvl(poi.HEURENORMAL, 0),
    nvl(salaire.gain, 0),
    0,
    pip.nbenfant,
    pe.annee,
    pe.mois,
    pe.idedition;




CREATE OR REPLACE VIEW SITUATION_SALAIRE_EDITION AS
SELECT
    id,
    personnel,
    fonction,
    matricule,
    heuremois,
    heuremois as heurelegal,
    heurepresence,
    tauxhoraire,
    salaire,
    heurepresence*tauxhoraire as salairemois,
    heuresup,
    rappel,
    retenuabsc,
    prime,
    congepayer,
    preavis,
    indamdivfixe,
    salairebrute-nvl(allocation,0) as salairebrute,
    cnaps,
    ostie,
    netimposable,
    netimposablearr,
    irsa,
    nbenfant,
    irsanet,
    avancesalaire,
    avanceexcep,
    allocation as allocation,
    netpayer,
    netpayerarr,
    mois,
    annee
FROM (
         SELECT
             id,
             personnel,
             fonction,
             matricule,
             heuremois,
             heurepresence,
             tauxhoraire,
             salaire,
             heuresup,
             rappel,
             retenuabsc,
             prime,
             congepayer,
             preavis,
             indamdivfixe,
             salairebrute,
             cnaps,
             ostie,
             netimposable,
             netimposablearr,
             irsa,
             nbenfant,
             irsanet,
             avancesalaire,
             avanceexcep,
             allocation,
             netpayer,
             netpayerarr,
             mois,
             annee,
             ROW_NUMBER() OVER (PARTITION BY personnel ORDER BY id) as rn
         FROM TEST_SITUATION_SALAIRE_EDITION
     ) ranked_data
WHERE rn = 1;


CREATE OR REPLACE VIEW V_POINTAGE_TOTAL_HEURE_SUP AS
SELECT
    IDPERSONNEL,
    MOIS,
    ANNEE,
    (HEURESUPNORMAL + HEURESUPNUIT + HEURESUPFERIE + HEURESUPWEEKEND) AS TOTAL_HEURE_SUP
FROM
    POINTAGE
WHERE
    ETAT = 11
ORDER BY
    IDPERSONNEL, ANNEE, MOIS
;

CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS3 AS
SELECT paie_info_jours_mois2.id,
       round(sum(paie_info_jours_mois2.nbjoursvrai * paie_info_jours_mois2.conge_journalier), 1) AS jourconge
FROM paie_info_jours_mois2
GROUP BY paie_info_jours_mois2.id;


CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS3_BIS  AS
SELECT paie_info_jours_mois2_bis.id,
       round(sum(paie_info_jours_mois2_bis.nbjoursvrai * paie_info_jours_mois2_bis.conge_journalier), 1) AS jourconge
FROM paie_info_jours_mois2_bis
GROUP BY paie_info_jours_mois2_bis.id;


-- XCPROD2907.CONGE_DROIT source

CREATE OR REPLACE VIEW CONGE_DROIT AS
SELECT 'CONG-' || pip.id AS id,
       pip.id AS idpersonnel,
       0 AS mois,
       0 AS annee,
       (round(pijm.jourconge * 2) / 2) AS conge,
       11 AS etat
FROM paie_info_personnel pip
         LEFT JOIN paie_info_jours_mois3 pijm ON pip.id = pijm.id;



-- XCPROD2907.CONGE_DROIT_LIB source

CREATE OR REPLACE VIEW CONGE_DROIT_LIB AS
SELECT cd.id,
       (lp.nom || ' ') || lp.prenom AS idpersonnel,
       cd.mois,
       cd.annee,
       cd.conge,
       cd.etat,
       lp.matricule,
       CASE
           WHEN cd.etat = 1 THEN 'CREE(E)'
           WHEN cd.etat = 11 THEN 'VISE(E)'
           WHEN cd.etat <= 0 THEN 'ANNULE(E)'
           ELSE NULL
           END AS etatlib
FROM conge_droit cd
         JOIN log_personnel_infocomplet lp ON lp.id = cd.idpersonnel;

-- XCPROD2907.CONGE_DROIT_LIBCOMPLET source

CREATE OR REPLACE VIEW CONGE_DROIT_LIBCOMPLET AS
SELECT cd.id,
       cd.idpersonnel,
       cd.mois,
       cd.annee,
       cd.conge,
       cd.etat,
       (lp.nom || ' ') || lp.prenom AS idpersonnellib
FROM conge_droit cd
         JOIN log_personnel lp ON lp.id = cd.idpersonnel;

-- XCPROD2907.CONGE_DROIT_LIBCREE source

CREATE OR REPLACE VIEW CONGE_DROIT_LIBCREE AS
SELECT conge_droit_lib.id,
       conge_droit_lib.idpersonnel,
       conge_droit_lib.mois,
       conge_droit_lib.annee,
       conge_droit_lib.conge,
       conge_droit_lib.etat,
       conge_droit_lib.matricule,
       conge_droit_lib.etatlib
FROM conge_droit_lib
WHERE conge_droit_lib.etat = 1;

CREATE OR REPLACE VIEW CONGE_DROIT_LIBTOUS AS
SELECT conge_droit_lib.id,
       conge_droit_lib.idpersonnel,
       conge_droit_lib.mois,
       conge_droit_lib.annee,
       conge_droit_lib.conge,
       conge_droit_lib.etat,
       conge_droit_lib.matricule,
       conge_droit_lib.etatlib
FROM conge_droit_lib;
-- XCPROD2907.CONGE_DROIT_LIBVISE source

CREATE OR REPLACE VIEW CONGE_DROIT_LIBVISE AS
SELECT conge_droit_lib.id,
       conge_droit_lib.idpersonnel,
       conge_droit_lib.mois,
       conge_droit_lib.annee,
       conge_droit_lib.conge,
       conge_droit_lib.etat,
       conge_droit_lib.matricule,
       conge_droit_lib.etatlib
FROM conge_droit_lib
WHERE conge_droit_lib.etat = 11;


CREATE OR REPLACE VIEW ORGANIGRAMMELIB AS
SELECT o.id,
       o.desce,
       lp.id AS val,
       (lp.nom || ' ') || lp.prenom AS nompersonne,
       lp.matricule,
       pf.desce AS poste
FROM log_personnel_fin_valide lp
         LEFT JOIN organigramme o ON lp.id = o.val
         LEFT JOIN paie_info_personnel pip ON pip.id = lp.id
         LEFT JOIN paie_fonction pf ON pf.id = pip.idfonction
ORDER BY o.desce DESC NULLS LAST;
--
--
-- INSERT INTO CATEGORIE_PAIE
-- (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE)
-- VALUES('CP000001', 'OUVRIER', 'OUVRIER', 0, 'aucun', 'o', 3);
-- INSERT INTO CATEGORIE_PAIE
-- (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE)
-- VALUES('CP000004', 'CADRE', 'CADRE', 0, 'aucun', 'n', 6);
-- INSERT INTO CATEGORIE_PAIE
-- (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE)
-- VALUES('CP000003', 'TECHNICIEN', 'TECHNICIEN', 0, 'aucun', 'o', 3);
-- INSERT INTO CATEGORIE_PAIE
-- (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE)
-- VALUES('CP000005', 'CADRE SUPERIEUR', 'CADRE SUPERIEUR', 0, 'aucun', 'n', 6);
-- INSERT INTO CATEGORIE_PAIE
-- (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE)
-- VALUES('CP000006', 'HORS CATEGORIE', 'HORS CATEGORIE', 0, 'aucun', 'n', 6);
-- INSERT INTO CATEGORIE_PAIE
-- (ID, VAL, DESCE, MONTANT, REMARQUE, DROIT_HEURE_SUP, ESSAIE)
-- VALUES('CP000002', 'EMPLOYE', 'EMPLOYE', 0, 'aucun', 'o', 3);

-- INSERT INTO SITUATION_MATRIMONIALE
-- (ID, VAL, DESCE)
-- VALUES('SIT02', 'Marié', 'Marié');
-- INSERT INTO SITUATION_MATRIMONIALE
-- (ID, VAL, DESCE)
-- VALUES('SIT01', 'Célibataire', 'Célibataire');
-- INSERT INTO SITUATION_MATRIMONIALE
-- (ID, VAL, DESCE)
-- VALUES('SIT03', 'Divorcé(e)', 'Divorcé(e)');
-- INSERT INTO SITUATION_MATRIMONIALE
-- (ID, VAL, DESCE)
-- VALUES('SIT04', 'Veuf(ve)', 'Veuf(ve)');

-- INSERT INTO QUALIFICATION_PAIE
-- (ID, VAL, DESCE)
-- VALUES('QUAL0001', 'JUNIOR', 'JUNIOR');
-- INSERT INTO QUALIFICATION_PAIE
-- (ID, VAL, DESCE)
-- VALUES('QUAL0002', 'SENIOR', 'SENIOR');
-- INSERT INTO QUALIFICATION_PAIE
-- (ID, VAL, DESCE)
-- VALUES('QUAL0003', 'EXPERT', 'EXPERT');
-- INSERT INTO QUALIFICATION_PAIE
-- (ID, VAL, DESCE)
-- VALUES('QUAL0004', 'EXECUTIVE', 'EXECUTIVE');
--
-- INSERT INTO LOG_SERVICE
-- (ID, LIBELLE, CODE_DR, DR_RATTACHE, CODE_SERVICE)
-- VALUES('SERV00002', 'DIRECTION', 'DIR00001', 'DIR00001', 'DR');
-- INSERT INTO LOG_SERVICE
-- (ID, LIBELLE, CODE_DR, DR_RATTACHE, CODE_SERVICE)
-- VALUES('SERV00003', 'Département de production', 'DIR00001', 'DIR00001', 'DP');
-- INSERT INTO LOG_SERVICE
-- (ID, LIBELLE, CODE_DR, DR_RATTACHE, CODE_SERVICE)
-- VALUES('SERV00001', 'Ressource Humaine', 'DIR00001', 'DIR00001', 'XC');
--

-- CREATE SEQUENCE SEQ_PAIE_EDITION INCREMENT BY 1 MINVALUE 1 MAXVALUE 999999999999999999999999999 NOCYCLE NOCACHE NOORDER ;
CREATE OR REPLACE FUNCTION get_seq_paie_edition
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT seq_paie_edition.NEXTVAL into retour from dual;
RETURN retour;
END;

-- integration heure sup 50% NI

CREATE OR REPLACE VIEW HEURESUPFABRICATION_TOTAL AS
SELECT
    p.id AS idPersonne,
    pm.NOM AS idPersonnelib,
    p.MATRICULE,
    r.TAUXHORAIRE,
    CAST(NVL(c.montant,0)/((40*52)/12) AS NUMBER(30,2)) AS TAUXHORAIREEFFECTIVE,
    p.temporaire,
    TO_CHAR(fab.daty, 'IYYY-IW') AS semaine,
    SUM(h.HS) AS totalHeureSemaine
FROM HEURESUPFABRICATION h
         LEFT JOIN RESSOURCEPARFABRICATIONCOMPLET r ON r.id = h.IDRESSPARFAB
         LEFT JOIN PAIE_INFO_PERSONNEL p ON p.id = r.idRessource
         LEFT JOIN CATEGORIE_QUALIFICATION c ON c.IDQUALIFICATION = p.IDQUALIFICATION
         LEFT JOIN PERSONNEL_MATRICULE pm ON pm.id = r.IDRESSOURCE
         LEFT JOIN FABRICATION fab ON fab.ID = h.IDFABRICATION
GROUP BY p.id, pm.NOM, p.MATRICULE, r.TAUXHORAIRE, p.temporaire,
         TO_CHAR(fab.daty, 'IYYY-IW'), c.montant;


CREATE OR REPLACE VIEW HEURESUPFABRICATION_CUMUL AS
SELECT
    p.id AS idPersonne,
    pm.NOM AS idPersonnelib,
    p.MATRICULE,
    TO_CHAR(fab.daty, 'IYYY-IW') AS semaine,
    fab.daty AS jour,
    SUM(h.HS) AS heureJour,
    SUM(SUM(h.HS)) OVER (
        PARTITION BY p.id, TO_CHAR(fab.daty, 'IYYY-IW')
        ORDER BY fab.daty
        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) - SUM(h.HS) AS heureDejaCumulees
FROM HEURESUPFABRICATION h
         LEFT JOIN RESSOURCEPARFABRICATIONCOMPLET r ON r.id = h.IDRESSPARFAB
         LEFT JOIN PAIE_INFO_PERSONNEL p ON p.id = r.idRessource
         LEFT JOIN PERSONNEL_MATRICULE pm ON pm.id = r.IDRESSOURCE
         LEFT JOIN FABRICATION fab ON fab.ID = h.IDFABRICATION
WHERE h.ETAT >= 11
GROUP BY p.id, pm.NOM, p.MATRICULE, fab.daty;


CREATE OR REPLACE VIEW EMPLOYE_COMPLET_PDF AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       logp.sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       paie.adresse_ligne1 AS adresse,
       logp.fokotany,
       logp.nationalite,
       logp.acte_naissance,
       paie.situation_matrimonial,
       paie.idconjoint,
       logp.direction,
       logp.service,
       fonct.desce AS idfonction,
       paie.ctg,
       paie.idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       paie.mode_paiement,
       paie.code_agence_banque,
       paie.banque_numero_compte,
       paie.banque_compte_cle,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       ld.val AS code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.etat,
       paie.vehiculee,
       tab.date_dernierpromo,
       paie.droit_hs,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       paie.nbenfant,
       paie.indesirable,
       cp.essaie AS duree,
       paie.telephone,
       paie.mail,
       cp.val AS idcategorie_paie,
       qp.val AS idqualification,
       paie.discipline,
       paie.formation,
       paie.anneeexperience,
       cq.montant,
       cd.resteconge AS conger
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN paie_fonction fonct ON fonct.id = paie.idfonction
         LEFT JOIN categorie_paie cp ON cp.id = paie.idcategorie_paie
         LEFT JOIN qualification_paie qp ON qp.id = paie.idqualification
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = paie.idcategorie_paie AND cq.idqualification = paie.idqualification AND cq.remarque = logp.id AND cq.etat = 1
         LEFT JOIN log_direction ld ON ld.id = logp.direction
         LEFT JOIN log_personnel_fin cd ON cd.id = logp.id;

CREATE OR REPLACE VIEW SITUATION_SALAIRE_EDITION  AS
SELECT
    id,
    personnel,
    fonction,
    matricule,
    heuremois,
    heuremois as heurelegal,
    heurepresence,
    tauxhoraire,
    salaire,
    heurepresence*tauxhoraire as salairemois,
    heuresup,
    rappel,
    retenuabsc,
    prime,
    congepayer,
    preavis,
    indamdivfixe,
    salairebrute-nvl(allocation,0) as salairebrute,
    cnaps,
    ostie,
    netimposable,
    netimposablearr,
    irsa,
    nbenfant,
    irsanet,
    avancesalaire,
    avanceexcep,
    allocation as allocation,
    netpayer,
    netpayerarr,
    mois,
    annee
FROM (
         SELECT
             id,
             personnel,
             fonction,
             matricule,
             heuremois,
             heurepresence,
             tauxhoraire,
             salaire,
             heuresup,
             rappel,
             retenuabsc,
             prime,
             congepayer,
             preavis,
             indamdivfixe,
             salairebrute,
             cnaps,
             ostie,
             netimposable,
             netimposablearr,
             irsa,
             nbenfant,
             irsanet,
             avancesalaire,
             avanceexcep,
             allocation,
             netpayer,
             netpayerarr,
             mois,
             annee,
             ROW_NUMBER() OVER (PARTITION BY personnel ORDER BY id) as rn
         FROM TEST_SITUATION_SALAIRE_EDITION
     ) ranked_data
WHERE rn = 1;


CREATE OR REPLACE VIEW TEST_SITUATION_SALAIRE_EDITION AS
SELECT
    lp.ID,
    pe.idedition AS idedition,
    pip.nbenfant,
    pip.MATRICULE,
    trim(TRAILING ' ' FROM lp.NOM) AS nom,
    trim(TRAILING ' ' FROM lp.PRENOM) AS prenom,
    trim(TRAILING ' ' FROM lp.NOM)
        || ' '
        || trim(TRAILING ' ' FROM lp.PRENOM) AS personnel,
    pf.desce AS fonction,
    pf.id AS idfonction,
    pc.VAL AS classification,
    pc.id AS idcategorie,
    ld.ID AS iddirection,
    ld.VAL AS direction,
    ls.ID AS SECTION,
    ls.CODE_SERVICE AS section_numero,
    ls.libelle AS section_libelle,
    nvl(SALAIREDEBASE.salairedebase, 0) AS salaire,
    nvl(totalgain.gain,0) as salairebrute,
    173.33 as heuremois,
    nvl(poi.HEURENORMAL, 0) AS heurepresence,
    nvl(pe.tauxhoraire, 0) AS tauxhoraire,
    nvl(salaire.gain, 0) AS salairemois,
    nvl(heuresup.gain, 0) AS heuresup,
    nvl(rappel.gain, 0) AS rappel,
    nvl(retenuabsc.retenue, 0) AS retenuabsc,
    nvl(prime.gain, 0) AS prime,
    nvl(congepayer.gain, 0) AS congepayer,
    nvl(preavis.gain, 0) AS preavis,
    nvl(netpayer.gain, 0) AS netpayer,
    nvl(netpayerarr.gain, 0) AS netpayerarr,
    nvl(indamdivfixe.gain, 0) AS indamdivfixe,
    nvl(cnaps.retenue, 0) AS cnaps,
    nvl(ostie.retenue, 0) AS ostie,
    nvl(netimposable.retenue, 0) AS netimposable,
    nvl(netimposablearr.retenue, 0) AS netimposablearr,
    nvl(irsa.retenue, 0) AS irsa,
    nvl(irsanet.retenue, 0) AS irsanet,
    nvl(allocation.gain,0) as allocation,
    nvl(avancesalaire.retenue, 0) AS avancesalaire,
    nvl(avanceexcep.retenue, 0) AS avanceexcep,
    pe.annee,
    pe.mois
FROM -- select * from
    paie_edition pe
    INNER JOIN log_personnel lp ON
    lp.id = pe.idpersonnel
    INNER JOIN paie_info_personnel pip ON
    pip.id = pe.idpersonnel
    INNER JOIN log_direction ld ON
    pe.DIRECTION = ld.ID
    INNER JOIN log_service ls ON
    pe.SERVICE = ls.ID
    INNER JOIN CATEGORIE_PAIE pc ON
    pe.IDCATEGORIE = pc.ID
    INNER JOIN paie_fonction pf ON
    pe.IDFONCTION = pf.ID
    INNER JOIN POINTAGE poi ON
    pe.IDPERSONNEL = poi.IDPERSONNEL
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 1
    GROUP BY
    idpersonnel,
    mois,
    annee) salaire
    ON
    salaire.idpersonnel = lp.id
    AND salaire.annee = pe.annee
    AND salaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    max(SALAIREDEBASE) AS salairedebase,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 18
    GROUP BY
    idpersonnel,
    mois,
    annee) salairedebase
    ON
    salairedebase.idpersonnel = lp.id
    AND salairedebase.annee = pe.annee
    AND salairedebase.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 2
    GROUP BY
    idpersonnel,
    mois,
    annee) heuresup
    ON
    heuresup.idpersonnel = lp.id
    AND heuresup.annee = pe.annee
    AND heuresup.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 3
    GROUP BY
    idpersonnel,
    mois,
    annee) rappel
    ON
    rappel.idpersonnel = lp.id
    AND rappel.annee = pe.annee
    AND rappel.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(RETENUE) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 4
    GROUP BY
    idpersonnel,
    mois,
    annee) retenuabsc
    ON
    retenuabsc.idpersonnel = lp.id
    AND retenuabsc.annee = pe.annee
    AND retenuabsc.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 5
    GROUP BY
    idpersonnel,
    mois,
    annee) prime
    ON
    prime.idpersonnel = lp.id
    AND prime.annee = pe.annee
    AND prime.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('403', '4030')
    GROUP BY
    idpersonnel,
    mois,
    annee) hs30
    ON
    hs30.idpersonnel = lp.id
    AND hs30.annee = pe.annee
    AND hs30.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('405', '4050')
    GROUP BY
    idpersonnel,
    mois,
    annee) hs50
    ON
    hs50.idpersonnel = lp.id
    AND hs50.annee = pe.annee
    AND hs50.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 6
    GROUP BY
    idpersonnel,
    mois,
    annee) congepayer
    ON
    congepayer.idpersonnel = lp.id
    AND congepayer.annee = pe.annee
    AND congepayer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 7
    GROUP BY
    idpersonnel,
    mois,
    annee) preavis
    ON
    preavis.idpersonnel = lp.id
    AND preavis.annee = pe.annee
    AND preavis.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 8
    GROUP BY
    idpersonnel,
    mois,
    annee) indamdivfixe
    ON
    indamdivfixe.idpersonnel = lp.id
    AND indamdivfixe.annee = pe.annee
    AND indamdivfixe.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 9
    GROUP BY
    idpersonnel,
    mois,
    annee) totalgain
    ON
    totalgain.idpersonnel = lp.id
    AND totalgain.annee = pe.annee
    AND totalgain.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 10
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps
    ON
    cnaps.idpersonnel = lp.id
    AND cnaps.annee = pe.annee
    AND cnaps.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('700', '701')
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps_sans_complementaire
    ON
    cnaps_sans_complementaire.idpersonnel = lp.id
    AND cnaps_sans_complementaire.annee = pe.annee
    AND cnaps_sans_complementaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('705', '706')
    GROUP BY
    idpersonnel,
    mois,
    annee) cnaps_complementaire
    ON
    cnaps_complementaire.idpersonnel = lp.id
    AND cnaps_complementaire.annee = pe.annee
    AND cnaps_complementaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 11
    GROUP BY
    idpersonnel,
    mois,
    annee) ostie
    ON
    ostie.idpersonnel = lp.id
    AND ostie.annee = pe.annee
    AND ostie.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 12
    GROUP BY
    idpersonnel,
    mois,
    annee) netimposable
    ON
    netimposable.idpersonnel = lp.id
    AND netimposable.annee = pe.annee
    AND netimposable.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 13
    GROUP BY
    idpersonnel,
    mois,
    annee) netimposablearr
    ON
    netimposablearr.idpersonnel = lp.id
    AND netimposablearr.annee = pe.annee
    AND netimposablearr.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 14
    GROUP BY
    idpersonnel,
    mois,
    annee) irsa
    ON
    irsa.idpersonnel = lp.id
    AND irsa.annee = pe.annee
    AND irsa.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 15
    GROUP BY
    idpersonnel,
    mois,
    annee) irsanet
    ON
    irsanet.idpersonnel = lp.id
    AND irsanet.annee = pe.annee
    AND irsanet.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(RETENUE) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 16
    GROUP BY
    idpersonnel,
    mois,
    annee) avancesalaire
    ON
    avancesalaire.idpersonnel = lp.id
    AND avancesalaire.annee = pe.annee
    AND avancesalaire.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 17
    GROUP BY
    idpersonnel,
    mois,
    annee) avanceexcep
    ON
    avanceexcep.idpersonnel = lp.id
    AND avanceexcep.annee = pe.annee
    AND avanceexcep.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 18
    GROUP BY
    idpersonnel,
    mois,
    annee) netpayer
    ON
    netpayer.idpersonnel = lp.id
    AND netpayer.annee = pe.annee
    AND netpayer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 19
    GROUP BY
    idpersonnel,
    mois,
    annee) netpayerarr
    ON
    netpayerarr.idpersonnel = lp.id
    AND netpayerarr.annee = pe.annee
    AND netpayerarr.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 20
    GROUP BY
    idpersonnel,
    mois,
    annee) allocation
    ON
    allocation.idpersonnel = lp.id
    AND allocation.annee = pe.annee
    AND allocation.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    regroupement = 100
    GROUP BY
    idpersonnel,
    mois,
    annee) net_a_payer
    ON
    net_a_payer.idpersonnel = lp.id
    AND net_a_payer.annee = pe.annee
    AND net_a_payer.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe
    WHERE
    (regroupement != 100
    OR regroupement IS NULL)
    GROUP BY
    idpersonnel,
    mois,
    annee) salaire_brute
    ON
    salaire_brute.idpersonnel = lp.id
    AND salaire_brute.annee = pe.annee
    AND salaire_brute.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(retenue) AS retenue,
    mois,
    annee
    FROM
    paie_edition pe
    GROUP BY
    idpersonnel,
    mois,
    annee) total_retenue
    ON
    total_retenue.idpersonnel = lp.id
    AND total_retenue.annee = pe.annee
    AND total_retenue.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    paie_edition pe,
    paie_rubrique pr
    WHERE
    pr.id = pe.idelementpaie
    AND pr.imposable = 'I'
    GROUP BY
    idpersonnel,
    mois,
    annee) montant_brute_imposable
    ON
    montant_brute_imposable.idpersonnel = lp.id
    AND montant_brute_imposable.annee = pe.annee
    AND montant_brute_imposable.mois = pe.mois
    LEFT JOIN (
    SELECT
    idpersonnel,
    sum(gain) AS gain,
    mois,
    annee
    FROM
    PAIE_EDITION_LIBCOMPLET pe
    WHERE
    CODERUBRIQUE IN ('205')
    GROUP BY
    idpersonnel,
    mois,
    annee) indemnite_logement
    ON
    indemnite_logement.idpersonnel = lp.id
    AND indemnite_logement.annee = pe.annee
    AND indemnite_logement.mois = pe.mois
GROUP BY
    lp.ID,
    lpad(pe.MATRICULE, 5, '0'),
    pc.id,
    trim(TRAILING ' ' FROM lp.NOM),
    trim(TRAILING ' ' FROM lp.PRENOM),
    lp.NOM || ' ' || lp.PRENOM ,
    pf.DESCE,
    pf.id,
    pc.VAL ,
    ld.ID,
    ld.VAL,
    ls.ID,
    ls.CODE_SERVICE,
    ls.LIBELLE,
    pe.temporaire,
    nvl(SALAIREDEBASE.salairedebase, 0),
    nvl(heuresup.gain, 0),
    nvl(rappel.gain, 0),
    nvl(retenuabsc.retenue, 0),
    nvl(prime.gain, 0),
    nvl(net_a_payer.gain, 0),
    nvl(montant_brute_imposable.gain, 0),
    nvl(congepayer.gain, 0),
    nvl(preavis.gain, 0),
    nvl(hs30.gain, 0),
    nvl(hs50.gain, 0),
    nvl(indamdivfixe.gain, 0),
    nvl(totalgain.gain, 0),
    nvl(cnaps.retenue, 0),
    nvl(ostie.retenue, 0),
    nvl(salaire_brute.gain, 0),
    nvl(cnaps.retenue, 0),
    nvl(ostie.retenue, 0),
    nvl(irsa.retenue, 0),
    nvl(irsanet.retenue, 0),
    nvl(netimposable.retenue, 0),
    nvl(netimposablearr.retenue, 0),
    nvl(total_retenue.retenue, 0),
    nvl(avancesalaire.retenue, 0),
    nvl(avanceexcep.retenue, 0),
    nvl(cnaps_sans_complementaire.retenue, 0),
    nvl(cnaps_complementaire.retenue, 0),
    nvl(rappel.gain, 0),
    nvl(netpayer.gain, 0),
    nvl(netpayerarr.gain, 0),
    nvl(indemnite_logement.gain, 0),
    nvl(pe.tauxhoraire, 0),
    pip.MATRICULE,
    nvl(totalgain.gain,0),
    nvl(allocation.gain,0),
    173.33,
    nvl(poi.HEURENORMAL, 0),
    nvl(salaire.gain, 0),
    0,
    pip.nbenfant,
    pe.annee,
    pe.mois,
    pe.idedition;




CREATE OR REPLACE VIEW V_POINTAGE_TOTAL_HEURE_SUP AS
SELECT
    IDPERSONNEL,
    MOIS,
    ANNEE,
    (HEURESUPNORMAL + HEURESUPNUIT + HEURESUPFERIE + HEURESUPWEEKEND) AS TOTAL_HEURE_SUP
FROM
    POINTAGE
WHERE
    ETAT = 11
ORDER BY
    IDPERSONNEL, ANNEE, MOIS
;


CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS AS
SELECT
    pip.id,
    pip.dateembauche,
    pip.date_depart,
    j.annee,
    j.mois,
    j.nb_jour,
    j.conge_journalier,
    0 AS jourplusdepart,
    CASE
        WHEN j.annee = EXTRACT(YEAR FROM pip.dateembauche)
            AND j.mois = EXTRACT(MONTH FROM pip.dateembauche)
            THEN EXTRACT(DAY FROM pip.dateembauche)
        ELSE 0
        END AS jourplusembauche
FROM
    paie_info_personnel pip,
    jours_par_mois j
WHERE
    TO_DATE(j.annee || LPAD(j.mois, 2, '0'), 'YYYYMM') >=
    TO_DATE(TO_CHAR(pip.dateembauche, 'YYYYMM'), 'YYYYMM')
  AND pip.date_depart IS NULL

UNION

SELECT
    pip.id,
    pip.dateembauche,
    pip.date_depart,
    j.annee,
    j.mois,
    j.nb_jour,
    j.conge_journalier,
    CASE
        WHEN j.annee = EXTRACT(YEAR FROM pip.date_depart)
            AND j.mois = EXTRACT(MONTH FROM pip.date_depart)
            THEN EXTRACT(DAY FROM pip.date_depart)
        ELSE 0
        END AS jourplusdepart,
    CASE
        WHEN j.annee = EXTRACT(YEAR FROM pip.dateembauche)
            AND j.mois = EXTRACT(MONTH FROM pip.dateembauche)
            THEN EXTRACT(DAY FROM pip.dateembauche)
        ELSE 0
        END AS jourplusembauche
FROM
    paie_info_personnel pip,
    jours_par_mois j
WHERE
    TO_DATE(j.annee || LPAD(j.mois, 2, '0'), 'YYYYMM') >=
    TO_DATE(TO_CHAR(pip.dateembauche, 'YYYYMM'), 'YYYYMM')
  AND pip.date_depart IS NOT NULL
  AND TO_DATE(j.annee || LPAD(j.mois, 2, '0'), 'YYYYMM') <=
      TO_DATE(TO_CHAR(pip.date_depart, 'YYYYMM'), 'YYYYMM');




CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS2 AS
SELECT p.id,
       p.dateembauche,
       p.date_depart,
       p.annee,
       p.mois,
       p.nb_jour,
       p.conge_journalier,
       p.jourplusdepart,
       p.jourplusembauche,
       CASE
           WHEN p.jourplusdepart > 0 AND p.jourplusembauche = 0 THEN p.jourplusdepart
           WHEN p.jourplusdepart = 0 AND p.jourplusembauche > 0 THEN p.nb_jour - p.jourplusembauche + 1
           WHEN p.jourplusdepart > 0 AND p.jourplusembauche > 0 THEN p.jourplusdepart - p.jourplusembauche
           WHEN p.annee = EXTRACT(YEAR FROM sysdate ) AND p.mois = EXTRACT(MONTH  FROM sysdate ) THEN EXTRACT(DAY FROM sysdate )
           ELSE p.nb_jour
           END AS nbjoursvrai
FROM paie_info_jours_mois p;

CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS2_BIS  AS
SELECT pijm.id,
       pijm.dateembauche,
       pijm.date_depart,
       pijm.annee,
       pijm.mois,
       pijm.nb_jour,
       pijm.conge_journalier,
       pijm.jourplusdepart,
       pijm.jourplusembauche,
       pijm.nbjoursvrai
FROM paie_info_jours_mois2 pijm
WHERE pijm.dateembauche <= TO_DATE('2024-01-01', 'YYYY-MM-DD')
  AND pijm.annee >= 2024;


CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS3 AS
SELECT paie_info_jours_mois2.id,
       round(sum(paie_info_jours_mois2.nbjoursvrai * paie_info_jours_mois2.conge_journalier), 1) AS jourconge
FROM paie_info_jours_mois2
GROUP BY paie_info_jours_mois2.id;



CREATE OR REPLACE VIEW PAIE_INFO_JOURS_MOIS3_BIS AS
SELECT paie_info_jours_mois2_bis.id,
       round(sum(paie_info_jours_mois2_bis.nbjoursvrai * paie_info_jours_mois2_bis.conge_journalier), 1) AS jourconge
FROM paie_info_jours_mois2_bis
GROUP BY paie_info_jours_mois2_bis.id;



CREATE OR REPLACE VIEW CONGE_DROIT AS
SELECT 'CONG-' || pip.id AS id,
       pip.id AS idpersonnel,
       0 AS mois,
       0 AS annee,
       (round(pijm.jourconge * 2) / 2) AS conge,
       11 AS etat
FROM paie_info_personnel pip
         LEFT JOIN paie_info_jours_mois3 pijm ON pip.id = pijm.id;


CREATE OR REPLACE VIEW CONGE_DROIT_LIBCOMPLET AS
SELECT cd.id,
       cd.idpersonnel,
       cd.mois,
       cd.annee,
       cd.conge,
       cd.etat,
       (lp.nom || ' ') || lp.prenom AS idpersonnellib
FROM conge_droit cd
         JOIN log_personnel lp ON lp.id = cd.idpersonnel;


ALTER TABLE PAIE_EDITIONMOISANNEE ADD dateOuverture DATE;
ALTER TABLE PAIE_EDITIONMOISANNEE ADD dateFermeture DATE;

ALTER TABLE HEURESUPFABRICATION ADD MONTANTJFHD NUMBER(10, 2);

CREATE OR REPLACE VIEW HEURESUPFABRICATION_CPL  AS
SELECT
    h.ID,h.IDRESSPARFAB,h.HEURENORMALE ,h.HS,h.MN,h.JF,h.HD,h.IF,h.ETAT,h.REMARQUE,
    p.id AS  idPersonne,
    h.idFabrication,
    fab.daty as dateFabrication,
    CASE
        WHEN h.etat=0
            THEN 'ANNULEE'
        WHEN h.etat=1
            THEN 'CREE'
        WHEN h.etat=11
            THEN 'VISEE'
        END AS etatlib,
    pm.NOM || ' ' || pm.PRENOM AS idPersonnelib,
    p.MATRICULE,
    r.TAUXHORAIRE,
    CAST(nvl(c.montant,0)/((40*52)/12) AS NUMBER(30,2) ) AS TAUXHORAIREEFFECTIVE,
    p.temporaire,
    h.MONTANT,
    h.MONTANTJFHD
FROM HEURESUPFABRICATION h
         LEFT JOIN RESSOURCEPARFABRICATIONCOMPLET r ON r.id = h.IDRESSPARFAB
         LEFT JOIN PAIE_INFO_PERSONNEL p ON p.id = r.idRessource
         LEFT JOIN CATEGORIE_QUALIFICATION c ON c.IDQUALIFICATION = p.IDQUALIFICATION
         LEFT JOIN LOG_PERSONNEL pm ON pm.id = r.IDRESSOURCE
         LEFT JOIN FABRICATION fab ON fab.ID = h.IDFABRICATION;


CREATE OR REPLACE  VIEW HEURESUPFABRICATION_CPL_VISEE  AS
SELECT
    ID,IDRESSPARFAB,HS,MN,JF,HD,IF,ETAT,IDPERSONNE,IDFABRICATION,ETATLIB,IDPERSONNELIB,MONTANT, MATRICULE, MONTANTJFHD
FROM heureSupFabrication_cpl WHERE etat = 11;

create or replace view V_PAIEMENT_HEURESUP as
SELECT
    ID,IDPERSONNE as idPersonnel,IDFABRICATION,ETATLIB,IDPERSONNELIB as nomPersonnel, MATRICULE,MONTANT, MONTANTJFHD
FROM HEURESUPFABRICATION_CPL_VISEE WHERE MONTANTJFHD > 0;

create or replace view HEURESUPFABRICATION_CPL as
SELECT
    h.ID,h.IDRESSPARFAB,h.HEURENORMALE ,h.HS,h.MN,h.JF,h.HD,h.IF,h.ETAT,h.REMARQUE,
    p.id AS  idPersonne,
    h.idFabrication,
    fab.daty as dateFabrication,
    CASE
        WHEN h.etat=0
            THEN 'ANNULEE'
        WHEN h.etat=1
            THEN 'CREE'
        WHEN h.etat=11
            THEN 'VISEE'
        END AS etatlib,
    pm.NOM || ' ' || pm.PRENOM AS idPersonnelib,
    p.MATRICULE,
    r.TAUXHORAIRE,
    CAST(nvl(c.montant,0)/((40*52)/12) AS NUMBER(30,2) ) AS TAUXHORAIREEFFECTIVE,
    p.temporaire,
    h.MONTANT,
    h.MONTANTJFHD
FROM HEURESUPFABRICATION h
         LEFT JOIN RESSOURCEPARFABRICATIONCOMPLET r ON r.id = h.IDRESSPARFAB
         LEFT JOIN PAIE_INFO_PERSONNEL p ON p.id = r.idRessource
         LEFT JOIN CATEGORIE_QUALIFICATION c ON c.IDQUALIFICATION = p.IDQUALIFICATION
         LEFT JOIN LOG_PERSONNEL pm ON pm.id = r.IDRESSOURCE
         LEFT JOIN FABRICATION fab ON fab.ID = h.IDFABRICATION;


CREATE SEQUENCE seqpaiemenths
    START WITH 1
    INCREMENT BY 1
    NOCACHE
    NOCYCLE;


CREATE OR REPLACE FUNCTION getseqpaiemenths
    RETURN NUMBER
    IS
    retour   NUMBER;
BEGIN
SELECT seqpaiemenths.NEXTVAL INTO retour FROM DUAL;
RETURN retour;
END;

-- DROP TABLE PAIEMENTHEURESUP;

CREATE TABLE PAIEMENTHEURESUP
(	 ID VARCHAR2(100) NOT NULL ENABLE,
      IDMVTCAISSE VARCHAR2(100),
      IDHS VARCHAR2(100),
      IDFABRICATION VARCHAR2(100),
      MONTANT NUMBER(30,2),
      DATY DATE,
      ETAT NUMBER(*,0)
) ;

create or replace view V_PAIEMENT_HEURESUP as
SELECT
    "IDPERSONNE" as id, "ID" AS idHs,"IDFABRICATION","ETATLIB","IDPERSONNELIB" as nomPersonnel, "MATRICULE","MONTANT", "MONTANTJFHD"
FROM HEURESUPFABRICATION_CPL_VISEE WHERE MONTANTJFHD > 0;

CREATE OR REPLACE VIEW PAIEMENTHS_CPL AS
SELECT
    ps.ID,
    hs.IDPERSONNE as idPersonnel,
    hs.IDPERSONNELIB as nomPersonnel,
    hs.MATRICULE,
    ps.IDMVTCAISSE, ps.IDHS, ps.IDFABRICATION, ps.MONTANT, ps.DATY, ps.ETAT,
    CASE
        WHEN ps.etat=0
            THEN 'ANNULEE'
        WHEN ps.etat=1
            THEN 'CREE'
        WHEN ps.etat=11
            THEN 'VISEE'
        END AS etatlib

FROM PAIEMENTHEURESUP ps
         LEFT JOIN HEURESUPFABRICATION_CPL hs ON hs.ID = ps.IDHS;

CREATE OR REPLACE VIEW PAIEMENTHS_CPL_CREE AS
SELECT
    pc.ID, idPersonnel, nomPersonnel, MATRICULE, IDMVTCAISSE, IDHS, IDFABRICATION, MONTANT, DATY, ETAT, etatlib

FROM PAIEMENTHS_CPL pc WHERE pc.ETAT = 1;


CREATE OR REPLACE VIEW PAIEMENTHS_CPL_VISEE AS
SELECT
    pc.ID, idPersonnel, nomPersonnel, MATRICULE, IDMVTCAISSE, IDHS, IDFABRICATION, MONTANT, DATY, ETAT, etatlib

FROM PAIEMENTHS_CPL pc WHERE pc.ETAT >= 11;

CREATE OR REPLACE FUNCTION GET_SEQ_LOG_SERVICE
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT SEQ_LOG_SERVICE.NEXTVAL into retour from dual;
RETURN retour;
END;




CREATE OR REPLACE  VIEW ABSENCE_LIBCOMPLET AS
SELECT
    ab.id,
    ab.idpersonnel,
    ab.type,
    ab.motif,
    ab.valeur,
    ab.daty,
    ab.annee_cible,
    ab.etat,
    lp.nom || ' ' || lp.prenom AS idpersonnellib,
    ta.val AS typelib,
    ab.datesaisie,
    ab.datyfin,
    CAST(lp.matricule AS VARCHAR2(50)) AS matricule,
    lp.resteconge,
    CASE
        WHEN ab.etat = 1 THEN 'CREE(E)'
        WHEN ab.etat = 11 THEN 'VISE(E)'
        WHEN ab.etat < 0 THEN 'ANNULE(E)'
        WHEN ab.etat = 10 THEN 'VALIDE(E)'
        ELSE NULL
        END AS etatlib
FROM absence ab
         JOIN log_personnel_fin lp ON TO_CHAR(lp.id) = TO_CHAR(ab.idpersonnel)
         JOIN type_absence ta ON TO_CHAR(ta.id) = TO_CHAR(ab.type);


CREATE OR REPLACE VIEW ABSENCE_LIBTOUS AS
SELECT
    ab.id,
    TO_CHAR(ab.idpersonnel)       AS idpersonnel,
    ab.typelib                    AS type,
    ab.motif,
    ab.valeur,
    ab.daty,
    ab.annee_cible,
    ab.etat,
    ab.datyfin,
    ab.datesaisie,
    ab.idpersonnellib,
    ab.matricule,
    ab.resteconge,
    ab.etatlib,
    o.desce                      AS rangorg
FROM absence_libcomplet ab
         LEFT JOIN organigramme o
                   ON TO_CHAR(o.val) = TO_CHAR(ab.idpersonnel);




CREATE OR REPLACE VIEW DETAILS_ELT_PAIE AS
SELECT
    pe.idpersonnel AS id ,
    pe.idelementpaie,
    pe.mois,
    pe.annee,
    pe.gain,
    pe.retenue,
    pe.idedition,
    pr.DESCE AS desceRubrique,
    pr.VAL AS valRubrique,
    ec.nom || ' ' || ec.prenom AS nomComplet,
    ec.MATRICULE,
    TO_CHAR(
            TO_DATE(TO_CHAR(pe.mois, 'FM00'), 'MM'),
            'FMMonth',
            'NLS_DATE_LANGUAGE=FRENCH'
    ) AS moisLib

FROM (SELECT * from PAIE_EDITION_STC WHERE idelementpaie NOT IN('PRUSIS014','PRUSIS015','PR000141NET','PR000210Z','PRUNIARD','PRUNI','PR000210A')) pe
         LEFT JOIN PAIE_RUBRIQUE pr ON pr.id = pe.IDELEMENTPAIE
         LEFT JOIN EMPLOYE_COMPLET ec ON ec.id = pe.IDPERSONNEL ;


CREATE OR REPLACE VIEW DETAILS_ELT_PAIE_ALL AS
SELECT
    pe.idpersonnel AS id,
    pe.idelementpaie,
    pe.mois,
    pe.annee,
    pe.gain,
    pe.retenue,
    pe.idedition,
    pr.DESCE AS desceRubrique,
    pr.VAL AS valRubrique,
    ec.nom || ' ' || ec.prenom AS nomComplet,
    ec.MATRICULE,
    TO_CHAR(
            TO_DATE(TO_CHAR(pe.mois, 'FM00'), 'MM'),
            'FMMonth',
            'NLS_DATE_LANGUAGE=FRENCH'
    ) AS moisLib,
    pr.TYPERUBRIQUE,
    pr.RANG
FROM PAIE_EDITION_STC pe
         LEFT JOIN PAIE_RUBRIQUE pr ON pr.id = pe.IDELEMENTPAIE AND (pe.IDELEMENTPAIE !='PR000210A' AND pe.IDELEMENTPAIE !='PRUNI' AND pe.IDELEMENTPAIE!='PR000141')
         LEFT JOIN EMPLOYE_COMPLET ec ON ec.id = pe.IDPERSONNEL
WHERE pr.TYPERUBRIQUE IN ('G', 'R') ORDER BY pr.RANG ;


CREATE OR REPLACE VIEW DETAILS_ELT_PAIE_SANSTOTAL AS
SELECT
    pe.idpersonnel AS id,
    pe.idelementpaie,
    pe.mois,
    pe.annee,
    pe.gain,
    pe.retenue,
    pe.idedition,
    pr.DESCE AS desceRubrique,
    pr.VAL AS valRubrique,
    ec.nom || ' ' || ec.prenom AS nomComplet,
    ec.MATRICULE,
    TO_CHAR(
            TO_DATE(TO_CHAR(pe.mois, 'FM00'), 'MM'),
            'FMMonth',
            'NLS_DATE_LANGUAGE=FRENCH'
    ) AS moisLib,
    pr.TYPERUBRIQUE,
    pr.RANG
FROM PAIE_EDITION_STC pe
         LEFT JOIN PAIE_RUBRIQUE pr ON pr.id = pe.IDELEMENTPAIE AND (pe.IDELEMENTPAIE !='PR000210A' AND pe.IDELEMENTPAIE !='PRUNI' AND pe.IDELEMENTPAIE!='PR000141' AND pe.IDELEMENTPAIE != 'PR000210Z' AND pe.IDELEMENTPAIE!='PRUSIS015' AND pe.IDELEMENTPAIE!='PRUSIS014')
         LEFT JOIN EMPLOYE_COMPLET ec ON ec.id = pe.IDPERSONNEL
WHERE pr.TYPERUBRIQUE IN ('G', 'R') ORDER BY pr.RANG

;

UPDATE MENUDYNAMIQUE
SET
    HREF    = 'module.jsp?but=paie/editions/paieedition-analyse2.jsp' WHERE ID='MENDYN002';
UPDATE MENUDYNAMIQUE
SET
    HREF    = 'module.jsp?but=paie/editions/paieedition-analyse3.jsp' WHERE ID='MENDYN003';


create table PAIEMENTAVANCE
(
    ID  VARCHAR2(100) not null PRIMARY KEY ,
    IDAVANCE VARCHAR2(100),
    datePaiement DATE,
    MOIS NUMBER,
    ANNEE NUMBER,
    MONTANT NUMBER(10,2),
    MODEPAIEMENT VARCHAR2(100),
    DEBITERSALAIRE NUMBER(1),
    ETAT NUMBER
);

ALTER TABLE REMBOURSEMENT ADD AVENANT NUMBER;

DROP SEQUENCE SEQPAIEMENTAVANCE;

CREATE SEQUENCE SEQPAIEMENTAVANCE
    START WITH 1
    INCREMENT BY 1
    NOCACHE
    NOCYCLE;

CREATE OR REPLACE FUNCTION getseqpaiementavance
    RETURN NUMBER IS
    retour NUMBER;
BEGIN
SELECT SEQPAIEMENTAVANCE.nextval INTO retour FROM dual;
return retour;
END;

UPDATE MENUDYNAMIQUE SET ID_PERE='' WHERE ID='MD000000040025';

create or replace view RECAPITULATIF_ALL_FINAL as
SELECT rs.mois,
       rs.annee,
       rs.salaire,
       rs.indemnite,
--        rs.heuresup,
       rs.avantage_en_nature,
       rs.salaire_brut,
       rs.irsa,
       rs.cnaps_travailleur,
       CAST(rs.montant_net_payer AS NUMBER(30, 2)) AS MONTANT_NET_PAYER,
       rs.cnaps_employeur,
       rs.cnaps_a_payer,
       frm.total_frm,
       rs.id,
       TO_CHAR(
               TO_DATE(TO_CHAR(rs.mois, 'FM00'), 'MM'),
               'FMMonth',
               'NLS_DATE_LANGUAGE=FRENCH'
       ) AS moisLib
FROM recapitulatif_salaire_all rs
         LEFT JOIN frm_mois_annee frm ON rs.mois = frm.mois AND rs.annee = frm.annee;
CREATE OR REPLACE VIEW PAIE_INFO_PERSONNEL_LIB4  AS
SELECT info.id,
       info.datesaisie,
       info.matricule,
       info.lieu_naissance_commune,
       info.lieu_delivrance_cin,
       sitmat.desce AS situation_matrimonial,
       info.initiale,
       info.cturgence_nom_prenom,
       info.cturgence_telephone1,
       info.cturgence_telephone2,
       info.cturgence_telephone3,
       (sig_personnes.pers_nom || ' ') || sig_personnes.pers_prenom AS idconjoint,
       agence.desce AS code_agence_banque,
       info.banque_numero_compte,
       info.banque_compte_cle,
       info.dateembauche,
       fonct.desce AS idfonction,
       cat.val AS idcategorie,
       modepaie.desce AS mode_paiement,
       info.classee,
       info.indicegrade,
       info.indice_fonctionnel,
       info.matricule_patron,
       info.statut,
       info.droit_hs,
       info.vehiculee,
       info.echelon,
       info.etat,
       info.indesirable,
       info.temporaire,
       type_contrat.val AS typecontrat,
       info.debutcontrat,
       info.fincontrat
FROM paie_info_personnel info
         LEFT JOIN situation_matrimoniale sitmat ON info.situation_matrimonial = sitmat.id
         LEFT JOIN paie_fonction fonct ON info.idfonction = fonct.id
         LEFT JOIN paie_categorie cat ON info.idcategorie = cat.id
         LEFT JOIN modepaiement modepaie ON info.mode_paiement = modepaie.id
         LEFT JOIN trs_banques_agences agence ON info.code_agence_banque = agence.id
         LEFT JOIN sig_personnes ON sig_personnes.id = info.idconjoint
         LEFT JOIN type_contrat ON info.typecontrat = type_contrat.id;


CREATE OR REPLACE VIEW VUE_CONTRAT_LIB AS
SELECT
    lpf.idpersonnel AS id,
    lpf.matricule,
    lpf.nom,
    lpf.prenom,
    lpf.sexe,
    pip.dateembauche,
    pip.indesirable AS periode,
    pip.fincontrat date_fin_contrat,
    lpf.etat,
    tc.val AS type_contrat
FROM
    log_personnel_fin lpf
        JOIN paie_info_personnel pip ON pip.id = lpf.idpersonnel
        JOIN type_contrat tc ON tc.id = pip.typecontrat;

UPDATE MENUDYNAMIQUE SET ID_PERE='' WHERE ID='MENDYN002';

CREATE OR REPLACE VIEW EMPLOYE_COMPLET  AS
SELECT logp.id,
       logp.nom,
       logp.prenom,
       logp.id_pers,
       paie.initiale,
       paie.matricule,
       logp.date_naissance,
       paie.lieu_naissance_commune,
       logp.sexe,
       logp.numero_cin,
       logp.date_cin,
       logp.date_dupl_cin,
       paie.lieu_delivrance_cin,
       logp.adresse,
       logp.fokotany,
       logp.nationalite,
       logp.acte_naissance,
       paie.situation_matrimonial,
       paie.idconjoint,
       logp.direction,
       logp.service,
       paie.idfonction,
       paie.ctg,
       paie.idcategorie,
       paie.classee,
       paie.indicegrade,
       paie.indice_fonctionnel,
       paie.matricule_patron,
       paie.statut,
       paie.mode_paiement,
       paie.code_agence_banque,
       paie.banque_numero_compte,
       paie.banque_compte_cle,
       logp.permis_conduire,
       logp.remarque,
       logp.chemin_permis,
       paie.cturgence_nom_prenom,
       paie.cturgence_telephone1,
       paie.cturgence_telephone2,
       paie.cturgence_telephone3,
       paie.dateembauche,
       paie.datesaisie,
       serv.code_dr,
       trs.val AS banque_code,
       paie.echelon,
       paie.etat,
       paie.vehiculee,
       tab.date_dernierpromo,
       paie.droit_hs,
       paie.heurejournalier,
       paie.heurehebdomadaire,
       paie.heuremensuel,
       paie.numero_cnaps,
       paie.numero_ostie,
       paie.temporaire,
       paie.nbenfant,
       paie.indesirable,
       paie.duree,
       paie.telephone,
       paie.mail,
       paie.idcategorie_paie,
       paie.idqualification,
       paie.discipline,
       paie.formation,
       paie.anneeexperience,
       paie.personnel_etat,
       paie.debutcontrat,
       paie.fincontrat,
       logp.refuser,
       logp.idhierarchie AS idetathierarchie,
       et.etatvisa,
       et.etatannule,
       paie.typecontrat,
       logp.cheminImage,
       paie.code_postal
FROM log_personnel logp
         LEFT JOIN ( SELECT paie_avancement.id_logpers,
                            max(paie_avancement.datedecision) AS date_dernierpromo
                     FROM paie_avancement
                     GROUP BY paie_avancement.id_logpers) tab ON logp.id = tab.id_logpers
         LEFT JOIN paie_info_personnel paie ON logp.id = paie.id
         LEFT JOIN log_service serv ON serv.id = logp.service
         LEFT JOIN trs_banques_agences trs ON paie.code_agence_banque = trs.id
         LEFT JOIN categorie_paie cp ON cp.id = paie.idcategorie_paie
         LEFT JOIN qualification_paie qp ON qp.id = paie.idqualification
         LEFT JOIN categorie_qualification cq ON cq.idcategorie = paie.idcategorie_paie AND cq.idqualification = paie.idqualification AND cq.REMARQUE = logp.id
         LEFT JOIN etathierarchie et ON et.id = logp.idhierarchie

;

CREATE SEQUENCE SEQ_ARO INCREMENT BY 1 MINVALUE 1 MAXVALUE 999999999999 NOCYCLE CACHE 20 NOORDER ;

CREATE OR REPLACE FUNCTION GET_SEQARO
 RETURN NUMBER
IS
  retour NUMBER;
BEGIN
SELECT SEQ_ARO.NEXTVAL into retour from dual;
RETURN retour;
END;

INSERT INTO FORMATION_DIPLOME
(ID, VAL, DESCE)
VALUES('FOR000002', 'LICENCE EN MANAGEMENT', 'LICENCE EN MANAGEMENT');
INSERT INTO FORMATION_DIPLOME
(ID, VAL, DESCE)
VALUES('FOR000003', 'LICENCE EN INFORMATIQUE', 'LICENCE EN INFORMATIQUE');
INSERT INTO FORMATION_DIPLOME
(ID, VAL, DESCE)
VALUES('FOR000001', 'MASTER EN MANAGEMENT', 'MASTER');

ALTER TABLE avance add interet NUMBER(10, 2);


CREATE OR REPLACE VIEW AVANCE_LIB2  AS
SELECT av.id,
       (log.nom || ' ') || log.prenom AS idpersonnel,
       av.montant,
       av.nbremboursement,
       av.remarque,
       av.daty,
       av.dateavance,
       av.etat,
       CASE
           WHEN av.etat = 1 THEN 'CREE'
           WHEN av.etat = 11 THEN 'VALIDE'
           ELSE NULL
           END AS etatlib,
       av.idtypeavance,
       ty.val AS idtypeavancelib,
       p.matricule,
       av.interet
FROM avance av
         LEFT JOIN log_personnel log ON av.idpersonnel = log.id
         LEFT JOIN paie_info_personnel p ON p.id = log.id
         LEFT JOIN typeavance ty ON ty.id = av.idtypeavance;



CREATE OR REPLACE VIEW V_MOYENNE_SALAIRE_PARFONCTION AS
SELECT
    pip.idfonction,
    pf.desce as fonctionlib,
    pem.annee,
    pem.mois,
    ROUND(AVG(pe.GAIN), 2) AS moyenne_salaire_base
FROM PAIE_EDITION pe
         LEFT JOIN PAIE_EDITIONMOISANNEE pem ON pem.ID = pe.IDEDITION
         LEFT JOIN PAIE_INFO_PERSONNEL pip ON pip.ID = pe.IDPERSONNEL
         left join PAIE_FONCTION pf ON pf.id = pip.IDFONCTION
WHERE pe.IDELEMENTPAIE = 'PR000041'
GROUP BY pip.idfonction, pf.desce, pem.annee, pem.mois;


CREATE OR REPLACE VIEW PAIE_RUBRIQUE_FICHE AS
SELECT pr.id,
       pr.val,
       pr.desce,
       pr.rang,
       pr.remarque,
       c.libelle AS comptepcg,
       c1.libelle AS cpt_gen_db,
       c2.libelle AS cpt_gen_cr,
       c3.libelle AS cpt_ana_db,
       c4.libelle AS cpt_ana_cr,
       pr.code,
       pr.typerubrique,
       pr.bcs,
       pr.bg,
       pr.imposable,
       pr.nature,
       CASE
           WHEN pr.avantage = 'A' THEN 'OUI'
           ELSE 'NON'
           END AS avantage,
       pr.formule,
       pr.isinfini,
       pr.etat,
       pr.afficher,
       CASE
           WHEN pr.afficher = 1 THEN 'OUI'
           WHEN pr.afficher = 0 THEN 'NON'
           ELSE NULL
           END AS afficherlib
FROM paie_rubrique pr
         LEFT JOIN compta_compte c ON c.compte = pr.comptepcg OR pr.comptepcg = c.id
         LEFT JOIN compta_compte c1 ON c1.compte = pr.cpt_gen_db OR pr.cpt_gen_db = c1.id
         LEFT JOIN compta_compte c2 ON c2.compte = pr.cpt_gen_cr OR pr.cpt_gen_cr = c2.id
         LEFT JOIN compta_compte c3 ON c3.compte = pr.cpt_ana_db OR pr.cpt_ana_db = c3.id
         LEFT JOIN compta_compte c4 ON c4.compte = pr.cpt_ana_cr OR pr.cpt_ana_cr = c4.id;



CREATE OR REPLACE VIEW AVANCE_LIB AS
SELECT av.id,
       (log.nom || ' ') || log.prenom AS idpersonnel,
       av.montant,
       av.nbremboursement,
       av.remarque,
       av.daty,
       av.dateavance,
       av.interet,
       av.etat,
       ty.val AS idtypeavance,
       p.matricule
FROM avance av
         LEFT JOIN log_personnel log ON av.idpersonnel = log.id
         LEFT JOIN paie_info_personnel p ON p.id = log.id
         LEFT JOIN typeavance ty ON ty.id = av.idtypeavance;